<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Algebra/Geometric/Cl3.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>   1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE GADTSyntax #-}</span></a>
<span class=hs-linenum>   2: </span><span class='hs-comment'>{-# LANGUAGE ViewPatterns #-}</span>
<span class=hs-linenum>   3: </span><span class='hs-comment'>{-# LANGUAGE DeriveDataTypeable #-}</span>
<span class=hs-linenum>   4: </span><span class='hs-comment'>{-# LANGUAGE DeriveGeneric #-}</span>
<span class=hs-linenum>   5: </span><span class='hs-comment'>{-# OPTIONS_GHC -fno-warn-type-defaults #-}</span>
<span class=hs-linenum>   6: </span><span class='hs-comment'>{-# LANGUAGE BangPatterns #-}</span>
<span class=hs-linenum>   7: </span><span class='hs-comment'>{-# LANGUAGE CPP #-}</span>
<span class=hs-linenum>   8: </span><span class='hs-comment'>{-# LANGUAGE MultiWayIf #-}</span>
<span class=hs-linenum>   9: </span>
<span class=hs-linenum>  10: </span>
<span class=hs-linenum>  11: </span><span class='hs-cpp'>#ifndef O_LIQUID</span>
<span class=hs-linenum>  12: </span><span class='hs-comment'>-- Turn off Safe Haskell language extension due to liquid-base re-exports</span>
<span class=hs-linenum>  13: </span><span class='hs-comment'>{-# LANGUAGE Safe #-}</span>
<span class=hs-linenum>  14: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  15: </span>
<span class=hs-linenum>  16: </span><span class='hs-cpp'>#if __GLASGOW_HASKELL__ == 810</span>
<span class=hs-linenum>  17: </span><span class='hs-comment'>-- Work around to fix GHC Issue #15304, issue popped up again in GHC 8.10, it should be fixed in GHC 8.12</span>
<span class=hs-linenum>  18: </span><span class='hs-comment'>-- This code is meant to reproduce MR 2608 for GHC 8.10</span>
<span class=hs-linenum>  19: </span><span class='hs-comment'>{-# OPTIONS_GHC -funfolding-keeness-factor=1 -funfolding-use-threshold=80 #-}</span>
<span class=hs-linenum>  20: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  21: </span>
<span class=hs-linenum>  22: </span>
<span class=hs-linenum>  23: </span>
<span class=hs-linenum>  24: </span><span class='hs-comment'>--------------------------------------------------------------------------------------------</span>
<span class=hs-linenum>  25: </span><span class='hs-comment'>-- |</span>
<span class=hs-linenum>  26: </span><span class='hs-comment'>-- Copyright   :  (C) 2017-2020 Nathan Waivio</span>
<span class=hs-linenum>  27: </span><span class='hs-comment'>-- License     :  BSD3</span>
<span class=hs-linenum>  28: </span><span class='hs-comment'>-- Maintainer  :  Nathan Waivio &lt;nathan.waivio@gmail.com&gt;</span>
<span class=hs-linenum>  29: </span><span class='hs-comment'>-- Stability   :  Stable</span>
<span class=hs-linenum>  30: </span><span class='hs-comment'>-- Portability :  unportable</span>
<span class=hs-linenum>  31: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>  32: </span><span class='hs-comment'>-- Library implementing standard functions for the &lt;https://en.wikipedia.org/wiki/Algebra_of_physical_space Algebra of Physical Space&gt; Cl(3,0)</span>
<span class=hs-linenum>  33: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum>  34: </span><span class='hs-comment'>---------------------------------------------------------------------------------------------</span>
<span class=hs-linenum>  35: </span>
<span class=hs-linenum>  36: </span>
<span class=hs-linenum>  37: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Algebra.Geometric.Cl3</span>
<span class=hs-linenum>  38: </span><span class='hs-layout'>(</span><span class='hs-comment'>-- * The type for the Algebra of Physical Space</span>
<span class=hs-linenum>  39: </span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  40: </span> <span class='hs-comment'>-- * Clifford Conjugate and Complex Conjugate</span>
<span class=hs-linenum>  41: </span> <span class='hs-varid'>bar</span><span class='hs-layout'>,</span> <span class='hs-varid'>dag</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  42: </span> <span class='hs-comment'>-- * The littlest singular value</span>
<span class=hs-linenum>  43: </span> <span class='hs-varid'>lsv</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  44: </span> <span class='hs-comment'>-- * Constructor Selectors - For optimizing and simplifying calculations</span>
<span class=hs-linenum>  45: </span> <span class='hs-varid'>toR</span><span class='hs-layout'>,</span> <span class='hs-varid'>toV3</span><span class='hs-layout'>,</span> <span class='hs-varid'>toBV</span><span class='hs-layout'>,</span> <span class='hs-varid'>toI</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  46: </span> <span class='hs-varid'>toPV</span><span class='hs-layout'>,</span> <span class='hs-varid'>toH</span><span class='hs-layout'>,</span> <span class='hs-varid'>toC</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  47: </span> <span class='hs-varid'>toBPV</span><span class='hs-layout'>,</span> <span class='hs-varid'>toODD</span><span class='hs-layout'>,</span> <span class='hs-varid'>toTPV</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  48: </span> <span class='hs-varid'>toAPS</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  49: </span> <span class='hs-comment'>-- * Pretty Printing for use with Octave</span>
<span class=hs-linenum>  50: </span> <span class='hs-varid'>showOctave</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  51: </span> <span class='hs-comment'>-- * Eliminate grades that are less than 'tol' to use a simpler Constructor</span>
<span class=hs-linenum>  52: </span> <span class='hs-varid'>reduce</span><span class='hs-layout'>,</span> <span class='hs-varid'>tol</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  53: </span><span class='hs-cpp'>#ifndef O_NO_STORABLE</span>
<span class=hs-linenum>  54: </span> <span class='hs-comment'>-- * Compact Storable types for the Cl3 Constructors with smart constructors</span>
<span class=hs-linenum>  55: </span> <span class='hs-conid'>Cl3_R</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_R</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_R</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  56: </span> <span class='hs-conid'>Cl3_V3</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_V3</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_V3</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  57: </span> <span class='hs-conid'>Cl3_BV</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_BV</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_BV</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  58: </span> <span class='hs-conid'>Cl3_I</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_I</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_I</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  59: </span> <span class='hs-conid'>Cl3_PV</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_PV</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_PV</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  60: </span> <span class='hs-conid'>Cl3_H</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_H</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_H</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  61: </span> <span class='hs-conid'>Cl3_C</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_C</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_C</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  62: </span> <span class='hs-conid'>Cl3_BPV</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_BPV</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_BPV</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  63: </span> <span class='hs-conid'>Cl3_ODD</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_ODD</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_ODD</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  64: </span> <span class='hs-conid'>Cl3_TPV</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_TPV</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_TPV</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  65: </span> <span class='hs-conid'>Cl3_APS</span><span class='hs-layout'>,</span> <span class='hs-varid'>toCl3_APS</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromCl3_APS</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  66: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  67: </span><span class='hs-cpp'>#ifndef O_NO_RANDOM</span>
<span class=hs-linenum>  68: </span> <span class='hs-comment'>-- * Random Instances</span>
<span class=hs-linenum>  69: </span> <span class='hs-varid'>randR</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeR</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  70: </span> <span class='hs-varid'>randV3</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeV3</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  71: </span> <span class='hs-varid'>randBV</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeBV</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  72: </span> <span class='hs-varid'>randI</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeI</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  73: </span> <span class='hs-varid'>randPV</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangePV</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  74: </span> <span class='hs-varid'>randH</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeH</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  75: </span> <span class='hs-varid'>randC</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeC</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  76: </span> <span class='hs-varid'>randBPV</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeBPV</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  77: </span> <span class='hs-varid'>randODD</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeODD</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  78: </span> <span class='hs-varid'>randTPV</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeTPV</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  79: </span> <span class='hs-varid'>randAPS</span><span class='hs-layout'>,</span> <span class='hs-varid'>rangeAPS</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  80: </span> <span class='hs-varid'>randUnitV3</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  81: </span> <span class='hs-varid'>randProjector</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  82: </span> <span class='hs-varid'>randNilpotent</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  83: </span> <span class='hs-varid'>randUnitary</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  84: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  85: </span> <span class='hs-comment'>-- * Helpful Functions</span>
<span class=hs-linenum>  86: </span> <span class='hs-varid'>eigvals</span><span class='hs-layout'>,</span> <span class='hs-varid'>hasNilpotent</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  87: </span> <span class='hs-varid'>spectraldcmp</span><span class='hs-layout'>,</span> <span class='hs-varid'>project</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  88: </span> <span class='hs-varid'>mIx</span><span class='hs-layout'>,</span> <span class='hs-varid'>timesI</span><span class='hs-layout'>,</span>
<span class=hs-linenum>  89: </span> <span class='hs-varid'>abssignum</span>
<span class=hs-linenum>  90: </span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  91: </span>
<span class=hs-linenum>  92: </span><span class='hs-cpp'>#ifndef O_NO_DERIVED</span>
<span class=hs-linenum>  93: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Data</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  94: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Generics</span> <span class='hs-layout'>(</span><span class='hs-conid'>Generic</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  95: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>  96: </span>
<span class=hs-linenum>  97: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.DeepSeq</span> <span class='hs-layout'>(</span><span class='hs-conid'>NFData</span><span class='hs-layout'>,</span><span class='hs-varid'>rnf</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  98: </span>
<span class=hs-linenum>  99: </span><span class='hs-cpp'>#ifndef O_NO_STORABLE</span>
<span class=hs-linenum> 100: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Foreign.Storable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Storable</span><span class='hs-layout'>,</span> <span class='hs-varid'>sizeOf</span><span class='hs-layout'>,</span> <span class='hs-varid'>alignment</span><span class='hs-layout'>,</span> <span class='hs-varid'>peek</span><span class='hs-layout'>,</span> <span class='hs-varid'>poke</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 101: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Foreign.Ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span><span class='hs-layout'>,</span> <span class='hs-varid'>plusPtr</span><span class='hs-layout'>,</span> <span class='hs-varid'>castPtr</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 102: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 103: </span>
<span class=hs-linenum> 104: </span><span class='hs-cpp'>#ifndef O_NO_RANDOM</span>
<span class=hs-linenum> 105: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>System.Random</span> <span class='hs-layout'>(</span><span class='hs-conid'>RandomGen</span><span class='hs-layout'>,</span> <span class='hs-conid'>Random</span><span class='hs-layout'>,</span> <span class='hs-varid'>randomR</span><span class='hs-layout'>,</span> <span class='hs-varid'>random</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 106: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 107: </span>
<span class=hs-linenum> 108: </span>
<span class=hs-linenum> 109: </span><span class='hs-comment'>-- | Cl3 provides specialized constructors for sub-algebras and other geometric objects</span>
<span class=hs-linenum> 110: </span><span class='hs-comment'>-- contained in the algebra.  Cl(3,0), abbreviated to Cl3, is a Geometric Algebra</span>
<span class=hs-linenum> 111: </span><span class='hs-comment'>-- of 3 dimensional space known as the Algebra of Physical Space (APS).  Geometric Algebras are Real</span>
<span class=hs-linenum> 112: </span><span class='hs-comment'>-- Clifford Algebras, double precision floats are used to approximate real numbers in this</span>
<span class=hs-linenum> 113: </span><span class='hs-comment'>-- library.  Single and Double grade combinations are specialized using algebraic datatypes</span>
<span class=hs-linenum> 114: </span><span class='hs-comment'>-- and live within the APS.</span>
<span class=hs-linenum> 115: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 116: </span><span class='hs-comment'>--   * 'R' is the constructor for the Real Scalar Sub-algebra Grade-0</span>
<span class=hs-linenum> 117: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 118: </span><span class='hs-comment'>--   * 'V3' is the Three Dimensional Real Vector constructor Grade-1</span>
<span class=hs-linenum> 119: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 120: </span><span class='hs-comment'>--   * 'BV' is the Bivector constructor Grade-2 an Imaginary Three Dimensional Vector</span>
<span class=hs-linenum> 121: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 122: </span><span class='hs-comment'>--   * 'I' is the Imaginary constructor Grade-3 and is the Pseudo-Scalar for APS</span>
<span class=hs-linenum> 123: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 124: </span><span class='hs-comment'>--   * 'PV' is the Paravector constructor with Grade-0 and Grade-1 elements, a Real Scalar plus Vector, (R + V3)</span>
<span class=hs-linenum> 125: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 126: </span><span class='hs-comment'>--   * 'H' is the Quaternion constructor it is the Even Sub-algebra with Grade-0 and Grade-2 elements, a Real Scalar plus Bivector, (R + BV)</span>
<span class=hs-linenum> 127: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 128: </span><span class='hs-comment'>--   * 'C' is the Complex constructor it is the Scalar Sub-algebra with Grade-0 and Grade-3 elements, a Real Scalar plus Imaginar Scalar, (R + I)</span>
<span class=hs-linenum> 129: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 130: </span><span class='hs-comment'>--   * 'BPV' is the Biparavector constructor with Grade-1 and Grade-2 elements, a Real Vector plus Bivector, (V3 + BV)</span>
<span class=hs-linenum> 131: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 132: </span><span class='hs-comment'>--   * 'ODD' is the Odd constructor with Grade-1 and Grade-3 elements, a Vector plus Imaginary Scalar, (V3 + I)</span>
<span class=hs-linenum> 133: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 134: </span><span class='hs-comment'>--   * 'TPV' is the Triparavector constructor with Grade-2 and Grade-3 elements, a Bivector plus Imaginary, (BV + I)</span>
<span class=hs-linenum> 135: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 136: </span><span class='hs-comment'>--   * 'APS' is the constructor for an element in the Algebra of Physical Space with Grade-0 through Grade-3 elements</span>
<span class=hs-linenum> 137: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 138: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 139: </span>  <span class='hs-conid'>R</span>   <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Real Scalar Sub-algebra</span>
<span class=hs-linenum> 140: </span>  <span class='hs-conid'>V3</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Three Dimensional Vectors</span>
<span class=hs-linenum> 141: </span>  <span class='hs-conid'>BV</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Bivectors, Imaginary Three Dimenstional Vectors</span>
<span class=hs-linenum> 142: </span>  <span class='hs-conid'>I</span>   <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Trivector Imaginary Pseudo-Scalar, Imaginary Scalar</span>
<span class=hs-linenum> 143: </span>  <span class='hs-conid'>PV</span>  <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Paravector, Real Scalar plus Three Dimensional Real Vector, (R + V3)</span>
<span class=hs-linenum> 144: </span>  <span class='hs-conid'>H</span>   <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Quaternion Even Sub-algebra, Real Scalar plus Bivector, (R + BV)</span>
<span class=hs-linenum> 145: </span>  <span class='hs-conid'>C</span>   <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Complex Sub-algebra, Real Scalar plus Imaginary Scalar, (R + I)</span>
<span class=hs-linenum> 146: </span>  <span class='hs-conid'>BPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Biparavector, Vector plus Bivector, (V3 + BV)</span>
<span class=hs-linenum> 147: </span>  <span class='hs-conid'>ODD</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Odd, Vector plus Imaginary, (V3 + I)</span>
<span class=hs-linenum> 148: </span>  <span class='hs-conid'>TPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Triparavector, Bivector plus Imaginary Scalar, (BV + I)</span>
<span class=hs-linenum> 149: </span>  <span class='hs-conid'>APS</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-comment'>-- Algebra of Physical Space</span>
<span class=hs-linenum> 150: </span><span class='hs-cpp'>#ifndef O_NO_DERIVED</span>
<span class=hs-linenum> 151: </span>    <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Show</span><span class='hs-layout'>,</span> <span class='hs-conid'>Read</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span><span class='hs-layout'>,</span> <span class='hs-conid'>Data</span><span class='hs-layout'>,</span> <span class='hs-conid'>Generic</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 152: </span>
<span class=hs-linenum> 153: </span><span class='hs-cpp'>#else</span>
<span class=hs-linenum> 154: </span>
<span class=hs-linenum> 155: </span><span class='hs-comment'>-- | In case we don't derive Show, provide 'showOctave' as the Show instance</span>
<span class=hs-linenum> 156: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Show</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 157: </span>  <span class='hs-varid'>show</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>showOctave</span>
<span class=hs-linenum> 158: </span>
<span class=hs-linenum> 159: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum> 160: </span>
<span class=hs-linenum> 161: </span>
<span class=hs-linenum> 162: </span>
<span class=hs-linenum> 163: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>(Control.DeepSeq.NFData Algebra.Geometric.Cl3.Cl3)</span><span class='hs-conid'>NFData</span></a> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 164: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; ()</span><span class='hs-varid'>rnf</span></a> <span class='hs-varop'>!</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : () | v == ()}</span><span class='hs-conid'>()</span></a>
<span class=hs-linenum> 165: </span>
<span class=hs-linenum> 166: </span>
<span class=hs-linenum> 167: </span><span class='hs-comment'>-- |'showOctave' for useful for debug purposes.</span>
<span class=hs-linenum> 168: </span><span class='hs-comment'>-- The additional octave definition is needed:  </span>
<span class=hs-linenum> 169: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum> 170: </span><span class='hs-comment'>-- &gt; e0 = [1,0;0,1]; e1=[0,1;1,0]; e2=[0,-i;i,0]; e3=[1,0;0,-1];</span>
<span class=hs-linenum> 171: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 172: </span><span class='hs-comment'>-- This allows one to take advantage of the isomorphism between Cl3 and M(2,C)</span>
<span class=hs-linenum> 173: </span><span class='hs-definition'>showOctave</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<span class=hs-linenum> 174: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; [GHC.Types.Char]</span><span class='hs-definition'>showOctave</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e0"</span></a>
<span class=hs-linenum> 175: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e3"</span></a>
<span class=hs-linenum> 176: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e3"</span></a>
<span class=hs-linenum> 177: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e0"</span></a>
<span class=hs-linenum> 178: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e0 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e3"</span></a>
<span class=hs-linenum> 179: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e0 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e3"</span></a>
<span class=hs-linenum> 180: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e0 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e0"</span></a>
<span class=hs-linenum> 181: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e3 + "</span></a> <span class='hs-varop'>++</span>
<span class=hs-linenum> 182: </span>                                        <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e3"</span></a>
<span class=hs-linenum> 183: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e3 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e0"</span></a>
<span class=hs-linenum> 184: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e3 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e0"</span></a>
<span class=hs-linenum> 185: </span><span class='hs-definition'>showOctave</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e0 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"*e3 + "</span></a> <span class='hs-varop'>++</span>
<span class=hs-linenum> 186: </span>                                                <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e1 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e2 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e3 + "</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>show</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>++</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"i*e0"</span></a>
<span class=hs-linenum> 187: </span>
<span class=hs-linenum> 188: </span>
<span class=hs-linenum> 189: </span><span class='hs-comment'>-- |Cl(3,0) has the property of equivalence.  "Eq" is "True" when all of the grade elements are equivalent.</span>
<span class=hs-linenum> 190: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Eq</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 191: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span>
<span class=hs-linenum> 192: </span>
<span class=hs-linenum> 193: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 194: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 195: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 196: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 197: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 198: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 199: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 200: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 201: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 202: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 203: </span>
<span class=hs-linenum> 204: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 205: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 206: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 207: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 208: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 209: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 210: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 211: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 212: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 213: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 214: </span>
<span class=hs-linenum> 215: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span>
<span class=hs-linenum> 216: </span>
<span class=hs-linenum> 217: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 218: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 219: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 220: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 221: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 222: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 223: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 224: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 225: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 226: </span>
<span class=hs-linenum> 227: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 228: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 229: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span>
<span class=hs-linenum> 230: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 231: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 232: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 233: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 234: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 235: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 236: </span>
<span class=hs-linenum> 237: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 238: </span>
<span class=hs-linenum> 239: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 240: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 241: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 242: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 243: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 244: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 245: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 246: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 247: </span>
<span class=hs-linenum> 248: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 249: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 250: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 251: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 252: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 253: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 254: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 255: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 256: </span>
<span class=hs-linenum> 257: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 258: </span>
<span class=hs-linenum> 259: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 260: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 261: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 262: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 263: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 264: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 265: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 266: </span>
<span class=hs-linenum> 267: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 268: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 269: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 270: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 271: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 272: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 273: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 274: </span>
<span class=hs-linenum> 275: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span>
<span class=hs-linenum> 276: </span>
<span class=hs-linenum> 277: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 278: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 279: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 280: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 281: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 282: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 283: </span>
<span class=hs-linenum> 284: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 285: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 286: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 287: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 288: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 289: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 290: </span>
<span class=hs-linenum> 291: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 292: </span>
<span class=hs-linenum> 293: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 294: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 295: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 296: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 297: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 298: </span>
<span class=hs-linenum> 299: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 300: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 301: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 302: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 303: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 304: </span>
<span class=hs-linenum> 305: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 306: </span>
<span class=hs-linenum> 307: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 308: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 309: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 310: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 311: </span>
<span class=hs-linenum> 312: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 313: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 314: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 315: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 316: </span>
<span class=hs-linenum> 317: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 318: </span>
<span class=hs-linenum> 319: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 320: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 321: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 322: </span>                                                                              <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 323: </span>
<span class=hs-linenum> 324: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 325: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 326: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span>
<span class=hs-linenum> 327: </span>                                                                             <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 328: </span>
<span class=hs-linenum> 329: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 330: </span>
<span class=hs-linenum> 331: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 332: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 333: </span>
<span class=hs-linenum> 334: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 335: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 336: </span>
<span class=hs-linenum> 337: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 338: </span>
<span class=hs-linenum> 339: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 340: </span>                                                                            <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 341: </span>
<span class=hs-linenum> 342: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 343: </span>                                                                            <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 344: </span>
<span class=hs-linenum> 345: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b0</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a1</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b1</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a2</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b2</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a3</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b3</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a23</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b23</span>
<span class=hs-linenum> 346: </span>                                                                                      <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a31</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b31</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a12</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b12</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>==</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 347: </span>
<span class=hs-linenum> 348: </span>
<span class=hs-linenum> 349: </span><span class='hs-comment'>-- |Cl3 has a total preorder ordering in which all pairs are comparable by two real valued functions.</span>
<span class=hs-linenum> 350: </span><span class='hs-comment'>-- Comparison of two reals is just the typical real compare function.  Comparison of to imaginary numbers</span>
<span class=hs-linenum> 351: </span><span class='hs-comment'>-- is just the typical comparison function.  When reals are compared to anything else it will compare the</span>
<span class=hs-linenum> 352: </span><span class='hs-comment'>-- absolute value of the reals to the magnitude of the other cliffor.  Compare of two complex values</span>
<span class=hs-linenum> 353: </span><span class='hs-comment'>-- compares the polar magnitude of the complex numbers.  Compare of two vectors compares the vector</span>
<span class=hs-linenum> 354: </span><span class='hs-comment'>-- magnitudes.  The Ord instance for the general case is based on the singular values of each cliffor and</span>
<span class=hs-linenum> 355: </span><span class='hs-comment'>-- this Ordering compares the largest singular value 'abs' and then the littlest singular value 'lsv'.</span>
<span class=hs-linenum> 356: </span><span class='hs-comment'>-- Some arbitrary cliffors may return EQ for Ord but not be exactly '==' equivalent, but they are related</span>
<span class=hs-linenum> 357: </span><span class='hs-comment'>-- by a right and left multiplication of two unitary elements.  For instance for the Cliffors A and B,</span>
<span class=hs-linenum> 358: </span><span class='hs-comment'>-- A == B could be False, but compare A B is EQ, because A * V = U * B, where V and U are unitary.  </span>
<span class=hs-linenum> 359: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Ord</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 360: </span>  <span class='hs-varid'>compare</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>compare</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b0</span> <span class='hs-comment'>-- Real Numbers have a total order within the limitations of Double Precision comparison</span>
<span class=hs-linenum> 361: </span>  <span class='hs-varid'>compare</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>compare</span> <span class='hs-varid'>a123</span> <span class='hs-varid'>b123</span> <span class='hs-comment'>-- Imaginary Numbers have a total order within the limitations of Double Precision comparison</span>
<span class=hs-linenum> 362: </span>  <span class='hs-varid'>compare</span> <span class='hs-varid'>cliffor1</span> <span class='hs-varid'>cliffor2</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 363: </span>     <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>abs</span> <span class='hs-varid'>cliffor1</span>
<span class=hs-linenum> 364: </span>         <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>abs</span> <span class='hs-varid'>cliffor2</span>
<span class=hs-linenum> 365: </span>         <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lsv</span> <span class='hs-varid'>cliffor1</span>
<span class=hs-linenum> 366: </span>         <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>lsv</span> <span class='hs-varid'>cliffor2</span>
<span class=hs-linenum> 367: </span>     <span class='hs-keyword'>in</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>compare</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b0</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum> 368: </span>          <span class='hs-conid'>LT</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>LT</span>
<span class=hs-linenum> 369: </span>          <span class='hs-conid'>GT</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GT</span>
<span class=hs-linenum> 370: </span>          <span class='hs-conid'>EQ</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>compare</span> <span class='hs-varid'>a0'</span> <span class='hs-varid'>b0'</span>
<span class=hs-linenum> 371: </span>
<span class=hs-linenum> 372: </span>
<span class=hs-linenum> 373: </span>
<span class=hs-linenum> 374: </span><span class='hs-comment'>-- |Cl3 has a "Num" instance.  "Num" is addition, geometric product, negation, 'abs' the largest</span>
<span class=hs-linenum> 375: </span><span class='hs-comment'>-- singular value, and 'signum'.</span>
<span class=hs-linenum> 376: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum> 377: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Num</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 378: </span>  <span class='hs-comment'>-- | Cl3 can be added</span>
<span class=hs-linenum> 379: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 380: </span>
<span class=hs-linenum> 381: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span>
<span class=hs-linenum> 382: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 383: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 384: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span>
<span class=hs-linenum> 385: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 386: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 387: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 388: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 389: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 390: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 391: </span>
<span class=hs-linenum> 392: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum> 393: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum> 394: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 395: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum> 396: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum> 397: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 398: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 399: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 400: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 401: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 402: </span>
<span class=hs-linenum> 403: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 404: </span>
<span class=hs-linenum> 405: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 406: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 407: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 408: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 409: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 410: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span>
<span class=hs-linenum> 411: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 412: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 413: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 414: </span>
<span class=hs-linenum> 415: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum> 416: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 417: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 418: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 419: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 420: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum> 421: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 422: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 423: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 424: </span>
<span class=hs-linenum> 425: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 426: </span>
<span class=hs-linenum> 427: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 428: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 429: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 430: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 431: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 432: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 433: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 434: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 435: </span>
<span class=hs-linenum> 436: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 437: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 438: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 439: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 440: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 441: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 442: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 443: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 444: </span>
<span class=hs-linenum> 445: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 446: </span>
<span class=hs-linenum> 447: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 448: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 449: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 450: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 451: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 452: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 453: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 454: </span>
<span class=hs-linenum> 455: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 456: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 457: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 458: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 459: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 460: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 461: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 462: </span>
<span class=hs-linenum> 463: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 464: </span>
<span class=hs-linenum> 465: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 466: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 467: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 468: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 469: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 470: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 471: </span>
<span class=hs-linenum> 472: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 473: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 474: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 475: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 476: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 477: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 478: </span>
<span class=hs-linenum> 479: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 480: </span>
<span class=hs-linenum> 481: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 482: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 483: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 484: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 485: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 486: </span>
<span class=hs-linenum> 487: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 488: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 489: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 490: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 491: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 492: </span>
<span class=hs-linenum> 493: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 494: </span>
<span class=hs-linenum> 495: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 496: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 497: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 498: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 499: </span>
<span class=hs-linenum> 500: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 501: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 502: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 503: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 504: </span>
<span class=hs-linenum> 505: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 506: </span>
<span class=hs-linenum> 507: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 508: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 509: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>b123</span>
<span class=hs-linenum> 510: </span>
<span class=hs-linenum> 511: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 512: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 513: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum> 514: </span>
<span class=hs-linenum> 515: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 516: </span>
<span class=hs-linenum> 517: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 518: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 519: </span>
<span class=hs-linenum> 520: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 521: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 522: </span>
<span class=hs-linenum> 523: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 524: </span>
<span class=hs-linenum> 525: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 526: </span>
<span class=hs-linenum> 527: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 528: </span>
<span class=hs-linenum> 529: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 530: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 531: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 532: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 533: </span>
<span class=hs-linenum> 534: </span>  <span class='hs-comment'>-- | Multiplication Instance implementing a Geometric Product</span>
<span class=hs-linenum> 535: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 536: </span>
<span class=hs-linenum> 537: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 538: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 539: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 540: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 541: </span>                                 <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 542: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 543: </span>                                  <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 544: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 545: </span>                           <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 546: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 547: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 548: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 549: </span>                                     <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 550: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 551: </span>                                        <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 552: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 553: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 554: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 555: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 556: </span>
<span class=hs-linenum> 557: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 558: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 559: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 560: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 561: </span>                                 <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 562: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 563: </span>                                  <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 564: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 565: </span>                           <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 566: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 567: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 568: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 569: </span>                                     <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 570: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 571: </span>                                        <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 572: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 573: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 574: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 575: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 576: </span>
<span class=hs-linenum> 577: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 578: </span>                                    <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 579: </span>
<span class=hs-linenum> 580: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 581: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 582: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 583: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 584: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 585: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 586: </span>                                         <span class='hs-num'>0</span>
<span class=hs-linenum> 587: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 588: </span>                                           <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 589: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 590: </span>                                    <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 591: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 592: </span>                                                   <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 593: </span>                                                   <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 594: </span>                                                   <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 595: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 596: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 597: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 598: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 599: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 600: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 601: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 602: </span>                                                           <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 603: </span>                                                           <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 604: </span>                                                           <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 605: </span>
<span class=hs-linenum> 606: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span>  <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span>  <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 607: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span>  <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span>  <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 608: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 609: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 610: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 611: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 612: </span>                                         <span class='hs-num'>0</span>
<span class=hs-linenum> 613: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 614: </span>                                           <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 615: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 616: </span>                                    <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 617: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 618: </span>                                                   <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 619: </span>                                                   <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 620: </span>                                                   <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 621: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 622: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 623: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 624: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 625: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 626: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 627: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 628: </span>                                                           <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 629: </span>                                                           <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 630: </span>                                                           <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 631: </span>
<span class=hs-linenum> 632: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 633: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 634: </span>
<span class=hs-linenum> 635: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 636: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 637: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 638: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 639: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 640: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 641: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 642: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 643: </span>                                       <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 644: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 645: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>  
<span class=hs-linenum> 646: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 647: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 648: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 649: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 650: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 651: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 652: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 653: </span>                                                  <span class='hs-num'>0</span>
<span class=hs-linenum> 654: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 655: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 656: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 657: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 658: </span>
<span class=hs-linenum> 659: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 660: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 661: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 662: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 663: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 664: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 665: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 666: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 667: </span>                                       <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 668: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 669: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>    
<span class=hs-linenum> 670: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 671: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 672: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 673: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 674: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 675: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 676: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 677: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 678: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 679: </span>                                                  <span class='hs-num'>0</span>
<span class=hs-linenum> 680: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>  
<span class=hs-linenum> 681: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 682: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 683: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 684: </span>
<span class=hs-linenum> 685: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 686: </span>
<span class=hs-linenum> 687: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 688: </span>                                    <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 689: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 690: </span>                                      <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 691: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 692: </span>                             <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 693: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 694: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 695: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 696: </span>                                     <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 697: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 698: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 699: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 700: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 701: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 702: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 703: </span>
<span class=hs-linenum> 704: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 705: </span>                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 706: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 707: </span>                                      <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 708: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 709: </span>                             <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 710: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 711: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 712: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 713: </span>                                     <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 714: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 715: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 716: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 717: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 718: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 719: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 720: </span>
<span class=hs-linenum> 721: </span>
<span class=hs-linenum> 722: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 723: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 724: </span>                                            <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 725: </span>                                            <span class='hs-num'>0</span>
<span class=hs-linenum> 726: </span>
<span class=hs-linenum> 727: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 728: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 729: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 730: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 731: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 732: </span>                                       <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 733: </span>                                       <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 734: </span>                                       <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 735: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 736: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 737: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 738: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 739: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 740: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 741: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 742: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 743: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 744: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 745: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 746: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 747: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 748: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 749: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 750: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 751: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 752: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 753: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 754: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 755: </span>
<span class=hs-linenum> 756: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 757: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 758: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 759: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 760: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 761: </span>                                       <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 762: </span>                                       <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 763: </span>                                       <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 764: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 765: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 766: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 767: </span>                                                      <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 768: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 769: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 770: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 771: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 772: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 773: </span>                                               <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 774: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-num'>0</span>
<span class=hs-linenum> 775: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 776: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 777: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 778: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 779: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 780: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 781: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 782: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 783: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 784: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 785: </span>                                                              <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 786: </span>
<span class=hs-linenum> 787: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 788: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 789: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 790: </span>                                              <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 791: </span>
<span class=hs-linenum> 792: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 793: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 794: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 795: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 796: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 797: </span>                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 798: </span>                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 799: </span>                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span>  <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 800: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 801: </span>                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 802: </span>                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 803: </span>                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 804: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 805: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 806: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 807: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 808: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 809: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 810: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 811: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 812: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 813: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 814: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 815: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 816: </span>
<span class=hs-linenum> 817: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 818: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 819: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 820: </span>                                         <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 821: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 822: </span>                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 823: </span>                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 824: </span>                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 825: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 826: </span>                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 827: </span>                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 828: </span>                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 829: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 830: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 831: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 832: </span>                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 833: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 834: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 835: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 836: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 837: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 838: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 839: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 840: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 841: </span>
<span class=hs-linenum> 842: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 843: </span>                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 844: </span>
<span class=hs-linenum> 845: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 846: </span>                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 847: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 848: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 849: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 850: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 851: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 852: </span>                                             <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 853: </span>                                             <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 854: </span>                                             <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 855: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 856: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 857: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 858: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 859: </span>
<span class=hs-linenum> 860: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 861: </span>                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 862: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 863: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 864: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 865: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 866: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 867: </span>                                             <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 868: </span>                                             <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 869: </span>                                             <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 870: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 871: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 872: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 873: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 874: </span>
<span class=hs-linenum> 875: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 876: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 877: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 878: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 879: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 880: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 881: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 882: </span>                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 883: </span>
<span class=hs-linenum> 884: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 885: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 886: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 887: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 888: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 889: </span>                                                            <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 890: </span>                                                            <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 891: </span>                                                            <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 892: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 893: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 894: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 895: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 896: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 897: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 898: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 899: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 900: </span>
<span class=hs-linenum> 901: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 902: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 903: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 904: </span>                                                         <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 905: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 906: </span>                                                            <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 907: </span>                                                            <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 908: </span>                                                            <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 909: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 910: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 911: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 912: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 913: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 914: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 915: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 916: </span>                                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 917: </span>
<span class=hs-linenum> 918: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 919: </span>                                                <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 920: </span>                                                <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 921: </span>                                                <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 922: </span>
<span class=hs-linenum> 923: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 924: </span>                                                     <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 925: </span>                                                     <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 926: </span>                                                     <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 927: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 928: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 929: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 930: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 931: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 932: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 933: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 934: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 935: </span>
<span class=hs-linenum> 936: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 937: </span>                                                     <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 938: </span>                                                     <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 939: </span>                                                     <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 940: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 941: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 942: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 943: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 944: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 945: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 946: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 947: </span>                                                                 <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 948: </span>
<span class=hs-linenum> 949: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 950: </span>                                                        <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 951: </span>                                                        <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 952: </span>                                                        <span class='hs-num'>0</span>
<span class=hs-linenum> 953: </span>
<span class=hs-linenum> 954: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 955: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 956: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 957: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 958: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 959: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 960: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 961: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 962: </span>
<span class=hs-linenum> 963: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 964: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 965: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 966: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 967: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 968: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 969: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 970: </span>                                                                    <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 971: </span>
<span class=hs-linenum> 972: </span>  <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>b0</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span> <span class='hs-varid'>b23</span> <span class='hs-varid'>b31</span> <span class='hs-varid'>b12</span> <span class='hs-varid'>b123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 973: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 974: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 975: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 976: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 977: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 978: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 979: </span>                                                                                <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>b123</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>b0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b23</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b31</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b12</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 980: </span>
<span class=hs-linenum> 981: </span>
<span class=hs-linenum> 982: </span>
<span class=hs-linenum> 983: </span>
<span class=hs-linenum> 984: </span>  <span class='hs-comment'>-- |'abs' is the spectral norm aka the spectral radius</span>
<span class=hs-linenum> 985: </span>  <span class='hs-comment'>-- it is the largest singular value. This function may need to be fiddled with</span>
<span class=hs-linenum> 986: </span>  <span class='hs-comment'>-- to make the math a bit safer wrt overflows.  This makes use of the largest</span>
<span class=hs-linenum> 987: </span>  <span class='hs-comment'>-- singular value, if the littlest singular value is zero then the element is not</span>
<span class=hs-linenum> 988: </span>  <span class='hs-comment'>-- invertable, we can see here that R, C, V3, BV, and H are all invertable, and</span>
<span class=hs-linenum> 989: </span>  <span class='hs-comment'>-- by implication R, C, and H are division algebras.</span>
<span class=hs-linenum> 990: </span>  <span class='hs-varid'>abs</span> <span class='hs-varid'>cl3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fst</span> <span class='hs-varop'>$</span> <span class='hs-varid'>abssignum</span> <span class='hs-varid'>cl3</span>
<span class=hs-linenum> 991: </span>  <span class='hs-comment'>{-
  abs (R a0) = R (abs a0) -- absolute value of a real number
  abs (V3 a1 a2 a3) = R (sqrt $ a1^2 + a2^2 + a3^2) -- magnitude of a vector
  abs (BV a23 a31 a12) = R (sqrt $ a23^2 + a31^2 + a12^2) -- magnitude of a bivector
  abs (I a123) = R (abs a123) -- magnitude of a Imaginary number
  abs (PV a0 a1 a2 a3) = R (reimMag a0 a1 a2 a3)
  abs (TPV a23 a31 a12 a123) = R (reimMag a123 a23 a31 a12)
  abs (H a0 a23 a31 a12) = R (sqrt $ a0^2 + a23^2 + a31^2 + a12^2) -- largest singular value
  abs (C a0 a123) = R (sqrt $ a0^2 + a123^2) -- magnitude of a complex number
  abs (BPV a1 a2 a3 a23 a31 a12) =
    let mag = sqrt $ (a1*a31 - a2*a23)^2 + (a1*a12 - a3*a23)^2 + (a2*a12 - a3*a31)^2 -- core was duplicating this computation added let to hopefully reduce the duplication
    in R (sqrt $ a1^2 + a23^2 + a2^2 + mag + a31^2 + a3^2 + a12^2 + mag)
  abs (ODD a1 a2 a3 a123) = R (sqrt $ a1^2 + a2^2 + a3^2 + a123^2)
  abs (APS a0 a1 a2 a3 a23 a31 a12 a123) =
    let mag = sqrt $ (a0*a1 + a123*a23)^2 + (a0*a2 + a123*a31)^2 + (a0*a3 + a123*a12)^2 + (a2*a12 - a3*a31)^2 + (a3*a23 - a1*a12)^2 + (a1*a31 - a2*a23)^2 -- core was duplicating this computation added let to hopefully reduce the duplication
    in R (sqrt $ a0^2 + a1^2 + a2^2 + a3^2 + mag + a23^2 + a31^2 + a12^2 + a123^2 + mag)
  -}</span>
<span class=hs-linenum>1008: </span>
<span class=hs-linenum>1009: </span>  <span class='hs-comment'>-- |'signum' satisfies the Law "abs x * signum x == x"</span>
<span class=hs-linenum>1010: </span>  <span class='hs-comment'>-- kind of cool: signum of a vector is it's unit vector.</span>
<span class=hs-linenum>1011: </span>  <span class='hs-varid'>signum</span> <span class='hs-varid'>cl3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>$</span> <span class='hs-varid'>abssignum</span> <span class='hs-varid'>cl3</span>
<span class=hs-linenum>1012: </span>  <span class='hs-comment'>{-
  signum (R a0) = R (signum a0)
  signum (V3 a1 a2 a3) =
    let mag = sqrt (a1^2 + a2^2 + a3^2)
        invMag = recip mag
    in if mag == 0
       then R 0
       else V3 (invMag * a1) (invMag * a2) (invMag * a3)
  signum (BV a23 a31 a12) =
    let mag = sqrt (a23^2 + a31^2 + a12^2)
        invMag = recip mag
    in if mag == 0
       then R 0
       else BV (invMag * a23) (invMag * a31) (invMag * a12)
  signum (I a123) =
    if a123 == 0
    then R 0
    else I (signum a123)
  signum (PV a0 a1 a2 a3) =
    let mag = reimMag a0 a1 a2 a3
        invMag = recip mag
    in if mag == 0
       then R 0
       else PV (invMag * a0) (invMag * a1) (invMag * a2) (invMag * a3)
  signum (H a0 a23 a31 a12) =
    let mag = sqrt (a0^2 + a23^2 + a31^2 + a12^2)
        invMag = recip mag
    in if mag == 0
       then R 0
       else H (invMag * a0) (invMag * a23) (invMag * a31) (invMag * a12)
  signum (C a0 a123) =
    let mag = sqrt (a0^2 + a123^2)
        invMag = recip mag
    in if mag == 0
       then R 0
       else C (invMag * a0) (invMag * a123)
  signum (BPV a1 a2 a3 a23 a31 a12) =
    let x = sqrt ((a1*a31 - a2*a23)^2 + (a1*a12 - a3*a23)^2 + (a2*a12 - a3*a31)^2)
        mag = sqrt (a1^2 + a23^2 + a2^2 + a31^2 + a3^2 + a12^2 + x + x)
        invMag = recip mag
    in if mag == 0
       then R 0
       else BPV (invMag * a1) (invMag * a2) (invMag * a3) (invMag * a23) (invMag * a31) (invMag * a12)
  signum (ODD a1 a2 a3 a123) =
    let mag = sqrt (a1^2 + a2^2 + a3^2 + a123^2)
        invMag = recip mag
    in if mag == 0
       then R 0
       else ODD (invMag * a1) (invMag * a2) (invMag * a3) (invMag * a123)
  signum (TPV a23 a31 a12 a123) =
    let mag = reimMag a123 a23 a31 a12
        invMag = recip mag
    in if mag == 0
       then R 0
       else TPV (invMag * a23) (invMag * a31) (invMag * a12) (invMag * a123)
  signum (APS a0 a1 a2 a3 a23 a31 a12 a123) =
    let x = sqrt ((a0*a1 + a123*a23)^2 + (a0*a2 + a123*a31)^2 + (a0*a3 + a123*a12)^2 + (a2*a12 - a3*a31)^2 + (a3*a23 - a1*a12)^2 + (a1*a31 - a2*a23)^2)
        mag = sqrt (a0^2 + a1^2 + a2^2 + a3^2 + a23^2 + a31^2 + a12^2 + a123^2 + x + x)
        invMag = recip mag
    in if mag == 0
       then R 0
       else APS (invMag * a0) (invMag * a1) (invMag * a2) (invMag * a3) (invMag * a23) (invMag * a31) (invMag * a12) (invMag * a123)
  -}</span>
<span class=hs-linenum>1075: </span>
<span class=hs-linenum>1076: </span>  <span class='hs-comment'>-- |'fromInteger'</span>
<span class=hs-linenum>1077: </span>  <span class='hs-varid'>fromInteger</span> <span class='hs-varid'>int</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromInteger</span> <span class='hs-varid'>int</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1078: </span>
<span class=hs-linenum>1079: </span>
<span class=hs-linenum>1080: </span>  <span class='hs-comment'>-- |'negate' simply distributes into the grade components</span>
<span class=hs-linenum>1081: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1082: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1083: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1084: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1085: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1086: </span>                                <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1087: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1088: </span>                                <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1089: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1090: </span>                         <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1091: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1092: </span>                                          <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1093: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1094: </span>                                   <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1095: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1096: </span>                                      <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1097: </span>  <span class='hs-varid'>negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1098: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1099: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1100: </span>                                                  <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1101: </span>
<span class=hs-linenum>1102: </span><span class='hs-comment'>-- | 'reimMag' small helper function to calculate magnitude for PV and TPV</span>
<span class=hs-linenum>1103: </span><span class='hs-definition'>reimMag</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>1104: </span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; GHC.Types.Double</span><span class='hs-definition'>reimMag</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v0</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v1</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v2</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v3</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1105: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sumsqs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v1</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v3</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1106: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v0</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sumsqs}</span><span class='hs-varid'>sumsqs</span></a>
<span class=hs-linenum>1107: </span>  <span class='hs-keyword'>in</span> <span class='hs-varid'>sqrt</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sumsqs}</span><span class='hs-varid'>sumsqs</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1108: </span>
<span class=hs-linenum>1109: </span><span class='hs-comment'>-- |Cl(3,0) has a Fractional instance</span>
<span class=hs-linenum>1110: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Fractional</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>1111: </span>  <span class='hs-comment'>-- |Some of the sub algebras are division algebras but APS is not a division algebra</span>
<span class=hs-linenum>1112: </span>  <span class='hs-varid'>recip</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>recip</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>   <span class='hs-comment'>-- R is a division algebra</span>
<span class=hs-linenum>1113: </span>  <span class='hs-varid'>recip</span> <span class='hs-varid'>cliff</span> <span class='hs-keyglyph'>=</span> 
<span class=hs-linenum>1114: </span>    <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>mag</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>abs</span> <span class='hs-varid'>cliff</span>
<span class=hs-linenum>1115: </span>        <span class='hs-varid'>recipsqmag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span> <span class='hs-varid'>mag</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>1116: </span>        <span class='hs-varid'>negrecipsqmag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>negate</span> <span class='hs-varid'>recipsqmag</span>
<span class=hs-linenum>1117: </span>        <span class='hs-varid'>recipmag2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span><span class='hs-varop'>.</span><span class='hs-varid'>toR</span> <span class='hs-varop'>$</span> <span class='hs-varid'>cliff</span> <span class='hs-varop'>*</span> <span class='hs-varid'>bar</span> <span class='hs-varid'>cliff</span>
<span class=hs-linenum>1118: </span>        <span class='hs-varid'>go_recip</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-layout'>(</span><span class='hs-varid'>recipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1119: </span>        <span class='hs-varid'>go_recip</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negrecipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negrecipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negrecipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1120: </span>        <span class='hs-varid'>go_recip</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-layout'>(</span><span class='hs-varid'>negrecipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1121: </span>        <span class='hs-varid'>go_recip</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>recipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negrecipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negrecipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negrecipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- H is a division algebra</span>
<span class=hs-linenum>1122: </span>        <span class='hs-varid'>go_recip</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>recipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negrecipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>   <span class='hs-comment'>-- C is a division algebra</span>
<span class=hs-linenum>1123: </span>        <span class='hs-varid'>go_recip</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>recipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>recipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negrecipsqmag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1124: </span>        <span class='hs-varid'>go_recip</span> <span class='hs-varid'>pv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>PV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recipmag2</span> <span class='hs-varop'>*</span> <span class='hs-varid'>bar</span> <span class='hs-varid'>pv</span>
<span class=hs-linenum>1125: </span>        <span class='hs-varid'>go_recip</span> <span class='hs-varid'>tpv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>TPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recipmag2</span> <span class='hs-varop'>*</span> <span class='hs-varid'>bar</span> <span class='hs-varid'>tpv</span>
<span class=hs-linenum>1126: </span>        <span class='hs-varid'>go_recip</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>reduce</span> <span class='hs-varop'>$</span> <span class='hs-varid'>spectraldcmp</span> <span class='hs-varid'>recip</span> <span class='hs-varid'>recip'</span> <span class='hs-varid'>cliffor</span>
<span class=hs-linenum>1127: </span>    <span class='hs-keyword'>in</span> <span class='hs-varid'>go_recip</span> <span class='hs-varid'>cliff</span>
<span class=hs-linenum>1128: </span>
<span class=hs-linenum>1129: </span>
<span class=hs-linenum>1130: </span>  <span class='hs-comment'>-- |'fromRational'</span>
<span class=hs-linenum>1131: </span>  <span class='hs-varid'>fromRational</span> <span class='hs-varid'>rat</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromRational</span> <span class='hs-varid'>rat</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1132: </span>
<span class=hs-linenum>1133: </span>
<span class=hs-linenum>1134: </span><span class='hs-comment'>-- |Cl(3,0) has a "Floating" instance.</span>
<span class=hs-linenum>1135: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>(GHC.Float.Floating Algebra.Geometric.Cl3.Cl3)</span><span class='hs-conid'>Floating</span></a> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>1136: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>pi</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a>
<span class=hs-linenum>1137: </span>
<span class=hs-linenum>1138: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1139: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>exp</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>exp</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1140: </span>  <span class='hs-varid'>exp</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>cos</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>sin</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1141: </span>  <span class='hs-varid'>exp</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1142: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>expa0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>exp</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1143: </span>    <span class='hs-keyword'>in</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == expa0}</span><span class='hs-varid'>expa0</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == expa0}</span><span class='hs-varid'>expa0</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1144: </span>  <span class='hs-varid'>exp</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>exp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>exp'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1145: </span>
<span class=hs-linenum>1146: </span>
<span class=hs-linenum>1147: </span>
<span class=hs-linenum>1148: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1149: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>log</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1150: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>log</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class='hs-layout'>)</span>
<span class=hs-linenum>1151: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a>
<span class=hs-linenum>1152: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a>
<span class=hs-linenum>1153: </span>  <span class='hs-varid'>log</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1154: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1155: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1156: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>signum</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1157: </span>  <span class='hs-varid'>log</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>atan2</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1158: </span>  <span class='hs-varid'>log</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v &gt; 0.0} -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>log</span></a></span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>log'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1159: </span>
<span class=hs-linenum>1160: </span>
<span class=hs-linenum>1161: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1162: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>sqrt</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1163: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>sqrt</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1164: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1165: </span>  <span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1166: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1167: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1168: </span>        <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sqrtr</span></a> <span class='hs-keyglyph'>=</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>1169: </span>            <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>phiby2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>signum</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 4.0}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-- evaluated: atan2 a123 0 / 2</span>
<span class=hs-linenum>1170: </span>        <span class='hs-keyword'>in</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sqrtr}</span><span class='hs-varid'>sqrtr</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == phiby2}</span><span class='hs-varid'>phiby2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sqrtr}</span><span class='hs-varid'>sqrtr</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == phiby2}</span><span class='hs-varid'>phiby2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1171: </span>  <span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1172: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sqrtr</span></a> <span class='hs-keyglyph'>=</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1173: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>phiby2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1174: </span>    <span class='hs-keyword'>in</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sqrtr}</span><span class='hs-varid'>sqrtr</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == phiby2}</span><span class='hs-varid'>phiby2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sqrtr}</span><span class='hs-varid'>sqrtr</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == phiby2}</span><span class='hs-varid'>phiby2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1175: </span>  <span class='hs-varid'>sqrt</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0} -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>sqrt'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1176: </span>
<span class=hs-linenum>1177: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1178: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>sin</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>sin</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1179: </span>  <span class='hs-varid'>sin</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1180: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1181: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>sinh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1182: </span>  <span class='hs-varid'>sin</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cosh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sinh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1183: </span>  <span class='hs-varid'>sin</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>sin'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1184: </span>
<span class=hs-linenum>1185: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1186: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cos</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>cos</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1187: </span>  <span class='hs-varid'>cos</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>cosh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1188: </span>  <span class='hs-varid'>cos</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cosh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sinh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1189: </span>  <span class='hs-varid'>cos</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cos'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1190: </span>
<span class=hs-linenum>1191: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1192: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>tan</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tan</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1193: </span>  <span class='hs-varid'>tan</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1194: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1195: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tanh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1196: </span>  <span class='hs-varid'>tan</span> <span class='hs-layout'>(</span><span class='hs-varid'>reduce</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1197: </span>    <span class='hs-keyword'>let</span>
<span class=hs-linenum>1198: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>m</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosx * coshy}</span><span class='hs-varid'>x2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == y2}</span><span class='hs-varid'>y2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1199: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sinx * coshy}</span><span class='hs-varid'>x1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sinx}</span><span class='hs-varid'>sinx</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == coshy}</span><span class='hs-varid'>coshy</span></a>
<span class=hs-linenum>1200: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosx * sinhy}</span><span class='hs-varid'>y1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosx}</span><span class='hs-varid'>cosx</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sinhy}</span><span class='hs-varid'>sinhy</span></a>
<span class=hs-linenum>1201: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosx * coshy}</span><span class='hs-varid'>x2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosx}</span><span class='hs-varid'>cosx</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == coshy}</span><span class='hs-varid'>coshy</span></a>
<span class=hs-linenum>1202: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>y2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sinx}</span><span class='hs-varid'>sinx</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sinhy}</span><span class='hs-varid'>sinhy</span></a>
<span class=hs-linenum>1203: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sinx</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1204: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cosx</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1205: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sinhy</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sinh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>1206: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>coshy</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cosh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>1207: </span>    <span class='hs-keyword'>in</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sinx * coshy
                        &amp;&amp; v == x1}</span><span class='hs-varid'>x1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosx * coshy}</span><span class='hs-varid'>x2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosx * sinhy
                        &amp;&amp; v == y1}</span><span class='hs-varid'>y1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == y2}</span><span class='hs-varid'>y2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>/</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == m}</span><span class='hs-varid'>m</span></a></span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosx * coshy}</span><span class='hs-varid'>x2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosx * sinhy
                        &amp;&amp; v == y1}</span><span class='hs-varid'>y1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sinx * coshy
                        &amp;&amp; v == x1}</span><span class='hs-varid'>x1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == y2}</span><span class='hs-varid'>y2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>/</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == m}</span><span class='hs-varid'>m</span></a></span><span class='hs-layout'>)</span>
<span class=hs-linenum>1208: </span>  <span class='hs-varid'>tan</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>tan</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>tan'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1209: </span>
<span class=hs-linenum>1210: </span>
<span class=hs-linenum>1211: </span>
<span class=hs-linenum>1212: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1213: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>asin</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1214: </span>      <span class='hs-comment'>-- asin (R a0) = I (-1) * log (I 1 * R a0 + sqrt (1 - (R a0)^2))</span>
<span class=hs-linenum>1215: </span>      <span class='hs-comment'>-- I (-1) * log (I a0 + sqrt (R 1 - (R a0)^2))</span>
<span class=hs-linenum>1216: </span>      <span class='hs-comment'>-- I (-1) * log (I a0 + sqrt (R (1 - a0^2)))</span>
<span class=hs-linenum>1217: </span>      <span class='hs-comment'>-- I (-1) * log (I a0 + (I (sqrt.negate $ 1 - a0^2)))</span>
<span class=hs-linenum>1218: </span>      <span class='hs-comment'>-- I (-1) * log (I a0 + (sqrt.negate $ 1 - a0^2))</span>
<span class=hs-linenum>1219: </span>      <span class='hs-comment'>-- Def ==&gt; log (I a123) = C (log.abs $ a123) (signum a123 * (pi/2))</span>
<span class=hs-linenum>1220: </span>      <span class='hs-comment'>-- I (-1) * C (log.abs $ (a0 + (sqrt.negate $ 1 - a0^2))) (signum (a0 + (sqrt.negate $ 1 - a0^2)) * (pi/2))</span>
<span class=hs-linenum>1221: </span>      <span class='hs-comment'>-- C (signum (a0 + (sqrt.negate $ 1 - a0^2)) * (pi/2)) (negate.log.abs $ (a0 + (sqrt.negate $ 1 - a0^2)))</span>
<span class=hs-linenum>1222: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-comment'>-</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1223: </span>      <span class='hs-comment'>-- I (-1) * log (I a0 + R (sqrt $ 1 - a0^2))</span>
<span class=hs-linenum>1224: </span>      <span class='hs-comment'>-- I (-1) * log (C (sqrt $ 1 - a0^2) a0)</span>
<span class=hs-linenum>1225: </span>      <span class='hs-comment'>-- Def ==&gt; log (C a0 a123) = C (log.sqrt $ a0^2 + a123^2) (atan2 a123 a0)</span>
<span class=hs-linenum>1226: </span>      <span class='hs-comment'>-- I (-1) * C (log.sqrt $ (sqrt $ 1 - a0^2)^2 + a0^2) (atan2 a0 (sqrt $ 1 - a0^2))</span>
<span class=hs-linenum>1227: </span>      <span class='hs-comment'>-- C (atan2 a0 (sqrt $ 1 - a0^2)) (negate.log.sqrt $ (sqrt $ 1 - a0^2)^2 + a0^2)</span>
<span class=hs-linenum>1228: </span>      <span class='hs-comment'>-- C (atan(a0/(sqrt $ 1 - a0^2))) (negate.log.sqrt $ 1)</span>
<span class=hs-linenum>1229: </span>      <span class='hs-comment'>-- Apply sqrt 1 == 1, Apply log 1 == 0, reduce</span>
<span class=hs-linenum>1230: </span>      <span class='hs-comment'>-- R (atan(a0/(sqrt $ 1 - a0^2)))</span>
<span class=hs-linenum>1231: </span>      <span class='hs-comment'>-- Identity: tan(asin x) = x / (sqrt (1 - x^2))</span>
<span class=hs-linenum>1232: </span>      <span class='hs-comment'>-- R (asin a0)</span>
<span class=hs-linenum>1233: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>asin</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1234: </span>      <span class='hs-comment'>-- I (-1) * log (I a0 + sqrt (R (1 - a0^2)))</span>
<span class=hs-linenum>1235: </span>      <span class='hs-comment'>-- I (-1) * log (I (a0 + (sqrt.negate $ 1 - a0^2)))</span>
<span class=hs-linenum>1236: </span>      <span class='hs-comment'>-- Def ==&gt; log (I a123) = C (log.abs $ a123) (signum a123 * (pi/2))</span>
<span class=hs-linenum>1237: </span>      <span class='hs-comment'>-- I (-1) * C (log.abs $ (a0 + (sqrt.negate $ 1 - a0^2))) (signum (a0 + (sqrt.negate $ 1 - a0^2)) * (pi/2))</span>
<span class=hs-linenum>1238: </span>      <span class='hs-comment'>-- C (signum (a0 + (sqrt.negate $ 1 - a0^2)) * (pi/2)) (negate.log.abs $ (a0 + (sqrt.negate $ 1 - a0^2)))</span>
<span class=hs-linenum>1239: </span>      <span class='hs-comment'>-- For the negative branch signum is -1</span>
<span class=hs-linenum>1240: </span>      <span class='hs-comment'>-- C (-pi/2) (negate.log.abs $ (a0 + (sqrt $ a0^2 - 1)))</span>
<span class=hs-linenum>1241: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-comment'>-</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1242: </span>      <span class='hs-comment'>--</span>
<span class=hs-linenum>1243: </span>      <span class='hs-comment'>-- For I:</span>
<span class=hs-linenum>1244: </span>      <span class='hs-comment'>-- I (-1) * log (I (1) * I a123 + sqrt (R 1 - (I a123)^2))</span>
<span class=hs-linenum>1245: </span>      <span class='hs-comment'>-- I (-1) * log (R (-a123) + sqrt (R 1 - (I a123)^2))</span>
<span class=hs-linenum>1246: </span>      <span class='hs-comment'>-- I (-1) * log (R (-a123) + sqrt (R 1 - R (-a123^2)))</span>
<span class=hs-linenum>1247: </span>      <span class='hs-comment'>-- I (-1) * log (R (-a123) + sqrt (R (1 + a123^2)))</span>
<span class=hs-linenum>1248: </span>      <span class='hs-comment'>-- I (-1) * log (R (-a123) + R (sqrt $ 1 + a123^2))</span>
<span class=hs-linenum>1249: </span>      <span class='hs-comment'>-- I (-1) * log (R ((sqrt $ 1 + a123^2) - a123))</span>
<span class=hs-linenum>1250: </span>      <span class='hs-comment'>-- ((sqrt $ 1 + a123^2) - a123)) is always positive</span>
<span class=hs-linenum>1251: </span>      <span class='hs-comment'>-- Def ==&gt; log (R a0) | a0 &gt;= 0 = R (log a0)</span>
<span class=hs-linenum>1252: </span>      <span class='hs-comment'>-- I (-1) * (R (log $ (sqrt $ 1 + a123^2) - a123))</span>
<span class=hs-linenum>1253: </span>      <span class='hs-comment'>-- I (negate.log $ (sqrt $ 1 + a123^2) - a123)</span>
<span class=hs-linenum>1254: </span>      <span class='hs-comment'>-- I (negate.log $ (sqrt $ 1 + a123^2) - a123)</span>
<span class=hs-linenum>1255: </span>      <span class='hs-comment'>-- because ((sqrt $ 1 + a123^2) - a123)) is always positive: negate.log == log.recip</span>
<span class=hs-linenum>1256: </span>      <span class='hs-comment'>-- I (log.recip $ (sqrt $ 1 + a123^2) - a123)</span>
<span class=hs-linenum>1257: </span>      <span class='hs-comment'>-- recip $ (sqrt $ 1 + a123^2) - a123) == (sqrt $ 1 + a123^2) + a123)</span>
<span class=hs-linenum>1258: </span>      <span class='hs-comment'>-- I (log $ (sqrt $ 1 + a123^2) + a123)</span>
<span class=hs-linenum>1259: </span>      <span class='hs-comment'>-- I (asinh a123)</span>
<span class=hs-linenum>1260: </span>  <span class='hs-varid'>asin</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1261: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1262: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>asinh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1263: </span>    <span class='hs-comment'>--</span>
<span class=hs-linenum>1264: </span>  <span class='hs-varid'>asin</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1265: </span>      <span class='hs-comment'>-- For C:</span>
<span class=hs-linenum>1266: </span>      <span class='hs-comment'>-- I (-1) * log (I 1 * C a0 a123 + sqrt (R 1 - (C a0 a123)^2))</span>
<span class=hs-linenum>1267: </span>      <span class='hs-comment'>-- I (-1) * log (C (-a123) a0 + sqrt (R 1 - (C a0 a123)^2))</span>
<span class=hs-linenum>1268: </span>      <span class='hs-comment'>-- I (-1) * log (C (-a123) a0 + sqrt (C (1 - a0^2 + a123^2) (-2*a0*a123)))</span>
<span class=hs-linenum>1269: </span>      <span class='hs-comment'>-- Def ==&gt; sqrt (C a0 a123) = C ((sqrt.sqrt $ a0^2 + a123^2) * cos (atan2 a123 a0 / 2)) ((sqrt.sqrt $ a0^2 + a123^2) * sin (atan2 a123 a0 / 2))</span>
<span class=hs-linenum>1270: </span>      <span class='hs-comment'>-- I (-1) * log (C (-a123) a0 + C ((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * cos (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) ((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * sin (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)))</span>
<span class=hs-linenum>1271: </span>      <span class='hs-comment'>-- I (-1) * log (C (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * cos (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) - a123) (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * sin (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) + a0))</span>
<span class=hs-linenum>1272: </span>      <span class='hs-comment'>-- Def ==&gt; log (C a0 a123) = C (log.sqrt $ a0^2 + a123^2) (atan2 a123 a0)</span>
<span class=hs-linenum>1273: </span>      <span class='hs-comment'>-- C (atan2 (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * sin (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) + a0)</span>
<span class=hs-linenum>1274: </span>      <span class='hs-comment'>--          (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * cos (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) - a123))</span>
<span class=hs-linenum>1275: </span>      <span class='hs-comment'>--   (negate.log.sqrt $ (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * cos (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) - a123)^2 +</span>
<span class=hs-linenum>1276: </span>      <span class='hs-comment'>--                      (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * sin (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) + a0)^2)</span>
<span class=hs-linenum>1277: </span>      <span class='hs-comment'>-- Collect like terms:</span>
<span class=hs-linenum>1278: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>theta</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1279: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>rho</span></a> <span class='hs-keyglyph'>=</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1280: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>b0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == rho}</span><span class='hs-varid'>rho</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == theta}</span><span class='hs-varid'>theta</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>1281: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>b123</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == rho}</span><span class='hs-varid'>rho</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == theta}</span><span class='hs-varid'>theta</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1282: </span>    <span class='hs-keyword'>in</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>atan2</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b123}</span><span class='hs-varid'>b123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b0}</span><span class='hs-varid'>b0</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b0}</span><span class='hs-varid'>b0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b123}</span><span class='hs-varid'>b123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1283: </span>    <span class='hs-comment'>--</span>
<span class=hs-linenum>1284: </span>  <span class='hs-varid'>asin</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v &gt;= (-1.0)
                                 &amp;&amp; v &lt;= 1.0} -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>asin</span></a></span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>asin'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1285: </span>
<span class=hs-linenum>1286: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1287: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>acos</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1288: </span>      <span class='hs-comment'>-- acos x == (pi/2) - asin x so just subistute</span>
<span class=hs-linenum>1289: </span>      <span class='hs-comment'>-- For R a0 &gt; 1:</span>
<span class=hs-linenum>1290: </span>      <span class='hs-comment'>-- R (pi/2) - C (pi/2) (negate.log $ (a0 + (sqrt $ a0^2 - 1)))</span>
<span class=hs-linenum>1291: </span>      <span class='hs-comment'>-- C 0 (negate.negate.log $ (a0 + (sqrt $ a0^2 - 1)))</span>
<span class=hs-linenum>1292: </span>      <span class='hs-comment'>-- I (log $ (a0 + (sqrt $ a0^2 - 1)))</span>
<span class=hs-linenum>1293: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>log</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-comment'>-</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1294: </span>      <span class='hs-comment'>-- For R a0 &gt; (-1)</span>
<span class=hs-linenum>1295: </span>      <span class='hs-comment'>-- R (pi/2) - R (asin a0) == R (acos a0)</span>
<span class=hs-linenum>1296: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>acos</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1297: </span>      <span class='hs-comment'>-- For R otherwise:</span>
<span class=hs-linenum>1298: </span>      <span class='hs-comment'>-- R (pi/2) - C (-pi/2) (negate.log.abs $ (a0 + (sqrt $ a0^2 - 1)))</span>
<span class=hs-linenum>1299: </span>      <span class='hs-comment'>-- C pi (negate.negate.log.abs $ (a0 + (sqrt $ a0^2 - 1)))</span>
<span class=hs-linenum>1300: </span>      <span class='hs-comment'>-- C pi (log.abs $ (a0 + (sqrt $ a0^2 - 1)))</span>
<span class=hs-linenum>1301: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-comment'>-</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1302: </span>      <span class='hs-comment'>--</span>
<span class=hs-linenum>1303: </span>      <span class='hs-comment'>-- For I:</span>
<span class=hs-linenum>1304: </span>      <span class='hs-comment'>-- asin (I a123)  = I (asinh a123) -- so,</span>
<span class=hs-linenum>1305: </span>      <span class='hs-comment'>-- acos x == R (pi/2) - I (asinh a123)</span>
<span class=hs-linenum>1306: </span>      <span class='hs-comment'>-- C (pi/2) (negate $ asinh a123)</span>
<span class=hs-linenum>1307: </span>  <span class='hs-varid'>acos</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1308: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1309: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>asinh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1310: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1311: </span>  <span class='hs-varid'>acos</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1312: </span>      <span class='hs-comment'>-- For C:</span>
<span class=hs-linenum>1313: </span>      <span class='hs-comment'>-- asin (C a0 a123) = C (atan2 (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * sin (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) + a0) (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * cos (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) - a123)) (negate.log.sqrt $ (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * cos (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) - a123)^2 + (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * sin (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) + a0)^2)</span>
<span class=hs-linenum>1314: </span>      <span class='hs-comment'>-- acos x == (pi/2) - asin x so just subistute</span>
<span class=hs-linenum>1315: </span>      <span class='hs-comment'>-- R (pi/2) - C (atan2 (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * sin (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) + a0) (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * cos (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) - a123)) (negate.log.sqrt $ (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * cos (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) - a123)^2 + (((sqrt.sqrt $ (1 - a0^2 + a123^2)^2 + (-2*a0*a123)^2) * sin (atan2 (-2*a0*a123) (1 - a0^2 + a123^2) / 2)) + a0)^2)</span>
<span class=hs-linenum>1316: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>theta</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1317: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>rho</span></a> <span class='hs-keyglyph'>=</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1318: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>b0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == rho}</span><span class='hs-varid'>rho</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == theta}</span><span class='hs-varid'>theta</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>1319: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>b123</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == rho}</span><span class='hs-varid'>rho</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == theta}</span><span class='hs-varid'>theta</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1320: </span>    <span class='hs-keyword'>in</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b123}</span><span class='hs-varid'>b123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b0}</span><span class='hs-varid'>b0</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b0}</span><span class='hs-varid'>b0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b123}</span><span class='hs-varid'>b123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1321: </span>    <span class='hs-comment'>--</span>
<span class=hs-linenum>1322: </span>  <span class='hs-varid'>acos</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>acos</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>acos'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1323: </span>
<span class=hs-linenum>1324: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1325: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>atan</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>atan</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1326: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1327: </span>  <span class='hs-varid'>atan</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1328: </span>      <span class='hs-comment'>-- I (0.5) * (log (R 1 - (I 1 * I a123)) - log (R 1 + (I 1 * I a123)))</span>
<span class=hs-linenum>1329: </span>      <span class='hs-comment'>-- I (0.5) * (log (R 1 - (R (-a123))) - log (R 1 + (R (-a123))))</span>
<span class=hs-linenum>1330: </span>      <span class='hs-comment'>-- I (0.5) * ((log (R (1 + a123))) - log (R (1 - a123)))</span>
<span class=hs-linenum>1331: </span>      <span class='hs-comment'>-- Def ==&gt; C (log.negate $ a0) pi for negative a123</span>
<span class=hs-linenum>1332: </span>      <span class='hs-comment'>-- I (0.5) * ((log (R (1 + a123))) - (C (log.negate $ (1 - a123)) pi))</span>
<span class=hs-linenum>1333: </span>      <span class='hs-comment'>-- Def ==&gt; R (log a0) for positive a123</span>
<span class=hs-linenum>1334: </span>      <span class='hs-comment'>-- I (0.5) * ((R (log (1 + a123))) - (C (log.negate $ (1 - a123)) pi))</span>
<span class=hs-linenum>1335: </span>      <span class='hs-comment'>-- I (0.5) * (C (log (1 + a123) - (log.negate $ (1 - a123))) (-pi))</span>
<span class=hs-linenum>1336: </span>      <span class='hs-comment'>-- C (pi/2) ((log (1 + a123) - (log.negate $ (1 - a123)))/2)</span>
<span class=hs-linenum>1337: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1338: </span>      <span class='hs-comment'>-- I (0.5) * (log (R 1 - (I 1 * I a123)) - log (R 1 + (I 1 * I a123)))</span>
<span class=hs-linenum>1339: </span>      <span class='hs-comment'>-- I (0.5) * (log (R 1 - (R (-a123))) - log (R 1 + (R (-a123))))</span>
<span class=hs-linenum>1340: </span>      <span class='hs-comment'>-- I (0.5) * ((log (R (1 + a123))) - log (R (1 - a123)))</span>
<span class=hs-linenum>1341: </span>      <span class='hs-comment'>-- I (0.5) * ((R (log (1 + a123))) - R (log (1 - a123)))</span>
<span class=hs-linenum>1342: </span>      <span class='hs-comment'>-- I (0.5) * (R ((log (1 + a123)) - (log (1 - a123))))</span>
<span class=hs-linenum>1343: </span>      <span class='hs-comment'>-- I (((log (1 + a123)) - (log (1 - a123)))/2)</span>
<span class=hs-linenum>1344: </span>      <span class='hs-comment'>-- I (atanh a123)</span>
<span class=hs-linenum>1345: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1346: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>atanh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1347: </span>      <span class='hs-comment'>-- I (0.5) * (log (R 1 - (I 1 * I a123)) - log (R 1 + (I 1 * I a123)))</span>
<span class=hs-linenum>1348: </span>      <span class='hs-comment'>-- I (0.5) * (log (R 1 - (R (-a123))) - log (R 1 + (R (-a123))))</span>
<span class=hs-linenum>1349: </span>      <span class='hs-comment'>-- I (0.5) * ((log (R (1 + a123))) - R (log (1 - a123)))</span>
<span class=hs-linenum>1350: </span>      <span class='hs-comment'>-- C (-pi/2) (((log.negate $ (1 + a123)) - (log (1 - a123)))/2)</span>
<span class=hs-linenum>1351: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1352: </span>      <span class='hs-comment'>--</span>
<span class=hs-linenum>1353: </span>      <span class='hs-comment'>-- I (0.5) * (log (R 1 - (I 1 * C a0 a123)) - log (R 1 + (I 1 * C a0 a123)))</span>
<span class=hs-linenum>1354: </span>      <span class='hs-comment'>-- I (0.5) * (log (C (1 + a123) (-a0)) - log (C (1 - a123) a0))</span>
<span class=hs-linenum>1355: </span>      <span class='hs-comment'>-- Def ==&gt; log (C a0 a123) = C (log.sqrt $ a0^2 + a123^2) (atan2 a123 a0)</span>
<span class=hs-linenum>1356: </span>      <span class='hs-comment'>-- I (0.5) * ((C (log.sqrt $ (1 + a123)^2 + (-a0)^2) (atan2 (-a0) (1 + a123))) - (C (log.sqrt $ (1 - a123)^2 + a0^2) (atan2 a0 (1 - a123))))</span>
<span class=hs-linenum>1357: </span>      <span class='hs-comment'>-- I (0.5) * C ((log.sqrt $ (1 + a123)^2 + (-a0)^2) - (log.sqrt $ (1 - a123)^2 + a0^2)) ((atan2 (-a0) (1 + a123)) - (atan2 a0 (1 - a123)))</span>
<span class=hs-linenum>1358: </span>      <span class='hs-comment'>-- I (0.5) * C (0.5*((log $ (1 + a123)^2 + a0^2) - (log $ (1 - a123)^2 + a0^2))) ((atan2 (-a0) (1 + a123)) - (atan2 a0 (1 - a123)))</span>
<span class=hs-linenum>1359: </span>      <span class='hs-comment'>-- C (((atan2 a0 (1 - a123)) + (atan2 a0 (1 + a123)))/2) (((log $ (1 + a123)^2 + a0^2) - (log $ (1 - a123)^2 + a0^2))/4)</span>
<span class=hs-linenum>1360: </span>  <span class='hs-varid'>atan</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1361: </span>                       <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-comment'>-</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 4.0}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1362: </span>    <span class='hs-comment'>--</span>
<span class=hs-linenum>1363: </span>  <span class='hs-varid'>atan</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>atan</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>atan'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1364: </span>
<span class=hs-linenum>1365: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1366: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>sinh</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>sinh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1367: </span>  <span class='hs-varid'>sinh</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>sin</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1368: </span>  <span class='hs-varid'>sinh</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sinh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cosh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1369: </span>  <span class='hs-varid'>sinh</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>sinh</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>sinh'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1370: </span>
<span class=hs-linenum>1371: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1372: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cosh</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>cosh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1373: </span>  <span class='hs-varid'>cosh</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>cos</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1374: </span>  <span class='hs-varid'>cosh</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cosh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sinh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1375: </span>  <span class='hs-varid'>cosh</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cosh</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cosh'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1376: </span>
<span class=hs-linenum>1377: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1378: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>tanh</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tanh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1379: </span>  <span class='hs-varid'>tanh</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>tan</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1380: </span>  <span class='hs-varid'>tanh</span> <span class='hs-layout'>(</span><span class='hs-varid'>reduce</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1381: </span>    <span class='hs-keyword'>let</span>
<span class=hs-linenum>1382: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>m</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosy * coshx}</span><span class='hs-varid'>x2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == siny * sinhx
                        &amp;&amp; v == y2}</span><span class='hs-varid'>y2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1383: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosy * sinhx}</span><span class='hs-varid'>x1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosy}</span><span class='hs-varid'>cosy</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sinhx}</span><span class='hs-varid'>sinhx</span></a>
<span class=hs-linenum>1384: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == siny * coshx}</span><span class='hs-varid'>y1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == siny}</span><span class='hs-varid'>siny</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == coshx}</span><span class='hs-varid'>coshx</span></a>
<span class=hs-linenum>1385: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosy * coshx}</span><span class='hs-varid'>x2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosy}</span><span class='hs-varid'>cosy</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == coshx}</span><span class='hs-varid'>coshx</span></a>
<span class=hs-linenum>1386: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == siny * sinhx}</span><span class='hs-varid'>y2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == siny}</span><span class='hs-varid'>siny</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sinhx}</span><span class='hs-varid'>sinhx</span></a>
<span class=hs-linenum>1387: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>siny</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>1388: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cosy</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>1389: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sinhx</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sinh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1390: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>coshx</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cosh</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1391: </span>    <span class='hs-keyword'>in</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosy * sinhx
                        &amp;&amp; v == x1}</span><span class='hs-varid'>x1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosy * coshx}</span><span class='hs-varid'>x2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == siny * coshx
                        &amp;&amp; v == y1}</span><span class='hs-varid'>y1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == siny * sinhx
                        &amp;&amp; v == y2}</span><span class='hs-varid'>y2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>/</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == m}</span><span class='hs-varid'>m</span></a></span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosy * coshx}</span><span class='hs-varid'>x2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == siny * coshx
                        &amp;&amp; v == y1}</span><span class='hs-varid'>y1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cosy * sinhx
                        &amp;&amp; v == x1}</span><span class='hs-varid'>x1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == siny * sinhx
                        &amp;&amp; v == y2}</span><span class='hs-varid'>y2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>/</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == m}</span><span class='hs-varid'>m</span></a></span><span class='hs-layout'>)</span>
<span class=hs-linenum>1392: </span>  <span class='hs-varid'>tanh</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>tanh</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>tanh'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1393: </span>
<span class=hs-linenum>1394: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1395: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>asinh</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>asinh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1396: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1397: </span>  <span class='hs-varid'>asinh</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1398: </span>      <span class='hs-comment'>-- log (I a123 + sqrt (R (1 - a123^2)))</span>
<span class=hs-linenum>1399: </span>      <span class='hs-comment'>-- 3 branches where between -1 and 1 it is just asin</span>
<span class=hs-linenum>1400: </span>      <span class='hs-comment'>-- For a123 &gt; 1:</span>
<span class=hs-linenum>1401: </span>      <span class='hs-comment'>-- log (I a123 + I (sqrt.negate $ (1 - a123^2)))</span>
<span class=hs-linenum>1402: </span>      <span class='hs-comment'>-- log (I (a123 + (sqrt (a123^2 - 1))))</span>
<span class=hs-linenum>1403: </span>      <span class='hs-comment'>-- Def ==&gt; log (I a123) = C (log.abs $ a123) (signum a123 * (pi/2))</span>
<span class=hs-linenum>1404: </span>      <span class='hs-comment'>-- C (log.abs $ (a123 + (sqrt (a123^2 - 1)))) (signum (a123 + (sqrt (a123^2 - 1))) * (pi/2))</span>
<span class=hs-linenum>1405: </span>      <span class='hs-comment'>-- a123 is positive so signum evaluates to 1</span>
<span class=hs-linenum>1406: </span>      <span class='hs-comment'>-- C (log.abs $ (a123 + (sqrt (a123^2 - 1)))) (pi/2)</span>
<span class=hs-linenum>1407: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-comment'>-</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1408: </span>      <span class='hs-comment'>-- log (I a123 + sqrt (R (1 - a123^2)))</span>
<span class=hs-linenum>1409: </span>      <span class='hs-comment'>-- log (I a123 + R (sqrt (1 - a123^2)))</span>
<span class=hs-linenum>1410: </span>      <span class='hs-comment'>-- log (C (sqrt (1 - a123^2)) a123)</span>
<span class=hs-linenum>1411: </span>      <span class='hs-comment'>-- Def ==&gt; log (C a0 a123) = C (log.sqrt $ a0^2 + a123^2) (atan2 a123 a0)</span>
<span class=hs-linenum>1412: </span>      <span class='hs-comment'>-- C (log.sqrt $ (sqrt (1 - a123^2))^2 + a123^2) (atan2 a123 (sqrt (1 - a123^2)))</span>
<span class=hs-linenum>1413: </span>      <span class='hs-comment'>-- (sqrt (1 - a123^2))^2 + a123^2 == 1</span>
<span class=hs-linenum>1414: </span>      <span class='hs-comment'>-- sqrt 1 == 1</span>
<span class=hs-linenum>1415: </span>      <span class='hs-comment'>-- log 1 == 0</span>
<span class=hs-linenum>1416: </span>      <span class='hs-comment'>-- I (atan2 a123 (sqrt (1 - a123^2)))</span>
<span class=hs-linenum>1417: </span>      <span class='hs-comment'>-- I (atan (a123 / (sqrt (1 - a123^2))))</span>
<span class=hs-linenum>1418: </span>      <span class='hs-comment'>-- Identity: tan(asin x) = x / (sqrt (1 - x^2))</span>
<span class=hs-linenum>1419: </span>      <span class='hs-comment'>-- asin a123 = atan (a123 / (sqrt (1 - a123^2)))</span>
<span class=hs-linenum>1420: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1421: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>asin</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1422: </span>      <span class='hs-comment'>-- log (I a123 + sqrt (R (1 - a123^2)))</span>
<span class=hs-linenum>1423: </span>      <span class='hs-comment'>-- For a123 &lt; (-1):</span>
<span class=hs-linenum>1424: </span>      <span class='hs-comment'>-- log (I a123 + I (sqrt.negate $ (1 - a123^2)))</span>
<span class=hs-linenum>1425: </span>      <span class='hs-comment'>-- log (I (a123 + (sqrt (a123^2 - 1))))</span>
<span class=hs-linenum>1426: </span>      <span class='hs-comment'>-- Def ==&gt; log (I a123) = C (log.abs $ a123) (signum a123 * (pi/2))</span>
<span class=hs-linenum>1427: </span>      <span class='hs-comment'>-- C (log.abs $ (a123 + (sqrt (a123^2 - 1)))) (signum (a123 + (sqrt (a123^2 - 1))) * (pi/2))</span>
<span class=hs-linenum>1428: </span>      <span class='hs-comment'>-- for a123 lt (-1) signum evaluates to -1</span>
<span class=hs-linenum>1429: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-comment'>-</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1430: </span>    <span class='hs-comment'>--</span>
<span class=hs-linenum>1431: </span>  <span class='hs-varid'>asinh</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1432: </span>      <span class='hs-comment'>-- For C:</span>
<span class=hs-linenum>1433: </span>      <span class='hs-comment'>-- log (C a0 a123 + sqrt (C (a0^2 - a123^2 +1) (2*a0*a123)))</span>
<span class=hs-linenum>1434: </span>      <span class='hs-comment'>-- Def ==&gt; sqrt (C a0 a123) = C ((sqrt.sqrt $ a0^2 + a123^2) * cos (atan2 a123 a0 / 2)) ((sqrt.sqrt $ a0^2 + a123^2) * sin (atan2 a123 a0 / 2))</span>
<span class=hs-linenum>1435: </span>      <span class='hs-comment'>-- log (C a0 a123 + C ((sqrt.sqrt $ (a0^2 - a123^2 +1)^2 + (2*a0*a123)^2) * cos (atan2 (2*a0*a123) (a0^2 - a123^2 +1) / 2)) ((sqrt.sqrt $ (a0^2 - a123^2 +1)^2 + (2*a0*a123)^2) * sin (atan2 (2*a0*a123) (a0^2 - a123^2 +1) / 2)))</span>
<span class=hs-linenum>1436: </span>      <span class='hs-comment'>-- log (C (a0 + ((sqrt.sqrt $ (a0^2 - a123^2 +1)^2 + (2*a0*a123)^2) * cos (atan2 (2*a0*a123) (a0^2 - a123^2 +1) / 2))) (a123 + ((sqrt.sqrt $ (a0^2 - a123^2 +1)^2 + (2*a0*a123)^2) * sin (atan2 (2*a0*a123) (a0^2 - a123^2 +1) / 2))))</span>
<span class=hs-linenum>1437: </span>      <span class='hs-comment'>-- Def ==&gt; log (C a0 a123) = C (log.sqrt $ a0^2 + a123^2) (atan2 a123 a0)</span>
<span class=hs-linenum>1438: </span>      <span class='hs-comment'>-- C (log.sqrt $ (a0 + ((sqrt.sqrt $ (a0^2 - a123^2 +1)^2 + (2*a0*a123)^2) * cos (atan2 (2*a0*a123) (a0^2 - a123^2 +1) / 2)))^2 +</span>
<span class=hs-linenum>1439: </span>      <span class='hs-comment'>--               (a123 + ((sqrt.sqrt $ (a0^2 - a123^2 +1)^2 + (2*a0*a123)^2) * sin (atan2 (2*a0*a123) (a0^2 - a123^2 +1) / 2)))^2)</span>
<span class=hs-linenum>1440: </span>      <span class='hs-comment'>--   (atan2 (a123 + ((sqrt.sqrt $ (a0^2 - a123^2 +1)^2 + (2*a0*a123)^2) * sin (atan2 (2*a0*a123) (a0^2 - a123^2 +1) / 2)))</span>
<span class=hs-linenum>1441: </span>      <span class='hs-comment'>--          (a0 + ((sqrt.sqrt $ (a0^2 - a123^2 +1)^2 + (2*a0*a123)^2) * cos (atan2 (2*a0*a123) (a0^2 - a123^2 +1) / 2))))</span>
<span class=hs-linenum>1442: </span>      <span class='hs-comment'>-- Collect like terms:</span>
<span class=hs-linenum>1443: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>theta</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1444: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>rho</span></a> <span class='hs-keyglyph'>=</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1445: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>b0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == rho}</span><span class='hs-varid'>rho</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == theta}</span><span class='hs-varid'>theta</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1446: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>b123</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == rho}</span><span class='hs-varid'>rho</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == theta}</span><span class='hs-varid'>theta</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1447: </span>    <span class='hs-keyword'>in</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b0}</span><span class='hs-varid'>b0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b123}</span><span class='hs-varid'>b123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>atan2</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b123}</span><span class='hs-varid'>b123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b0}</span><span class='hs-varid'>b0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1448: </span>    <span class='hs-comment'>--</span>
<span class=hs-linenum>1449: </span>  <span class='hs-varid'>asinh</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>asinh</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>asinh'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1450: </span>
<span class=hs-linenum>1451: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1452: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>acosh</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1453: </span>    <span class='hs-comment'>-- log (R a0 + sqrt(R (a0+1)) * sqrt(R (a0-1)))</span>
<span class=hs-linenum>1454: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>acosh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1455: </span>      <span class='hs-comment'>-- log (R a0 + sqrt(R (a0+1)) * sqrt(R (a0-1)))</span>
<span class=hs-linenum>1456: </span>      <span class='hs-comment'>-- log (R a0 + R (sqrt $ a0+1) * R (sqrt $ a0-1))</span>
<span class=hs-linenum>1457: </span>      <span class='hs-comment'>-- log (R a0 + R ((sqrt $ a0+1) * (sqrt $ a0-1)))</span>
<span class=hs-linenum>1458: </span>      <span class='hs-comment'>-- log (R (a0 + (sqrt $ a0+1) * (sqrt $ a0-1)))</span>
<span class=hs-linenum>1459: </span>      <span class='hs-comment'>-- R (log $ a0 + (sqrt $ a0+1) * (sqrt $ a0-1))</span>
<span class=hs-linenum>1460: </span>      <span class='hs-comment'>-- R (acosh a0)</span>
<span class=hs-linenum>1461: </span>      <span class='hs-comment'>-- Strangely ghc substitutes 'acosh a0' with something like:</span>
<span class=hs-linenum>1462: </span>      <span class='hs-comment'>-- R (log $ a0 + (a0 + 1 ) * (sqrt $ (a0 - 1)/(a0 + 1)))</span>
<span class=hs-linenum>1463: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>atan2</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-- This is I because of cancelation of the real component</span>
<span class=hs-linenum>1464: </span>      <span class='hs-comment'>-- log (R a0 + sqrt(R (a0+1)) * sqrt(R (a0-1)))</span>
<span class=hs-linenum>1465: </span>      <span class='hs-comment'>-- log (R a0 + R (sqrt $ a0+1) * I (sqrt.negate $ a0-1))</span>
<span class=hs-linenum>1466: </span>      <span class='hs-comment'>-- log (R a0 + I ((sqrt $ a0+1) * (sqrt.negate $ a0-1)))</span>
<span class=hs-linenum>1467: </span>      <span class='hs-comment'>-- log (R a0 + I ((sqrt $ a0+1) * (sqrt $ 1-a0)))</span>
<span class=hs-linenum>1468: </span>      <span class='hs-comment'>-- log $ C (a0) ((sqrt $ a0+1) * (sqrt $ 1-a0))</span>
<span class=hs-linenum>1469: </span>      <span class='hs-comment'>-- Def log ==&gt; log (C b0 b123) = C (log.sqrt $ b0^2 + b123^2) (atan2 b123 b0)</span>
<span class=hs-linenum>1470: </span>      <span class='hs-comment'>-- let b0 = a0</span>
<span class=hs-linenum>1471: </span>      <span class='hs-comment'>--     b123 = (sqrt $ a0+1) * (sqrt $ 1-a0) = sqrt $ 1-a0^2</span>
<span class=hs-linenum>1472: </span>      <span class='hs-comment'>-- in C (log.sqrt $ b0^2 + b123^2) (atan2 b123 b0)</span>
<span class=hs-linenum>1473: </span>      <span class='hs-comment'>-- b123^2 = 1-a0^2</span>
<span class=hs-linenum>1474: </span>      <span class='hs-comment'>-- C (log.sqrt $ a0^2 + 1-a0^2) (atan2 (sqrt $ 1-a0^2) a0)</span>
<span class=hs-linenum>1475: </span>      <span class='hs-comment'>-- C (log.sqrt $ 1) (atan2 (sqrt $ 1-a0^2) a0)</span>
<span class=hs-linenum>1476: </span>      <span class='hs-comment'>-- C 0 (atan2 (sqrt $ 1-a0^2) a0)</span>
<span class=hs-linenum>1477: </span>      <span class='hs-comment'>-- I (atan2 (sqrt $ 1-a0^2) a0)</span>
<span class=hs-linenum>1478: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>acosh</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a>
<span class=hs-linenum>1479: </span>      <span class='hs-comment'>-- log (R a0 + sqrt(R (a0+1)) * sqrt(R (a0-1)))</span>
<span class=hs-linenum>1480: </span>      <span class='hs-comment'>-- log (R a0 + I (sqrt.negate $ a0+1) * I (sqrt.negate $ a0-1))</span>
<span class=hs-linenum>1481: </span>      <span class='hs-comment'>-- Def ==&gt; (I a123) * (I b123) = R (negate $ a123*b123)</span>
<span class=hs-linenum>1482: </span>      <span class='hs-comment'>-- log (R a0 + R (negate $ (sqrt.negate $ a0+1) * (sqrt.negate $ a0-1))</span>
<span class=hs-linenum>1483: </span>      <span class='hs-comment'>-- log (R (a0 + (negate $ (sqrt.negate $ a0+1) * (sqrt.negate $ a0-1))))</span>
<span class=hs-linenum>1484: </span>      <span class='hs-comment'>-- C (log.negate $ (a0 + (negate $ (sqrt.negate $ a0+1) * (sqrt.negate $ a0-1)))) pi</span>
<span class=hs-linenum>1485: </span>      <span class='hs-comment'>-- C (log $ (negate a0 + ((sqrt $ (negate a0)+1) * (sqrt $ (negate a0)-1)))) pi</span>
<span class=hs-linenum>1486: </span>      <span class='hs-comment'>-- C (acosh (negate a0)) pi</span>
<span class=hs-linenum>1487: </span>      <span class='hs-comment'>--</span>
<span class=hs-linenum>1488: </span>  <span class='hs-varid'>acosh</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1489: </span>      <span class='hs-comment'>-- log (I a123 + sqrt(C 1 a123) * sqrt(C (-1) a123))</span>
<span class=hs-linenum>1490: </span>      <span class='hs-comment'>-- Def ==&gt; sqrt (C a0 a123) =</span>
<span class=hs-linenum>1491: </span>      <span class='hs-comment'>--   C ((sqrt.sqrt $ a0^2 + a123^2) * cos (atan2 a123 a0 / 2))</span>
<span class=hs-linenum>1492: </span>      <span class='hs-comment'>--      ((sqrt.sqrt $ a0^2 + a123^2) * sin (atan2 a123 a0 / 2))</span>
<span class=hs-linenum>1493: </span>      <span class='hs-comment'>-- log (I a123 +</span>
<span class=hs-linenum>1494: </span>      <span class='hs-comment'>--      C ((sqrt.sqrt $ 1 + a123^2) * cos (atan2 a123 1 / 2))</span>
<span class=hs-linenum>1495: </span>      <span class='hs-comment'>--        ((sqrt.sqrt $ 1 + a123^2) * sin (atan2 a123 1 / 2)) *</span>
<span class=hs-linenum>1496: </span>      <span class='hs-comment'>--      C ((sqrt.sqrt $ 1 + a123^2) * cos (atan2 a123 (-1) / 2))</span>
<span class=hs-linenum>1497: </span>      <span class='hs-comment'>--        ((sqrt.sqrt $ 1 + a123^2) * sin (atan2 a123 (-1) / 2)) )</span>
<span class=hs-linenum>1498: </span>      <span class='hs-comment'>-- Factor out "(sqrt.sqrt $ 1 + a123^2)*"</span>
<span class=hs-linenum>1499: </span>      <span class='hs-comment'>-- log (I a123 + R (sqrt.sqrt $ 1 + a123^2) *</span>
<span class=hs-linenum>1500: </span>      <span class='hs-comment'>--               C (cos (atan2 a123 1 / 2)) (sin (atan2 a123 1 / 2)) *</span>
<span class=hs-linenum>1501: </span>      <span class='hs-comment'>--               R (sqrt.sqrt $ 1 + a123^2) *</span>
<span class=hs-linenum>1502: </span>      <span class='hs-comment'>--               C (cos (atan2 a123 (-1) / 2)) (sin (atan2 a123 (-1) / 2)))</span>
<span class=hs-linenum>1503: </span>      <span class='hs-comment'>-- Collect both R's and simplify</span>
<span class=hs-linenum>1504: </span>      <span class='hs-comment'>-- log (I a123 + (R (sqrt $ 1 + a123^2)) *</span>
<span class=hs-linenum>1505: </span>      <span class='hs-comment'>--                C (cos (atan2 a123 1 / 2)) (sin (atan2 a123 1 / 2)) *</span>
<span class=hs-linenum>1506: </span>      <span class='hs-comment'>--                C (cos (atan2 a123 (-1) / 2)) (sin (atan2 a123 (-1) / 2)))</span>
<span class=hs-linenum>1507: </span>      <span class='hs-comment'>-- Def ==&gt; (C a0 a123) * (C b0 b123) = C (a0*b0 - a123*b123) (a0*b123 + a123*b0)</span>
<span class=hs-linenum>1508: </span>      <span class='hs-comment'>-- log (I a123 + R (sqrt $ 1 + a123^2) *</span>
<span class=hs-linenum>1509: </span>      <span class='hs-comment'>--               C ((cos (atan2 a123 1 / 2))*(cos (atan2 a123 (-1) / 2)) - (sin (atan2 a123 1 / 2))*(sin (atan2 a123 (-1) / 2)))</span>
<span class=hs-linenum>1510: </span>      <span class='hs-comment'>--                 ((cos (atan2 a123 1 / 2))*(sin (atan2 a123 (-1) / 2)) + (sin (atan2 a123 1 / 2))*(cos (atan2 a123 (-1) / 2))) )</span>
<span class=hs-linenum>1511: </span>      <span class='hs-comment'>--</span>
<span class=hs-linenum>1512: </span>      <span class='hs-comment'>-- Solution now branches for positive and negative a123</span>
<span class=hs-linenum>1513: </span>      <span class='hs-comment'>--</span>
<span class=hs-linenum>1514: </span>      <span class='hs-comment'>-- For a123 &gt; 0 Substitute (cos (atan2 a123 (-1) / 2)) == (sin (atan2 a123 1 / 2)) AND</span>
<span class=hs-linenum>1515: </span>      <span class='hs-comment'>--                         (sin (atan2 a123 (-1) / 2)) == (cos (atan2 a123 1 / 2)) AND</span>
<span class=hs-linenum>1516: </span>      <span class='hs-comment'>--                         atan2 a123 1 == atan a123</span>
<span class=hs-linenum>1517: </span>      <span class='hs-comment'>-- log (I a123 + R (sqrt $ 1 + a123^2) *</span>
<span class=hs-linenum>1518: </span>      <span class='hs-comment'>--               C ((cos (atan a123 / 2))*(sin (atan a123 / 2)) - (sin (atan a123 / 2))*(cos (atan a123 / 2)))</span>
<span class=hs-linenum>1519: </span>      <span class='hs-comment'>--                 ((cos (atan a123 / 2))*(cos (atan a123 / 2)) + (sin (atan a123 / 2))*(sin (atan a123 / 2))) )</span>
<span class=hs-linenum>1520: </span>      <span class='hs-comment'>-- sin^2 + cos^2 == 1 AND cos*sin - sin*cos == 0 AND Reduce C 0 1 to I 1 AND apply (*) AND apply (+)</span>
<span class=hs-linenum>1521: </span>      <span class='hs-comment'>-- log (I (a123 + sqrt (1 + a123^2)))</span>
<span class=hs-linenum>1522: </span>      <span class='hs-comment'>-- Def ==&gt; log (I a123) = C (log.abs $ a123) (signum a123 * (pi/2))</span>
<span class=hs-linenum>1523: </span>      <span class='hs-comment'>-- C (log.abs $ (a123 + sqrt (1 + a123^2))) (signum (a123 + sqrt (1 + a123^2)) * (pi/2))</span>
<span class=hs-linenum>1524: </span>      <span class='hs-comment'>-- With a123 positive Apply signum:</span>
<span class=hs-linenum>1525: </span>      <span class='hs-comment'>-- C (log.abs $ (a123 + sqrt (1 + a123^2))) (pi/2)</span>
<span class=hs-linenum>1526: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1527: </span>      <span class='hs-comment'>-- With a123 == 0:</span>
<span class=hs-linenum>1528: </span>      <span class='hs-comment'>-- reduce C 0 (pi/2)</span>
<span class=hs-linenum>1529: </span>      <span class='hs-comment'>-- I (pi/2)</span>
<span class=hs-linenum>1530: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1531: </span>      <span class='hs-comment'>-- For a123 &lt; 0 Substitute (cos (atan2 a123 (-1) / 2)) == (negate.sin $ (atan2 a123 1 / 2)) AND</span>
<span class=hs-linenum>1532: </span>      <span class='hs-comment'>--                         (sin (atan2 a123 (-1) / 2)) == (negate.cos $ (atan2 a123 1 / 2)) AND</span>
<span class=hs-linenum>1533: </span>      <span class='hs-comment'>--                         atan2 a123 1 == atan a123</span>
<span class=hs-linenum>1534: </span>      <span class='hs-comment'>-- log (I a123 + R (sqrt $ 1 + a123^2) *</span>
<span class=hs-linenum>1535: </span>      <span class='hs-comment'>--               C ((cos (atan2 a123 1 / 2))*(negate.sin $ (atan2 a123 1 / 2)) - (sin (atan2 a123 1 / 2))*(negate.cos $ (atan2 a123 1 / 2)))</span>
<span class=hs-linenum>1536: </span>      <span class='hs-comment'>--                 ((cos (atan2 a123 1 / 2))*(negate.cos $ (atan2 a123 1 / 2)) + (sin (atan2 a123 1 / 2))*(negate.sin $ (atan2 a123 1 / 2))) )</span>
<span class=hs-linenum>1537: </span>      <span class='hs-comment'>-- Factor negate out AND sin^2 + cos^2 == 1 AND cos*sin - sin*cos == 0 AND Reduce C 0 (-1) to I (-1) AND apply (*) AND apply (+)</span>
<span class=hs-linenum>1538: </span>      <span class='hs-comment'>-- log (I (a123 - sqrt (1 + a123^2)))</span>
<span class=hs-linenum>1539: </span>      <span class='hs-comment'>-- Def ==&gt; log (I a123) = C (log.abs $ a123) (signum a123 * (pi/2))</span>
<span class=hs-linenum>1540: </span>      <span class='hs-comment'>-- C (log.abs $ (a123 - sqrt (1 + a123^2))) (signum (a123 - sqrt (1 + a123^2)) * (pi/2))</span>
<span class=hs-linenum>1541: </span>      <span class='hs-comment'>-- With a123 negateive Apply signum:</span>
<span class=hs-linenum>1542: </span>      <span class='hs-comment'>-- C (log.abs $ (a123 - sqrt (1 + a123^2))) (-pi/2)</span>
<span class=hs-linenum>1543: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1544: </span>    <span class='hs-comment'>--</span>
<span class=hs-linenum>1545: </span>  <span class='hs-varid'>acosh</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1546: </span>      <span class='hs-comment'>-- log (C a0 a123 + sqrt(C (a0+1) a123) * sqrt(C (a0-1) a123))</span>
<span class=hs-linenum>1547: </span>      <span class='hs-comment'>-- Def ==&gt; sqrt (C a0 a123) =</span>
<span class=hs-linenum>1548: </span>      <span class='hs-comment'>--   C ((sqrt.sqrt $ a0^2 + a123^2) * cos (atan2 a123 a0 / 2))</span>
<span class=hs-linenum>1549: </span>      <span class='hs-comment'>--      ((sqrt.sqrt $ a0^2 + a123^2) * sin (atan2 a123 a0 / 2))</span>
<span class=hs-linenum>1550: </span>      <span class='hs-comment'>-- log (C a0 a123 +</span>
<span class=hs-linenum>1551: </span>      <span class='hs-comment'>--      C ((sqrt.sqrt $ (a0+1)^2 + a123^2) * cos (atan2 a123 (a0+1) / 2))</span>
<span class=hs-linenum>1552: </span>      <span class='hs-comment'>--        ((sqrt.sqrt $ (a0+1)^2 + a123^2) * sin (atan2 a123 (a0+1) / 2)) *</span>
<span class=hs-linenum>1553: </span>      <span class='hs-comment'>--      C ((sqrt.sqrt $ (a0-1)^2 + a123^2) * cos (atan2 a123 (a0-1) / 2))</span>
<span class=hs-linenum>1554: </span>      <span class='hs-comment'>--        ((sqrt.sqrt $ (a0-1)^2 + a123^2) * sin (atan2 a123 (a0-1) / 2)) )</span>
<span class=hs-linenum>1555: </span>      <span class='hs-comment'>-- Factor out the scalar in both Complex numbers</span>
<span class=hs-linenum>1556: </span>      <span class='hs-comment'>-- log (C a0 a123 +</span>
<span class=hs-linenum>1557: </span>      <span class='hs-comment'>--      R (sqrt.sqrt $ (a0+1)^2 + a123^2) *</span>
<span class=hs-linenum>1558: </span>      <span class='hs-comment'>--      C (cos (atan2 a123 (a0+1) / 2)) (sin (atan2 a123 (a0+1) / 2)) *</span>
<span class=hs-linenum>1559: </span>      <span class='hs-comment'>--      R (sqrt.sqrt $ (a0-1)^2 + a123^2) *</span>
<span class=hs-linenum>1560: </span>      <span class='hs-comment'>--      C (cos (atan2 a123 (a0-1) / 2)) (sin (atan2 a123 (a0-1) / 2)) )</span>
<span class=hs-linenum>1561: </span>      <span class='hs-comment'>-- Combine the R terms</span>
<span class=hs-linenum>1562: </span>      <span class='hs-comment'>-- log (C a0 a123 +</span>
<span class=hs-linenum>1563: </span>      <span class='hs-comment'>--      R (sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) *</span>
<span class=hs-linenum>1564: </span>      <span class='hs-comment'>--      C (cos (atan2 a123 (a0+1) / 2)) (sin (atan2 a123 (a0+1) / 2)) *</span>
<span class=hs-linenum>1565: </span>      <span class='hs-comment'>--      C (cos (atan2 a123 (a0-1) / 2)) (sin (atan2 a123 (a0-1) / 2)) )</span>
<span class=hs-linenum>1566: </span>      <span class='hs-comment'>-- Def ==&gt; (C a0 a123) * (C b0 b123) = C (a0*b0 - a123*b123)</span>
<span class=hs-linenum>1567: </span>      <span class='hs-comment'>--                                       (a0*b123 + a123*b0)</span>
<span class=hs-linenum>1568: </span>      <span class='hs-comment'>-- log (C a0 a123 +</span>
<span class=hs-linenum>1569: </span>      <span class='hs-comment'>--      R (sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) *</span>
<span class=hs-linenum>1570: </span>      <span class='hs-comment'>--      C (((cos (atan2 a123 (a0+1) / 2))*(cos (atan2 a123 (a0-1) / 2))) - ((sin (atan2 a123 (a0+1) / 2))*(sin (atan2 a123 (a0-1) / 2))))</span>
<span class=hs-linenum>1571: </span>      <span class='hs-comment'>--        (((cos (atan2 a123 (a0+1) / 2))*(sin (atan2 a123 (a0-1) / 2))) + ((sin (atan2 a123 (a0+1) / 2))*(cos (atan2 a123 (a0-1) / 2)))) )</span>
<span class=hs-linenum>1572: </span>      <span class='hs-comment'>-- =</span>
<span class=hs-linenum>1573: </span>      <span class='hs-comment'>-- log (C a0 a123 +</span>
<span class=hs-linenum>1574: </span>      <span class='hs-comment'>--      R (sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) *</span>
<span class=hs-linenum>1575: </span>      <span class='hs-comment'>--      C (cos(0.5*(atan2 a123 (a0+1) + atan2 a123 (a0-1))))</span>
<span class=hs-linenum>1576: </span>      <span class='hs-comment'>--        (sin(0.5*(atan2 a123 (a0-1) + atan2 a123 (a0+1)))) )</span>
<span class=hs-linenum>1577: </span>      <span class='hs-comment'>-- Apply (*)</span>
<span class=hs-linenum>1578: </span>      <span class='hs-comment'>-- log (C a0 a123 +</span>
<span class=hs-linenum>1579: </span>      <span class='hs-comment'>--      C ((sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) *(cos(0.5*(atan2 a123 (a0+1) + atan2 a123 (a0-1)))))</span>
<span class=hs-linenum>1580: </span>      <span class='hs-comment'>--        ((sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) *(sin(0.5*(atan2 a123 (a0-1) + atan2 a123 (a0+1))))) )</span>
<span class=hs-linenum>1581: </span>      <span class='hs-comment'>-- Apply (+)</span>
<span class=hs-linenum>1582: </span>      <span class='hs-comment'>-- log (C (a0 + (sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) * ((cos(0.5*(atan2 a123 (a0+1) + atan2 a123 (a0-1))))))</span>
<span class=hs-linenum>1583: </span>      <span class='hs-comment'>--        (a123 + (sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) * ((sin(0.5*(atan2 a123 (a0-1) + atan2 a123 (a0+1)))))) )</span>
<span class=hs-linenum>1584: </span>      <span class='hs-comment'>-- Def ==&gt;  log (C a0 a123) = C (log.sqrt $ a0^2 + a123^2) (atan2 a123 a0)</span>
<span class=hs-linenum>1585: </span>      <span class='hs-comment'>-- = C (log.sqrt $ (a0 + (sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) * ((cos(0.5*(atan2 a123 (a0+1) + atan2 a123 (a0-1))))))^2 + (a123 + (sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) * ((sin(0.5*(atan2 a123 (a0-1) + atan2 a123 (a0+1))))))^2) </span>
<span class=hs-linenum>1586: </span>      <span class='hs-comment'>--     (atan2 (a123 + (sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) * ((sin(0.5*(atan2 a123 (a0-1) + atan2 a123 (a0+1)))))) (a0 + (sqrt.sqrt $ ((a0+1)^2 + a123^2) * ((a0-1)^2 + a123^2)) * ((cos(0.5*(atan2 a123 (a0+1) + atan2 a123 (a0-1)))))))</span>
<span class=hs-linenum>1587: </span>      <span class='hs-comment'>-- Collect like terms:</span>
<span class=hs-linenum>1588: </span>    <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>theta</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1589: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>rho</span></a> <span class='hs-keyglyph'>=</span> <span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1590: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>b0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == rho}</span><span class='hs-varid'>rho</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cos</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == theta}</span><span class='hs-varid'>theta</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1591: </span>        <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>b123</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == rho}</span><span class='hs-varid'>rho</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sin</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == theta}</span><span class='hs-varid'>theta</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1592: </span>    <span class='hs-keyword'>in</span> <span class='hs-conid'>C</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b0}</span><span class='hs-varid'>b0</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b123}</span><span class='hs-varid'>b123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>atan2</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b123}</span><span class='hs-varid'>b123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == b0}</span><span class='hs-varid'>b0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1593: </span>    <span class='hs-comment'>--</span>
<span class=hs-linenum>1594: </span>  <span class='hs-varid'>acosh</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>acosh</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>acosh'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1595: </span>
<span class=hs-linenum>1596: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1597: </span>  <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>atanh</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1598: </span>      <span class='hs-comment'>-- = 0.5*log (R (1+a0)) - 0.5*log (R (1-a0))</span>
<span class=hs-linenum>1599: </span>      <span class='hs-comment'>-- = (R ((0.5*).log $ 1+a0)) - (C ((0.5*).log.negate $ 1-a0) (pi/2))</span>
<span class=hs-linenum>1600: </span>      <span class='hs-comment'>-- = C (((0.5*).log $ 1+a0) - ((0.5*).log.negate $ 1-a0)) (-pi/2)</span>
<span class=hs-linenum>1601: </span>      <span class='hs-comment'>-- = C (0.5*((log $ 1+a0) - (log $ a0-1))) (-pi/2)</span>
<span class=hs-linenum>1602: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1603: </span>      <span class='hs-comment'>-- = 0.5 * (log (R (1+a0)) - log (R (1-a0)))</span>
<span class=hs-linenum>1604: </span>      <span class='hs-comment'>-- = 0.5*(R (log $ 1+a0) - R (log $ 1-a0))</span>
<span class=hs-linenum>1605: </span>      <span class='hs-comment'>-- = R (0.5*(log $ 1+a0) - 0.5*(log $ 1-a0))</span>
<span class=hs-linenum>1606: </span>      <span class='hs-comment'>-- = R (atanh a0)</span>
<span class=hs-linenum>1607: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>atanh</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1608: </span>      <span class='hs-comment'>-- = 0.5 * (log (R (1+a0)) - log (R (1-a0)))</span>
<span class=hs-linenum>1609: </span>      <span class='hs-comment'>-- = (C ((0.5*).log.negate $ 1+a0) (pi/2)) - (R ((0.5*).log $ 1-a0))</span>
<span class=hs-linenum>1610: </span>      <span class='hs-comment'>-- = C (((0.5*).log.negate $ 1+a0) - ((0.5*).log $ 1-a0)) (pi/2)</span>
<span class=hs-linenum>1611: </span>      <span class='hs-comment'>-- = C (0.5*((log.negate $ 1+a0) - (log $ 1-a0))) (pi/2)</span>
<span class=hs-linenum>1612: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt; 0.0} -&gt; GHC.Types.Double</span><span class='hs-varid'>log</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>pi</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1613: </span>    <span class='hs-comment'>--</span>
<span class=hs-linenum>1614: </span>    <span class='hs-comment'>-- For I:</span>
<span class=hs-linenum>1615: </span>    <span class='hs-comment'>-- = 0.5 * (log (C 1 a123) - log (C 1 (-a123)))</span>
<span class=hs-linenum>1616: </span>    <span class='hs-comment'>-- = I (atan a123)</span>
<span class=hs-linenum>1617: </span>  <span class='hs-varid'>atanh</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1618: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1619: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varid'>atan</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1620: </span>    <span class='hs-comment'>-- = 0.5 * (log (C (1+a0) a123) - log (C (1-a0) (-a123)))</span>
<span class=hs-linenum>1621: </span>    <span class='hs-comment'>-- Def log ==&gt; log (C a0 a123) = C (log.sqrt $ a0^2 + a123^2) (atan2 a123 a0)</span>
<span class=hs-linenum>1622: </span>    <span class='hs-comment'>-- log (C (1+a0) a123) = C (log.sqrt $ (1+a0)^2 + a123^2) (atan2 a123 (1+a0))</span>
<span class=hs-linenum>1623: </span>    <span class='hs-comment'>-- log (C (1-a0) (-a123)) = C (log.sqrt $ (1-a0)^2 + (-a123)^2) (atan2 (-a123) (1-a0))</span>
<span class=hs-linenum>1624: </span>    <span class='hs-comment'>-- = C (((0.5*).log.sqrt $ (1+a0)^2 + a123^2) - ((0.5*).log.sqrt $ (1-a0)^2 + a123^2)) (0.5*((atan2 a123 (1+a0)) - (atan2 (-a123) (1-a0))))</span>
<span class=hs-linenum>1625: </span>    <span class='hs-comment'>-- C (((log $ (1+a0)^2 + a123^2) - (log $ (1-a0)^2 + a123^2))/4) (((atan2 a123 (1-a0)) + (atan2 a123 (1+a0)))/2)</span>
<span class=hs-linenum>1626: </span>  <span class='hs-varid'>atanh</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>log</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-comment'>-</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a></span><span class=hs-error><span class='hs-varop'>^</span></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span><span class='hs-layout'>)</span><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 4.0}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>atan2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 1.0}</span><span class='hs-num'>1</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1627: </span>  <span class='hs-comment'>--</span>
<span class=hs-linenum>1628: </span>  <span class='hs-varid'>atanh</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; (Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>spectraldcmp</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>atanh</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>atanh'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1629: </span>
<span class=hs-linenum>1630: </span>
<span class=hs-linenum>1631: </span>
<span class=hs-linenum>1632: </span><span class='hs-comment'>-- |'lsv' the littlest singular value. Useful for testing for invertability.</span>
<span class=hs-linenum>1633: </span><span class='hs-definition'>lsv</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>1634: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>abs</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- absolute value of a real number</span>
<span class=hs-linenum>1635: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- magnitude of a vector</span>
<span class=hs-linenum>1636: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- magnitude of a bivector</span>
<span class=hs-linenum>1637: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>abs</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1638: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>loDisc</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1639: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>loDisc</span> <span class='hs-varid'>a123</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1640: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1641: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- magnitude of a complex number</span>
<span class=hs-linenum>1642: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1643: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>negate</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-comment'>-- core was duplicating this computation added let to hopefully reduce the duplication</span>
<span class=hs-linenum>1644: </span>      <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span> <span class='hs-comment'>-- attempted to balance out the sum of several positives with a negitive before the next sum of positives and negitive</span>
<span class=hs-linenum>1645: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>y</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol'</span> <span class='hs-comment'>-- gaurd for numerical errors, y could be negative with large enough biparavectors</span>
<span class=hs-linenum>1646: </span>     <span class='hs-keyword'>then</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>1647: </span>     <span class='hs-keyword'>else</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>sqrt</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1648: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1649: </span><span class='hs-definition'>lsv</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1650: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>negate</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span>
<span class=hs-linenum>1651: </span>                        <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-comment'>-- core was duplicating this computation added let to hopefully reduce the duplication</span>
<span class=hs-linenum>1652: </span>      <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a0</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span> <span class='hs-comment'>-- attempted to balance out the sum of several positives with a negitive before the next sum of positives and negitive</span>
<span class=hs-linenum>1653: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>y</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol'</span> <span class='hs-comment'>-- gaurd for numerical errors, y could be negative with large enough cliffors</span>
<span class=hs-linenum>1654: </span>     <span class='hs-keyword'>then</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>1655: </span>     <span class='hs-keyword'>else</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>sqrt</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1656: </span>
<span class=hs-linenum>1657: </span>
<span class=hs-linenum>1658: </span><span class='hs-comment'>-- | 'loDisc' The Lower Discriminant for Paravectors and Triparavectors, real and imagninary portions of APS</span>
<span class=hs-linenum>1659: </span><span class='hs-definition'>loDisc</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>1660: </span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; GHC.Types.Double</span><span class='hs-definition'>loDisc</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v0</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v1</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v2</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v3</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1661: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>sumsqs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v1</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v3</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1662: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Double -&gt; {v : GHC.Types.Double | v == (-x1)}</span><span class='hs-varid'>negate</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v0</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sumsqs}</span><span class='hs-varid'>sumsqs</span></a>
<span class=hs-linenum>1663: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == sumsqs}</span><span class='hs-varid'>sumsqs</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == x}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>1664: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == y}</span><span class='hs-varid'>y</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0
                        &amp;&amp; v == tol'}</span><span class='hs-varid'>tol'</span></a> <span class='hs-comment'>-- gaurd for numerical errors, y could be negative with large enough paravectors</span>
<span class=hs-linenum>1665: </span>     <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>x1:GHC.Prim.Double# -&gt; {v : GHC.Types.Double | v == x1}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1666: </span>     <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Float.Floating GHC.Types.Double) | v == $fFloatingDouble}</span><span class='hs-varid'>sqrt</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == y}</span><span class='hs-varid'>y</span></a>
<span class=hs-linenum>1667: </span>
<span class=hs-linenum>1668: </span>
<span class=hs-linenum>1669: </span><span class='hs-comment'>-- | 'spectraldcmp' the spectral decomposition of a function to calculate analytic functions of cliffors in Cl(3,0).</span>
<span class=hs-linenum>1670: </span><span class='hs-comment'>-- This function requires the desired function's R, I, and C instances to be calculated and the function's derivative.</span>
<span class=hs-linenum>1671: </span><span class='hs-comment'>-- If multiple functions are being composed, its best to pass the composition of the funcitons</span>
<span class=hs-linenum>1672: </span><span class='hs-comment'>-- to this function and the derivative to this function.  Any function with a Taylor Series</span>
<span class=hs-linenum>1673: </span><span class='hs-comment'>-- approximation should be able to be used.  A real, imaginary, and complex version of the function to be decomposed</span>
<span class=hs-linenum>1674: </span><span class='hs-comment'>-- must be provided and spectraldcmp will handle the case for an arbitrary Cliffor.</span>
<span class=hs-linenum>1675: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum>1676: </span><span class='hs-comment'>-- It may be possible to add, in the future, a RULES pragma like:</span>
<span class=hs-linenum>1677: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1678: </span><span class='hs-comment'>-- &gt; "spectral decomposition function composition"</span>
<span class=hs-linenum>1679: </span><span class='hs-comment'>-- &gt; forall f f' g g' cliff.</span>
<span class=hs-linenum>1680: </span><span class='hs-comment'>-- &gt; spectraldcmp f f' (spectraldcmp g g' cliff) = spectraldcmp (f.g) (f'.g') cliff</span>
<span class=hs-linenum>1681: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum>1682: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum>1683: </span><span class='hs-definition'>spectraldcmp</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>1684: </span><span class='hs-definition'>spectraldcmp</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>fun'</span> <span class='hs-layout'>(</span><span class='hs-varid'>reduce</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>cliffor</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dcmp</span> <span class='hs-varid'>cliffor</span>
<span class=hs-linenum>1685: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>1686: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>r</span>
<span class=hs-linenum>1687: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>i</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>i</span>
<span class=hs-linenum>1688: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>c</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>C</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>1689: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>v</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>spectraldcmpSpecial</span> <span class='hs-varid'>toR</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>v</span> <span class='hs-comment'>-- spectprojR fun v</span>
<span class=hs-linenum>1690: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>pv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>PV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>spectraldcmpSpecial</span> <span class='hs-varid'>toR</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>pv</span> <span class='hs-comment'>-- spectprojR fun pv</span>
<span class=hs-linenum>1691: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>bv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>spectraldcmpSpecial</span> <span class='hs-varid'>toI</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>bv</span> <span class='hs-comment'>-- spectprojI fun bv</span>
<span class=hs-linenum>1692: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>tpv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>TPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>spectraldcmpSpecial</span> <span class='hs-varid'>toI</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>tpv</span> <span class='hs-comment'>-- spectprojI fun tpv</span>
<span class=hs-linenum>1693: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>h</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>H</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>spectraldcmpSpecial</span> <span class='hs-varid'>toC</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>h</span> <span class='hs-comment'>-- spectprojC fun h</span>
<span class=hs-linenum>1694: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>od</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>ODD</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>spectraldcmpSpecial</span> <span class='hs-varid'>toC</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>od</span> <span class='hs-comment'>-- spectprojC fun od</span>
<span class=hs-linenum>1695: </span>    <span class='hs-varid'>dcmp</span> <span class='hs-varid'>cliff</span>
<span class=hs-linenum>1696: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hasNilpotent</span> <span class='hs-varid'>cliff</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>jordan</span> <span class='hs-varid'>toC</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>fun'</span> <span class='hs-varid'>cliff</span>  <span class='hs-comment'>-- jordan normal form Cl3 style</span>
<span class=hs-linenum>1697: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>isColinear</span> <span class='hs-varid'>cliff</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>spectraldcmpSpecial</span> <span class='hs-varid'>toC</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>cliff</span> <span class='hs-comment'>-- spectprojC fun bpv</span>
<span class=hs-linenum>1698: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span>                               <span class='hs-comment'>-- transform it so it will be colinear</span>
<span class=hs-linenum>1699: </span>          <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBPV</span> <span class='hs-varid'>cliff</span>
<span class=hs-linenum>1700: </span>              <span class='hs-varid'>boost</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>boost2colinear</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>1701: </span>          <span class='hs-keyword'>in</span> <span class='hs-varid'>boost</span> <span class='hs-varop'>*</span> <span class='hs-varid'>spectraldcmpSpecial</span> <span class='hs-varid'>toC</span> <span class='hs-varid'>fun</span> <span class='hs-layout'>(</span><span class='hs-varid'>bar</span> <span class='hs-varid'>boost</span> <span class='hs-varop'>*</span> <span class='hs-varid'>cliff</span> <span class='hs-varop'>*</span> <span class='hs-varid'>boost</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-varid'>bar</span> <span class='hs-varid'>boost</span> <span class='hs-comment'>-- v * spectprojC fun d * v_bar</span>
<span class=hs-linenum>1702: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1703: </span>
<span class=hs-linenum>1704: </span>
<span class=hs-linenum>1705: </span><span class='hs-comment'>-- | 'jordan' does a Cl(3,0) version of the decomposition into Jordan Normal Form and Matrix Function Calculation</span>
<span class=hs-linenum>1706: </span><span class='hs-comment'>-- The intended use is for calculating functions for cliffors with vector parts simular to Nilpotent.</span>
<span class=hs-linenum>1707: </span><span class='hs-comment'>-- It is a helper function for 'spectraldcmp'.  It is fortunate because eigen decomposition doesn't</span>
<span class=hs-linenum>1708: </span><span class='hs-comment'>-- work with elements with nilpotent content, so it fills the gap.</span>
<span class=hs-linenum>1709: </span><span class='hs-definition'>jordan</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>1710: </span><span class='hs-definition'>jordan</span> <span class='hs-varid'>toSpecial</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>fun'</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1711: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>eigs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toSpecial</span> <span class='hs-varid'>cliffor</span>
<span class=hs-linenum>1712: </span>  <span class='hs-keyword'>in</span> <span class='hs-varid'>fun</span> <span class='hs-varid'>eigs</span> <span class='hs-varop'>+</span> <span class='hs-varid'>fun'</span> <span class='hs-varid'>eigs</span> <span class='hs-varop'>*</span> <span class='hs-varid'>toBPV</span> <span class='hs-varid'>cliffor</span>
<span class=hs-linenum>1713: </span>
<span class=hs-linenum>1714: </span><span class='hs-comment'>-- | 'spectraldcmpSpecial' helper function for with specialization for real, imaginary, or complex eigenvalues.</span>
<span class=hs-linenum>1715: </span><span class='hs-comment'>-- To specialize for Reals pass 'toR', to specialize for Imaginary pass 'toI', to specialize for Complex pass 'toC'</span>
<span class=hs-linenum>1716: </span><span class='hs-definition'>spectraldcmpSpecial</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>1717: </span><span class='hs-definition'>spectraldcmpSpecial</span> <span class='hs-varid'>toSpecial</span> <span class='hs-varid'>function</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1718: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>p</span><span class='hs-layout'>,</span><span class='hs-varid'>p_bar</span><span class='hs-layout'>,</span><span class='hs-varid'>eig1</span><span class='hs-layout'>,</span><span class='hs-varid'>eig2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>projEigs</span> <span class='hs-varid'>toSpecial</span> <span class='hs-varid'>cliffor</span>
<span class=hs-linenum>1719: </span>  <span class='hs-keyword'>in</span> <span class='hs-varid'>function</span> <span class='hs-varid'>eig1</span> <span class='hs-varop'>*</span> <span class='hs-varid'>p</span> <span class='hs-varop'>+</span> <span class='hs-varid'>function</span> <span class='hs-varid'>eig2</span> <span class='hs-varop'>*</span> <span class='hs-varid'>p_bar</span>
<span class=hs-linenum>1720: </span>
<span class=hs-linenum>1721: </span>
<span class=hs-linenum>1722: </span>
<span class=hs-linenum>1723: </span><span class='hs-comment'>-- | 'eigvals' calculates the eignenvalues of the cliffor.</span>
<span class=hs-linenum>1724: </span><span class='hs-comment'>-- This is useful for determining if a cliffor is the pole</span>
<span class=hs-linenum>1725: </span><span class='hs-comment'>-- of a function.</span>
<span class=hs-linenum>1726: </span><span class='hs-definition'>eigvals</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1727: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-definition'>eigvals</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>reduce</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor} -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>eigv</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor}</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1728: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>1729: </span>    <a class=annot href="#"><span class=annottext>{VV : Algebra.Geometric.Cl3.Cl3 | VV == cliffor
                                  &amp;&amp; VV &gt;= cliffor
                                  &amp;&amp; VV &lt;= cliffor} -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>eigv</span></a> <a class=annot href="#"><span class=annottext>{VV : Algebra.Geometric.Cl3.Cl3 | VV == cliffor
                                  &amp;&amp; VV &gt;= cliffor
                                  &amp;&amp; VV &lt;= cliffor}</span><span class='hs-varid'>r</span></a><span class='hs-keyglyph'>@</span><span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3) | x_Tuple22 v == x1
                                                                                              &amp;&amp; x_Tuple21 v == x1
                                                                                              &amp;&amp; snd v == x1
                                                                                              &amp;&amp; fst v == x1}</span><span class='hs-varid'>dup</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>r</span></a>
<span class=hs-linenum>1730: </span>    <span class='hs-varid'>eigv</span> <span class='hs-varid'>i</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3) | x_Tuple22 v == x1
                                                                                              &amp;&amp; x_Tuple21 v == x1
                                                                                              &amp;&amp; snd v == x1
                                                                                              &amp;&amp; fst v == x1}</span><span class='hs-varid'>dup</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>1731: </span>    <span class='hs-varid'>eigv</span> <span class='hs-varid'>c</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>C</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3) | x_Tuple22 v == x1
                                                                                              &amp;&amp; x_Tuple21 v == x1
                                                                                              &amp;&amp; snd v == x1
                                                                                              &amp;&amp; fst v == x1}</span><span class='hs-varid'>dup</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>c</span></a>
<span class=hs-linenum>1732: </span>    <span class='hs-varid'>eigv</span> <span class='hs-varid'>v</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>eigvalsSpecial</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toR</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>v</span></a> <span class='hs-comment'>-- eigvalsR v</span>
<span class=hs-linenum>1733: </span>    <span class='hs-varid'>eigv</span> <span class='hs-varid'>pv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>PV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>eigvalsSpecial</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toR</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>pv</span></a> <span class='hs-comment'>-- eigvalsR pv</span>
<span class=hs-linenum>1734: </span>    <span class='hs-varid'>eigv</span> <span class='hs-varid'>bv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>eigvalsSpecial</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toI</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>bv</span></a> <span class='hs-comment'>-- eigvalsI bv</span>
<span class=hs-linenum>1735: </span>    <span class='hs-varid'>eigv</span> <span class='hs-varid'>tpv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>TPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>eigvalsSpecial</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toI</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>tpv</span></a> <span class='hs-comment'>-- eigvalsI tpv</span>
<span class=hs-linenum>1736: </span>    <span class='hs-varid'>eigv</span> <span class='hs-varid'>h</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>H</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>eigvalsSpecial</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toC</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>h</span></a> <span class='hs-comment'>-- eigvalsC h</span>
<span class=hs-linenum>1737: </span>    <span class='hs-varid'>eigv</span> <span class='hs-varid'>od</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>ODD</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>eigvalsSpecial</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toC</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>od</span></a> <span class='hs-comment'>-- eigvalsC od</span>
<span class=hs-linenum>1738: </span>    <span class='hs-varid'>eigv</span> <span class='hs-varid'>cliff</span>
<span class=hs-linenum>1739: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>hasNilpotent</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>cliff</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3) | x_Tuple22 v == x1
                                                                                              &amp;&amp; x_Tuple21 v == x1
                                                                                              &amp;&amp; snd v == x1
                                                                                              &amp;&amp; fst v == x1}</span><span class='hs-varid'>dup</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>reduce</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toC</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>cliff</span></a>  <span class='hs-comment'>-- this case is actually nilpotent</span>
<span class=hs-linenum>1740: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>isColinear</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>cliff</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>eigvalsSpecial</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toC</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>cliff</span></a>  <span class='hs-comment'>-- eigvalsC bpv</span>
<span class=hs-linenum>1741: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span>                           <span class='hs-comment'>-- transform it so it will be colinear</span>
<span class=hs-linenum>1742: </span>          <span class=hs-error><span class='hs-keyword'>let</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-layout'>(</span></span><span class=hs-error><span class='hs-conid'>BPV</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>a1</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>a2</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>a3</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>a23</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>a31</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>a12</span></span><span class=hs-error><span class='hs-layout'>)</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-keyglyph'>=</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toBPV</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>cliff</span></a></span><span class=hs-error>
</span><span class=hs-linenum>1743: </span>              <span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>boost</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-keyglyph'>=</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>boost2colinear</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a></span><span class=hs-error>
</span><span class=hs-linenum>1744: </span>          <span class=hs-error><span class='hs-keyword'>in</span></span><span class=hs-error> </span><span class=hs-error><span class='hs-varid'>eigvalsSpecial</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toC</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>bar</span></a></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == boost}</span><span class='hs-varid'>boost</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>*</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor
                                 &amp;&amp; v &gt;= cliffor
                                 &amp;&amp; v &lt;= cliffor
                                 &amp;&amp; v == r}</span><span class='hs-varid'>cliff</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>*</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == boost}</span><span class='hs-varid'>boost</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span> <span class='hs-comment'>-- eigvalsC d</span>
<span class=hs-linenum>1745: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1746: </span>
<span class=hs-linenum>1747: </span>
<span class=hs-linenum>1748: </span><span class='hs-definition'>dup</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1749: </span><a class=annot href="#"><span class=annottext>cliff:Algebra.Geometric.Cl3.Cl3 -&gt; {v : (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3) | x_Tuple22 v == cliff
                                                                                                 &amp;&amp; x_Tuple21 v == cliff
                                                                                                 &amp;&amp; snd v == cliff
                                                                                                 &amp;&amp; fst v == cliff}</span><span class='hs-definition'>dup</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliff</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliff}</span><span class='hs-varid'>cliff</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliff}</span><span class='hs-varid'>cliff</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1750: </span>
<span class=hs-linenum>1751: </span><span class='hs-comment'>-- | 'eigvalsSpecial' helper function to calculate Eigenvalues</span>
<span class=hs-linenum>1752: </span><span class='hs-definition'>eigvalsSpecial</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1753: </span><a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3) -&gt; Algebra.Geometric.Cl3.Cl3 -&gt; (Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-definition'>eigvalsSpecial</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toSpecial</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cliffor</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1754: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>eig1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>eig2</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3, Algebra.Geometric.Cl3.Cl3)</span><span class='hs-varid'>projEigs</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>toSpecial</span></a> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == cliffor}</span><span class='hs-varid'>cliffor</span></a>
<span class=hs-linenum>1755: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == eig1}</span><span class='hs-varid'>eig1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == eig2}</span><span class='hs-varid'>eig2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1756: </span>
<span class=hs-linenum>1757: </span>
<span class=hs-linenum>1758: </span><span class='hs-comment'>-- | 'project' makes a projector based off of the vector content of the Cliffor.</span>
<span class=hs-linenum>1759: </span><span class='hs-definition'>project</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>  <span class='hs-comment'>-- PV&lt;:Cl3</span>
<span class=hs-linenum>1760: </span><span class='hs-definition'>project</span> <span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-num'>0.5</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0.5</span>   <span class='hs-comment'>-- default to e3 direction</span>
<span class=hs-linenum>1761: </span><span class='hs-definition'>project</span> <span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-num'>0.5</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0.5</span>   <span class='hs-comment'>-- default to e3 direction</span>
<span class=hs-linenum>1762: </span><span class='hs-definition'>project</span> <span class='hs-conid'>C</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-num'>0.5</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0.5</span>   <span class='hs-comment'>-- default to e3 direction</span>
<span class=hs-linenum>1763: </span><span class='hs-definition'>project</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>triDProj</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>   <span class='hs-comment'>-- proj v@V3{} = 0.5 + 0.5*signum v</span>
<span class=hs-linenum>1764: </span><span class='hs-definition'>project</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>triDProj</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>   <span class='hs-comment'>-- proj pv@PV{} = 0.5 + 0.5*(signum.toV3 $ pv)</span>
<span class=hs-linenum>1765: </span><span class='hs-definition'>project</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>triDProj</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>   <span class='hs-comment'>-- od@ODD{} = 0.5 + 0.5*(signum.toV3 $ od)</span>
<span class=hs-linenum>1766: </span><span class='hs-definition'>project</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>triDProj</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>   <span class='hs-comment'>-- bv@BV{} = 0.5 + 0.5*(mIx.signum $ bv)</span>
<span class=hs-linenum>1767: </span><span class='hs-definition'>project</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>triDProj</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>   <span class='hs-comment'>-- h@H{} = 0.5 + 0.5*(mIx.signum.toBV $ h)</span>
<span class=hs-linenum>1768: </span><span class='hs-definition'>project</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>triDProj</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>   <span class='hs-comment'>-- tpv@TPV{} = 0.5 + 0.5*(mIx.signum.toBV $ tpv)</span>
<span class=hs-linenum>1769: </span><span class='hs-definition'>project</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>biTriDProj</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>1770: </span><span class='hs-definition'>project</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>biTriDProj</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>1771: </span>
<span class=hs-linenum>1772: </span>
<span class=hs-linenum>1773: </span>
<span class=hs-linenum>1774: </span><span class='hs-comment'>-- If Dot product is negative or zero we have a problem, if it is zero</span>
<span class=hs-linenum>1775: </span><span class='hs-comment'>-- it either the vector or bivector par is zero or they are orthognal</span>
<span class=hs-linenum>1776: </span><span class='hs-comment'>-- if the dot product is negative the vectors could be antiparallel</span>
<span class=hs-linenum>1777: </span><span class='hs-definition'>biTriDProj</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>  <span class='hs-comment'>-- PV&lt;:Cl3</span>
<span class=hs-linenum>1778: </span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>biTriDProj</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1779: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>v3Mag</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1780: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v &lt;=&gt; v3Mag &lt; tol'}</span><span class='hs-varid'>v3MagltTol</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == v3Mag}</span><span class='hs-varid'>v3Mag</span></a> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0
                        &amp;&amp; v == tol'}</span><span class='hs-varid'>tol'</span></a>
<span class=hs-linenum>1781: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>halfInvV3Mag</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>recip</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == v3Mag}</span><span class='hs-varid'>v3Mag</span></a> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1782: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>bvMag</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1783: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v &lt;=&gt; bvMag &lt; tol'}</span><span class='hs-varid'>bvMagltTol</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == bvMag}</span><span class='hs-varid'>bvMag</span></a> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0
                        &amp;&amp; v == tol'}</span><span class='hs-varid'>tol'</span></a>
<span class=hs-linenum>1784: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>halfInvBVMag</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>recip</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == bvMag}</span><span class='hs-varid'>bvMag</span></a> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1785: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>dotPos</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1 * a23}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2 * a31}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3 * a12}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1786: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1 + a23}</span><span class='hs-varid'>b1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a>
<span class=hs-linenum>1787: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2 + a31}</span><span class='hs-varid'>b2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a>
<span class=hs-linenum>1788: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3 + a12}</span><span class='hs-varid'>b3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a>
<span class=hs-linenum>1789: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>bHalfInvMag</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1 + a23
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2 + a31
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3 + a12
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1790: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1 - a23}</span><span class='hs-varid'>c1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a>
<span class=hs-linenum>1791: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2 - a31}</span><span class='hs-varid'>c2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a>
<span class=hs-linenum>1792: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3 - a12}</span><span class='hs-varid'>c3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a>
<span class=hs-linenum>1793: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>cHalfInvMag</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1 - a23
                        &amp;&amp; v == c1}</span><span class='hs-varid'>c1</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2 - a31
                        &amp;&amp; v == c2}</span><span class='hs-varid'>c2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3 - a12
                        &amp;&amp; v == c3}</span><span class='hs-varid'>c3</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1794: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | (v &lt;=&gt; v3Mag &lt; tol')
                      &amp;&amp; v == v3MagltTol}</span><span class='hs-varid'>v3MagltTol</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | (v &lt;=&gt; bvMag &lt; tol')
                      &amp;&amp; v == bvMagltTol}</span><span class='hs-varid'>bvMagltTol</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a>
<span class=hs-linenum>1795: </span>        <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | (v &lt;=&gt; bvMag &lt; tol')
                      &amp;&amp; v == bvMagltTol}</span><span class='hs-varid'>bvMagltTol</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvV3Mag * a1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvV3Mag}</span><span class='hs-varid'>halfInvV3Mag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvV3Mag * a2}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvV3Mag}</span><span class='hs-varid'>halfInvV3Mag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvV3Mag * a3}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvV3Mag}</span><span class='hs-varid'>halfInvV3Mag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1796: </span>        <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | (v &lt;=&gt; v3Mag &lt; tol')
                      &amp;&amp; v == v3MagltTol}</span><span class='hs-varid'>v3MagltTol</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvBVMag * a23}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvBVMag}</span><span class='hs-varid'>halfInvBVMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvBVMag * a31}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvBVMag}</span><span class='hs-varid'>halfInvBVMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvBVMag * a12}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvBVMag}</span><span class='hs-varid'>halfInvBVMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1797: </span>        <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == dotPos}</span><span class='hs-varid'>dotPos</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == bHalfInvMag * b1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == bHalfInvMag}</span><span class='hs-varid'>bHalfInvMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1 + a23
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == bHalfInvMag * b2}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == bHalfInvMag}</span><span class='hs-varid'>bHalfInvMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2 + a31
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == bHalfInvMag * b3}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == bHalfInvMag}</span><span class='hs-varid'>bHalfInvMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3 + a12
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1798: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cHalfInvMag * c1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cHalfInvMag}</span><span class='hs-varid'>cHalfInvMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1 - a23
                        &amp;&amp; v == c1}</span><span class='hs-varid'>c1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cHalfInvMag * c2}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cHalfInvMag}</span><span class='hs-varid'>cHalfInvMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2 - a31
                        &amp;&amp; v == c2}</span><span class='hs-varid'>c2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cHalfInvMag * c3}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == cHalfInvMag}</span><span class='hs-varid'>cHalfInvMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3 - a12
                        &amp;&amp; v == c3}</span><span class='hs-varid'>c3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1799: </span>
<span class=hs-linenum>1800: </span>
<span class=hs-linenum>1801: </span><span class='hs-comment'>-- | 'triDProj' a single 3 dimensional vector grade to a projector</span>
<span class=hs-linenum>1802: </span><span class='hs-definition'>triDProj</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>  <span class='hs-comment'>-- PV&lt;:Cl3</span>
<span class=hs-linenum>1803: </span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>triDProj</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v1</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v2</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>v3</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1804: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>mag</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v1</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v3</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1805: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>halfInvMag</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>recip</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == mag}</span><span class='hs-varid'>mag</span></a> <span class='hs-varop'>/</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 2.0}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1806: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == mag}</span><span class='hs-varid'>mag</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>1807: </span>     <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a>
<span class=hs-linenum>1808: </span>     <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.5}</span><span class='hs-num'>0.5</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvMag * v1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvMag}</span><span class='hs-varid'>halfInvMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvMag * v2}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvMag}</span><span class='hs-varid'>halfInvMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvMag * v3}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == halfInvMag}</span><span class='hs-varid'>halfInvMag</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>v3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1809: </span>
<span class=hs-linenum>1810: </span>
<span class=hs-linenum>1811: </span><span class='hs-comment'>-- | 'boost2colinear' calculates a boost that is perpendicular to both the vector and bivector</span>
<span class=hs-linenum>1812: </span><span class='hs-comment'>-- components of the cliffor, that will mix the vector and bivector parts such that the vector and bivector</span>
<span class=hs-linenum>1813: </span><span class='hs-comment'>-- parts become colinear. This function is a simularity transform such that:</span>
<span class=hs-linenum>1814: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1815: </span><span class='hs-comment'>-- &gt; cliffor = boost * colinear * bar boost</span>
<span class=hs-linenum>1816: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1817: </span><span class='hs-comment'>-- and returns the boost given the inputs.  First the boost must be calculated</span>
<span class=hs-linenum>1818: </span><span class='hs-comment'>-- and then</span>
<span class=hs-linenum>1819: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1820: </span><span class='hs-comment'>-- &gt; colinear = bar boost * cliffor * boost</span>
<span class=hs-linenum>1821: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1822: </span><span class='hs-comment'>-- and colinear will have colinear vector and bivector parts of the cliffor.</span>
<span class=hs-linenum>1823: </span><span class='hs-comment'>-- This is somewhat simular to finding the drift frame for a static electromagnetic field.</span>
<span class=hs-linenum>1824: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1825: </span><span class='hs-comment'>-- &gt; v = toV3 cliffor  -- extract the vector</span>
<span class=hs-linenum>1826: </span><span class='hs-comment'>-- &gt; bv = mIx.toBV $ cliffor  -- extract the bivector and turn it into a vector</span>
<span class=hs-linenum>1827: </span><span class='hs-comment'>-- &gt; invariant = ((2*).mIx.toBV $ v * bv) / (toR (v^2) + toR (bv^2))</span>
<span class=hs-linenum>1828: </span><span class='hs-comment'>-- &gt; boost = spectraldcmpSpecial toR (exp.(/4).atanh) invariant</span>
<span class=hs-linenum>1829: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>1830: </span><span class='hs-definition'>boost2colinear</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>  <span class='hs-comment'>-- PV&lt;:Cl3</span>
<span class=hs-linenum>1831: </span><span class='hs-definition'>boost2colinear</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1832: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>scale</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>1833: </span>      <span class='hs-varid'>b1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1834: </span>      <span class='hs-varid'>b2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1835: </span>      <span class='hs-varid'>b3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1836: </span>      <span class='hs-varid'>eig1</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-num'>2</span><span class='hs-varop'>*</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>b1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>b3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>1837: </span>      <span class='hs-varid'>eig2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>negate</span> <span class='hs-varid'>eig1</span>
<span class=hs-linenum>1838: </span>      <span class='hs-varid'>transEig1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exp</span><span class='hs-varop'>.</span><span class='hs-layout'>(</span><span class='hs-varop'>/</span><span class='hs-num'>4</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><span class='hs-varid'>atanh</span> <span class='hs-varop'>$</span> <span class='hs-varid'>eig1</span>
<span class=hs-linenum>1839: </span>      <span class='hs-varid'>transEig2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exp</span><span class='hs-varop'>.</span><span class='hs-layout'>(</span><span class='hs-varop'>/</span><span class='hs-num'>4</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><span class='hs-varid'>atanh</span> <span class='hs-varop'>$</span> <span class='hs-varid'>eig2</span>
<span class=hs-linenum>1840: </span>      <span class='hs-varid'>sumTransEigs</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>transEig1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>transEig2</span><span class='hs-layout'>)</span> <span class='hs-varop'>*</span> <span class='hs-varid'>recip</span> <span class='hs-varid'>eig1</span>
<span class=hs-linenum>1841: </span>  <span class='hs-keyword'>in</span> <span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-num'>0.5</span> <span class='hs-varop'>*</span> <span class='hs-layout'>(</span><span class='hs-varid'>transEig1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>transEig2</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>sumTransEigs</span> <span class='hs-varop'>*</span> <span class='hs-varid'>b1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>sumTransEigs</span> <span class='hs-varop'>*</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>sumTransEigs</span> <span class='hs-varop'>*</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1842: </span>
<span class=hs-linenum>1843: </span>
<span class=hs-linenum>1844: </span><span class='hs-comment'>-- | 'isColinear' takes a Cliffor and determines if either the vector part or the bivector part are</span>
<span class=hs-linenum>1845: </span><span class='hs-comment'>-- zero or both aligned in the same direction.</span>
<span class=hs-linenum>1846: </span><span class='hs-definition'>isColinear</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>1847: </span><span class='hs-definition'>isColinear</span> <span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>1848: </span><span class='hs-definition'>isColinear</span> <span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>1849: </span><span class='hs-definition'>isColinear</span> <span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>1850: </span><span class='hs-definition'>isColinear</span> <span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>1851: </span><span class='hs-definition'>isColinear</span> <span class='hs-conid'>PV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>1852: </span><span class='hs-definition'>isColinear</span> <span class='hs-conid'>H</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>1853: </span><span class='hs-definition'>isColinear</span> <span class='hs-conid'>C</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>1854: </span><span class='hs-definition'>isColinear</span> <span class='hs-conid'>ODD</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>1855: </span><span class='hs-definition'>isColinear</span> <span class='hs-conid'>TPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<span class=hs-linenum>1856: </span><span class='hs-definition'>isColinear</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>colinearHelper</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>1857: </span><span class='hs-definition'>isColinear</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>colinearHelper</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>1858: </span>
<span class=hs-linenum>1859: </span><span class='hs-definition'>colinearHelper</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>1860: </span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; GHC.Types.Bool</span><span class='hs-definition'>colinearHelper</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1861: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>magV3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1862: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>recip</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magV3}</span><span class='hs-varid'>magV3</span></a>
<span class=hs-linenum>1863: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>magBV</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1864: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>recip</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magBV}</span><span class='hs-varid'>magBV</span></a>
<span class=hs-linenum>1865: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>crss</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3}</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV}</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3}</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a><span class='hs-layout'>)</span><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV}</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span>
<span class=hs-linenum>1866: </span>                   <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3}</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a><span class='hs-layout'>)</span><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV}</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3}</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a><span class='hs-layout'>)</span><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV}</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span>
<span class=hs-linenum>1867: </span>                   <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3}</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a><span class='hs-layout'>)</span><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV}</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3}</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV}</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1868: </span>  <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magV3}</span><span class='hs-varid'>magV3</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-varop'>||</span>     <span class='hs-comment'>-- Zero Vector</span>
<span class=hs-linenum>1869: </span>     <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magBV}</span><span class='hs-varid'>magBV</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-varop'>||</span>     <span class='hs-comment'>-- Zero Bivector</span>
<span class=hs-linenum>1870: </span>     <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0
                        &amp;&amp; v == crss}</span><span class='hs-varid'>crss</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0
                        &amp;&amp; v == tol'}</span><span class='hs-varid'>tol'</span></a>      <span class='hs-comment'>-- Orthoganl part is zero-ish</span>
<span class=hs-linenum>1871: </span>
<span class=hs-linenum>1872: </span>
<span class=hs-linenum>1873: </span><span class='hs-comment'>-- | 'hasNilpotent' takes a Cliffor and determines if the vector part and the bivector part are</span>
<span class=hs-linenum>1874: </span><span class='hs-comment'>-- orthoganl and equal in magnitude, i.e. that it is simular to a nilpotent BPV.</span>
<span class=hs-linenum>1875: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>1876: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>1877: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>1878: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>1879: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>1880: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-conid'>PV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>1881: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-conid'>H</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>1882: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-conid'>C</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>1883: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-conid'>ODD</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>1884: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-conid'>TPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<span class=hs-linenum>1885: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nilpotentHelper</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>1886: </span><span class='hs-definition'>hasNilpotent</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>nilpotentHelper</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>1887: </span>
<span class=hs-linenum>1888: </span><span class='hs-definition'>nilpotentHelper</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>1889: </span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; {VV : GHC.Types.Double | false} -&gt; GHC.Types.Bool</span><span class='hs-definition'>nilpotentHelper</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1890: </span>  <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>magV3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1891: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>recip</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magV3}</span><span class='hs-varid'>magV3</span></a>
<span class=hs-linenum>1892: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>magBV</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0} -&gt; {v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a>
<span class=hs-linenum>1893: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>recip</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magV3}</span><span class='hs-varid'>magV3</span></a>
<span class=hs-linenum>1894: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>magDiff</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>abs</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magV3 - magBV}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magV3}</span><span class='hs-varid'>magV3</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magBV}</span><span class='hs-varid'>magBV</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1895: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1}</span><span class='hs-varid'>b1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3}</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a1</span></a>
<span class=hs-linenum>1896: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2}</span><span class='hs-varid'>b2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3}</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a2</span></a>
<span class=hs-linenum>1897: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3}</span><span class='hs-varid'>b3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3}</span><span class='hs-varid'>invMagV3</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a3</span></a>
<span class=hs-linenum>1898: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23}</span><span class='hs-varid'>b23</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV}</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a23</span></a>
<span class=hs-linenum>1899: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31}</span><span class='hs-varid'>b31</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV}</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a31</span></a>
<span class=hs-linenum>1900: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12}</span><span class='hs-varid'>b12</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV}</span><span class='hs-varid'>invMagBV</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | false}</span><span class='hs-varid'>a12</span></a>
<span class=hs-linenum>1901: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>c0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a>
<span class=hs-linenum>1902: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>c1</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a>
<span class=hs-linenum>1903: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>c2</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a>
<span class=hs-linenum>1904: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>c3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a>
<span class=hs-linenum>1905: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>c23</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a>
<span class=hs-linenum>1906: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>c31</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a>
<span class=hs-linenum>1907: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>c12</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a>
<span class=hs-linenum>1908: </span>      <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-varid'>c123</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a23
                        &amp;&amp; v == b23}</span><span class='hs-varid'>b23</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a1
                        &amp;&amp; v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a31
                        &amp;&amp; v == b31}</span><span class='hs-varid'>b31</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a2
                        &amp;&amp; v == b2}</span><span class='hs-varid'>b2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagBV * a12
                        &amp;&amp; v == b12}</span><span class='hs-varid'>b12</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == invMagV3 * a3
                        &amp;&amp; v == b3}</span><span class='hs-varid'>b3</span></a>
<span class=hs-linenum>1909: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c0}</span><span class='hs-varid'>c0</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c1}</span><span class='hs-varid'>c1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c123}</span><span class='hs-varid'>c123</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c23}</span><span class='hs-varid'>c23</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c0}</span><span class='hs-varid'>c0</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c2}</span><span class='hs-varid'>c2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c123}</span><span class='hs-varid'>c123</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c31}</span><span class='hs-varid'>c31</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c0}</span><span class='hs-varid'>c0</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c3}</span><span class='hs-varid'>c3</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c123}</span><span class='hs-varid'>c123</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c12}</span><span class='hs-varid'>c12</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span>
<span class=hs-linenum>1910: </span>                <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c2}</span><span class='hs-varid'>c2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c12}</span><span class='hs-varid'>c12</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c3}</span><span class='hs-varid'>c3</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c31}</span><span class='hs-varid'>c31</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c3}</span><span class='hs-varid'>c3</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c23}</span><span class='hs-varid'>c23</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c1}</span><span class='hs-varid'>c1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c12}</span><span class='hs-varid'>c12</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c1}</span><span class='hs-varid'>c1</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c31}</span><span class='hs-varid'>c31</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c2}</span><span class='hs-varid'>c2</span></a><span class='hs-varop'>*</span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c23}</span><span class='hs-varid'>c23</span></a><span class='hs-layout'>)</span><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1911: </span>      <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqMag</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Double</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c0}</span><span class='hs-varid'>c0</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c1}</span><span class='hs-varid'>c1</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c2}</span><span class='hs-varid'>c2</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c3}</span><span class='hs-varid'>c3</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c23}</span><span class='hs-varid'>c23</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c31}</span><span class='hs-varid'>c31</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c12}</span><span class='hs-varid'>c12</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == c123}</span><span class='hs-varid'>c123</span></a><span class='hs-varop'>^</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0
                        &amp;&amp; v == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1912: </span>  <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magV3}</span><span class='hs-varid'>magV3</span></a> <span class='hs-varop'>/=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-varop'>&amp;&amp;</span>          <span class='hs-comment'>-- Non-Zero Vector Part</span>
<span class=hs-linenum>1913: </span>     <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magBV}</span><span class='hs-varid'>magBV</span></a> <span class='hs-varop'>/=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <span class='hs-varop'>&amp;&amp;</span>          <span class='hs-comment'>-- Non-Zero Bivector Part</span>
<span class=hs-linenum>1914: </span>     <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == magDiff}</span><span class='hs-varid'>magDiff</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0
                        &amp;&amp; v == tol'}</span><span class='hs-varid'>tol'</span></a> <span class='hs-varop'>&amp;&amp;</span>     <span class='hs-comment'>-- Vector and Bivector are Equal Magnitude</span>
<span class=hs-linenum>1915: </span>     <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v &gt;= 0.0
                        &amp;&amp; v == sqMag}</span><span class='hs-varid'>sqMag</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0
                        &amp;&amp; v == tol'}</span><span class='hs-varid'>tol'</span></a>          <span class='hs-comment'>-- It's non-zero but squares to zero</span>
<span class=hs-linenum>1916: </span>
<span class=hs-linenum>1917: </span>
<span class=hs-linenum>1918: </span><span class='hs-comment'>-- | 'projEigs' function returns complementary projectors and eigenvalues for a Cliffor with specialization.</span>
<span class=hs-linenum>1919: </span><span class='hs-comment'>-- The Cliffor at this point is allready colinear and the Eigenvalue is known to be real, imaginary, or complex.</span>
<span class=hs-linenum>1920: </span><span class='hs-definition'>projEigs</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1921: </span><span class='hs-definition'>projEigs</span> <span class='hs-varid'>toSpecial</span> <span class='hs-varid'>cliffor</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>1922: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>project</span> <span class='hs-varid'>cliffor</span>
<span class=hs-linenum>1923: </span>      <span class='hs-varid'>p_bar</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bar</span> <span class='hs-varid'>p</span>
<span class=hs-linenum>1924: </span>      <span class='hs-varid'>eig1</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>2</span> <span class='hs-varop'>*</span> <span class='hs-varid'>toSpecial</span> <span class='hs-layout'>(</span><span class='hs-varid'>p</span> <span class='hs-varop'>*</span> <span class='hs-varid'>cliffor</span> <span class='hs-varop'>*</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1925: </span>      <span class='hs-varid'>eig2</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>2</span> <span class='hs-varop'>*</span> <span class='hs-varid'>toSpecial</span> <span class='hs-layout'>(</span><span class='hs-varid'>p_bar</span> <span class='hs-varop'>*</span> <span class='hs-varid'>cliffor</span> <span class='hs-varop'>*</span> <span class='hs-varid'>p_bar</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1926: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-varid'>p</span><span class='hs-layout'>,</span><span class='hs-varid'>p_bar</span><span class='hs-layout'>,</span><span class='hs-varid'>eig1</span><span class='hs-layout'>,</span><span class='hs-varid'>eig2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1927: </span>
<span class=hs-linenum>1928: </span><span class='hs-comment'>-- | 'reduce' function reduces the number of grades in a specialized Cliffor if they</span>
<span class=hs-linenum>1929: </span><span class='hs-comment'>-- are zero-ish</span>
<span class=hs-linenum>1930: </span><span class='hs-definition'>reduce</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>1931: </span><span class='hs-definition'>reduce</span> <span class='hs-varid'>cliff</span>
<span class=hs-linenum>1932: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-varid'>cliff</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>1933: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>cliff</span>
<span class=hs-linenum>1934: </span>    <span class='hs-keyword'>where</span>
<span class=hs-linenum>1935: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>r</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>r</span>
<span class=hs-linenum>1936: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>v</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>v</span>
<span class=hs-linenum>1937: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>bv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bv</span>
<span class=hs-linenum>1938: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>i</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>i</span>
<span class=hs-linenum>1939: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>pv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>PV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span>
<span class=hs-linenum>1940: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toV3</span> <span class='hs-varid'>pv</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toR</span> <span class='hs-varid'>pv</span>
<span class=hs-linenum>1941: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toR</span> <span class='hs-varid'>pv</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toV3</span> <span class='hs-varid'>pv</span>
<span class=hs-linenum>1942: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pv</span>
<span class=hs-linenum>1943: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>h</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>H</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span>
<span class=hs-linenum>1944: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBV</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toR</span> <span class='hs-varid'>h</span>
<span class=hs-linenum>1945: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toR</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBV</span> <span class='hs-varid'>h</span>
<span class=hs-linenum>1946: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>h</span>
<span class=hs-linenum>1947: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>c</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>C</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span>
<span class=hs-linenum>1948: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toI</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toR</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>1949: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toR</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toI</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>1950: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>1951: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>bpv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>BPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span>
<span class=hs-linenum>1952: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBV</span> <span class='hs-varid'>bpv</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toV3</span> <span class='hs-varid'>bpv</span>
<span class=hs-linenum>1953: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toV3</span> <span class='hs-varid'>bpv</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBV</span> <span class='hs-varid'>bpv</span>
<span class=hs-linenum>1954: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>bpv</span>
<span class=hs-linenum>1955: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>od</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>ODD</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span>
<span class=hs-linenum>1956: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toI</span> <span class='hs-varid'>od</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toV3</span> <span class='hs-varid'>od</span>
<span class=hs-linenum>1957: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toV3</span> <span class='hs-varid'>od</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toI</span> <span class='hs-varid'>od</span>
<span class=hs-linenum>1958: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>od</span>
<span class=hs-linenum>1959: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>tpv</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>TPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span>
<span class=hs-linenum>1960: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBV</span> <span class='hs-varid'>tpv</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toI</span> <span class='hs-varid'>tpv</span>
<span class=hs-linenum>1961: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toI</span> <span class='hs-varid'>tpv</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>toBV</span> <span class='hs-varid'>tpv</span>
<span class=hs-linenum>1962: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tpv</span>
<span class=hs-linenum>1963: </span>      <span class='hs-varid'>go_reduce</span> <span class='hs-varid'>aps</span><span class='hs-keyglyph'>@</span><span class='hs-conid'>APS</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span>
<span class=hs-linenum>1964: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBPV</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go_reduce</span> <span class='hs-layout'>(</span><span class='hs-varid'>toC</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1965: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toODD</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go_reduce</span> <span class='hs-layout'>(</span><span class='hs-varid'>toH</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1966: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toTPV</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go_reduce</span> <span class='hs-layout'>(</span><span class='hs-varid'>toPV</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1967: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toC</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go_reduce</span> <span class='hs-layout'>(</span><span class='hs-varid'>toBPV</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1968: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toH</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go_reduce</span> <span class='hs-layout'>(</span><span class='hs-varid'>toODD</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1969: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>abs</span> <span class='hs-layout'>(</span><span class='hs-varid'>toPV</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go_reduce</span> <span class='hs-layout'>(</span><span class='hs-varid'>toTPV</span> <span class='hs-varid'>aps</span><span class='hs-layout'>)</span>
<span class=hs-linenum>1970: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>aps</span>
<span class=hs-linenum>1971: </span>
<span class=hs-linenum>1972: </span>
<span class=hs-linenum>1973: </span><span class='hs-comment'>-- | 'mIx' a more effecient '\x -&gt; I (-1) * x' typically useful for converting a</span>
<span class=hs-linenum>1974: </span><span class='hs-comment'>-- Bivector to a Vector in the same direction. Related to Hodge Dual and/or</span>
<span class=hs-linenum>1975: </span><span class='hs-comment'>-- Inverse Hodge Star.</span>
<span class=hs-linenum>1976: </span><span class='hs-definition'>mIx</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>1977: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>mIx</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a0)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1978: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>BV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a1)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a2)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a3)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1979: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>V3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a>
<span class=hs-linenum>1980: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>1981: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>TPV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a1)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a2)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a3)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a0)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1982: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>ODD</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a0)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1983: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a0)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1984: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>BPV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a1)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a2)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a3)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1985: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>H</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a1)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a2)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a3)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1986: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a>
<span class=hs-linenum>1987: </span><span class='hs-definition'>mIx</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a1)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a2)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a3)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a0)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1988: </span>
<span class=hs-linenum>1989: </span><span class='hs-comment'>-- | 'timesI' is a more effecient '\x -&gt; I 1 * x'</span>
<span class=hs-linenum>1990: </span><span class='hs-definition'>timesI</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>1991: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>timesI</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1992: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>BV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a>
<span class=hs-linenum>1993: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>V3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1994: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>1995: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>TPV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1996: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>ODD</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1997: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>1998: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>BPV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a>
<span class=hs-linenum>1999: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>H</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a>
<span class=hs-linenum>2000: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>2001: </span><span class='hs-definition'>timesI</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>2002: </span>
<span class=hs-linenum>2003: </span><span class='hs-comment'>-- | 'abssignum' is a more effecient '\cl3 -&gt; (abs cl3, signum cl3)'</span>
<span class=hs-linenum>2004: </span><span class='hs-comment'>-- So 'abs' is always R and 'signum' is the same type of constructor as the input</span>
<span class=hs-linenum>2005: </span><span class='hs-comment'>-- 'signum' is the element divided by its largest singular value 'abs'</span>
<span class=hs-linenum>2006: </span><span class='hs-comment'>{-
abssignum :: Cl3 -&gt; (Cl3,Cl3)
abssignum (R a0) = (R (abs a0),R (signum a0))
abssignum (V3 a1 a2 a3) = let mag = sqrt $ a1^2 + a2^2 + a3^2 in ((R mag),V3 (a1/mag) (a2/mag) (a3/mag))
abssignum (BV a23 a31 a12) = let mag = sqrt $ a23^2 + a31^2 + a12^2 in ((R mag),BV (a23/mag) (a31/mag) (a12/mag))
abssignum (I a123) = (R (abs a123),I (signum a123))
abssignum (PV a0 a1 a2 a3) = let mag = reimMag a0 a1 a2 a3 in (R (mag),PV (a0/mag) (a1/mag) (a2/mag) (a3/mag))
abssignum (H a0 a23 a31 a12) = let mag = sqrt $ a0^2 + a23^2 + a31^2 + a12^2 in ((R mag),H (a0/mag) (a23/mag) (a31/mag) (a12/mag))
abssignum (C a0 a123) = let mag = sqrt $ a0^2 + a123^2 in ((R mag),C (a0/mag) (a123/mag))
abssignum (BPV a1 a2 a3 a23 a31 a12) =
  let mag0 = sqrt $ (a1*a31 - a2*a23)^2 + (a1*a12 - a3*a23)^2 + (a2*a12 - a3*a31)^2
      mag = sqrt $ a1^2 + a23^2 + a2^2 + mag0 + a31^2 + a3^2 + a12^2 + mag0 
  in (R (mag),BPV (a1/mag) (a2/mag) (a3/mag) (a23/mag) (a31/mag) (a12/mag))
abssignum (ODD a1 a2 a3 a123) = let mag = sqrt $ a1^2 + a2^2 + a3^2 + a123^2 in (R (mag),ODD (a1/mag) (a2/mag) (a3/mag) (a123/mag))
abssignum (TPV a23 a31 a12 a123) = let mag = reimMag a123 a23 a31 a12 in (R (mag),TPV (a23/mag) (a31/mag) (a12/mag) (a123/mag))
abssignum (APS a0 a1 a2 a3 a23 a31 a12 a123) =
  let mag0 = sqrt $ (a0*a1 + a123*a23)^2 + (a0*a2 + a123*a31)^2 + (a0*a3 + a123*a12)^2 + (a2*a12 - a3*a31)^2 + (a3*a23 - a1*a12)^2 + (a1*a31 - a2*a23)^2
      mag = sqrt $ a0^2 + a1^2 + a2^2 + a3^2 + mag0 + a23^2 + a31^2 + a12^2 + a123^2 + mag0
  in (R (mag), APS (a0/mag) (a1/mag) (a2/mag) (a3/mag) (a23/mag) (a31/mag) (a12/mag) (a123/mag))
-}</span>
<span class=hs-linenum>2026: </span><span class='hs-definition'>abssignum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2027: </span><span class='hs-definition'>abssignum</span> <span class='hs-varid'>cl3</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2028: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>m0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>absolute</span> <span class='hs-varid'>cl3</span>
<span class=hs-linenum>2029: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>m0</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2030: </span>     <span class='hs-keyword'>then</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- (abs 0 == 0, signum 0 == 0)</span>
<span class=hs-linenum>2031: </span>     <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>m0</span><span class='hs-layout'>,</span> <span class='hs-varid'>cl3</span><span class='hs-varop'>/</span><span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>m0</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2032: </span>
<span class=hs-linenum>2033: </span><span class='hs-definition'>absolute</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2034: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>abs</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2035: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-keyword'>in</span> <span class='hs-conid'>R</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>2036: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-keyword'>in</span> <span class='hs-conid'>R</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>2037: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-layout'>(</span><span class='hs-varid'>abs</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2038: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>reimMag</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>in</span> <span class='hs-conid'>R</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>2039: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a0</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-keyword'>in</span> <span class='hs-conid'>R</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>2040: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a0</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-keyword'>in</span> <span class='hs-conid'>R</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>2041: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>mag0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>2042: </span>                                          <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>mag0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>mag0</span> <span class='hs-keyword'>in</span> <span class='hs-conid'>R</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>2043: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-keyword'>in</span> <span class='hs-conid'>R</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>2044: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>reimMag</span> <span class='hs-varid'>a123</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>in</span> <span class='hs-conid'>R</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>2045: </span><span class='hs-definition'>absolute</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-varid'>mag0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>2046: </span>                                                  <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a0</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>mag0</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>mag0</span> <span class='hs-keyword'>in</span> <span class='hs-conid'>R</span> <span class='hs-varid'>m</span>
<span class=hs-linenum>2047: </span>
<span class=hs-linenum>2048: </span><span class='hs-cpp'>#ifdef O_LIQUID</span>
<span class=hs-linenum>2049: </span><span class='hs-definition'>tol</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2050: </span><span class='hs-definition'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2051: </span>
<span class=hs-linenum>2052: </span><span class='hs-definition'>tol'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>2053: </span><a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-definition'>tol'</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2054: </span><span class='hs-cpp'>#else</span>
<span class=hs-linenum>2055: </span><span class='hs-comment'>-- | 'tol' currently 128*eps</span>
<span class=hs-linenum>2056: </span><span class='hs-definition'>tol</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2057: </span><span class='hs-comment'>{-# INLINE tol #-}</span>
<span class=hs-linenum>2058: </span><span class='hs-definition'>tol</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-num'>1.4210854715202004e-14</span>
<span class=hs-linenum>2059: </span>
<span class=hs-linenum>2060: </span><span class='hs-definition'>tol'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span>
<span class=hs-linenum>2061: </span><span class='hs-comment'>{-# INLINE tol' #-}</span>
<span class=hs-linenum>2062: </span><span class='hs-definition'>tol'</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1.4210854715202004e-14</span>
<span class=hs-linenum>2063: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>2064: </span>
<span class=hs-linenum>2065: </span><span class='hs-comment'>-- | 'bar' is a Clifford Conjugate, the vector grades are negated</span>
<span class=hs-linenum>2066: </span><span class='hs-definition'>bar</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2067: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2068: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2069: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2070: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2071: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2072: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2073: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2074: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2075: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2076: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2077: </span><span class='hs-definition'>bar</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2078: </span>
<span class=hs-linenum>2079: </span><span class='hs-comment'>-- | 'dag' is the Complex Conjugate, the imaginary grades are negated</span>
<span class=hs-linenum>2080: </span><span class='hs-definition'>dag</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2081: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>dag</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>R</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a>
<span class=hs-linenum>2082: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>V3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a>
<span class=hs-linenum>2083: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>BV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>2084: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>I</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>2085: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>PV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a>
<span class=hs-linenum>2086: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>H</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>2087: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>C</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>2088: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>BPV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>2089: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>ODD</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>2090: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>TPV</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>2091: </span><span class='hs-definition'>dag</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a23)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a31)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a12)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == (-a123)}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>negate</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>2092: </span>
<span class=hs-linenum>2093: </span><span class='hs-comment'>----------------------------------------------------------------------------------------------------------------</span>
<span class=hs-linenum>2094: </span><span class='hs-comment'>-- the to... functions provide a lossy cast from one Cl3 constructor to another</span>
<span class=hs-linenum>2095: </span><span class='hs-comment'>---------------------------------------------------------------------------------------------------------------</span>
<span class=hs-linenum>2096: </span><span class='hs-comment'>-- | 'toR' takes any Cliffor and returns the R portion</span>
<span class=hs-linenum>2097: </span><span class='hs-definition'>toR</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2098: </span><span class='hs-definition'>toR</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2099: </span><span class='hs-definition'>toR</span> <span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2100: </span><span class='hs-definition'>toR</span> <span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2101: </span><span class='hs-definition'>toR</span> <span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2102: </span><span class='hs-definition'>toR</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2103: </span><span class='hs-definition'>toR</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2104: </span><span class='hs-definition'>toR</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2105: </span><span class='hs-definition'>toR</span> <span class='hs-conid'>BPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2106: </span><span class='hs-definition'>toR</span> <span class='hs-conid'>ODD</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2107: </span><span class='hs-definition'>toR</span> <span class='hs-conid'>TPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2108: </span><span class='hs-definition'>toR</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2109: </span>
<span class=hs-linenum>2110: </span><span class='hs-comment'>-- | 'toV3' takes any Cliffor and returns the V3 portion</span>
<span class=hs-linenum>2111: </span><span class='hs-definition'>toV3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2112: </span><span class='hs-definition'>toV3</span> <span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2113: </span><span class='hs-definition'>toV3</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2114: </span><span class='hs-definition'>toV3</span> <span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2115: </span><span class='hs-definition'>toV3</span> <span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2116: </span><span class='hs-definition'>toV3</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2117: </span><span class='hs-definition'>toV3</span> <span class='hs-conid'>H</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2118: </span><span class='hs-definition'>toV3</span> <span class='hs-conid'>C</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2119: </span><span class='hs-definition'>toV3</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2120: </span><span class='hs-definition'>toV3</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2121: </span><span class='hs-definition'>toV3</span> <span class='hs-conid'>TPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2122: </span><span class='hs-definition'>toV3</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2123: </span>
<span class=hs-linenum>2124: </span><span class='hs-comment'>-- | 'toBV' takes any Cliffor and returns the BV portion</span>
<span class=hs-linenum>2125: </span><span class='hs-definition'>toBV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2126: </span><span class='hs-definition'>toBV</span> <span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2127: </span><span class='hs-definition'>toBV</span> <span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2128: </span><span class='hs-definition'>toBV</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2129: </span><span class='hs-definition'>toBV</span> <span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2130: </span><span class='hs-definition'>toBV</span> <span class='hs-conid'>PV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2131: </span><span class='hs-definition'>toBV</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2132: </span><span class='hs-definition'>toBV</span> <span class='hs-conid'>C</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2133: </span><span class='hs-definition'>toBV</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2134: </span><span class='hs-definition'>toBV</span> <span class='hs-conid'>ODD</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2135: </span><span class='hs-definition'>toBV</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2136: </span><span class='hs-definition'>toBV</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2137: </span>
<span class=hs-linenum>2138: </span><span class='hs-comment'>-- | 'toI' takes any Cliffor and returns the I portion</span>
<span class=hs-linenum>2139: </span><span class='hs-definition'>toI</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2140: </span><span class='hs-definition'>toI</span> <span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2141: </span><span class='hs-definition'>toI</span> <span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2142: </span><span class='hs-definition'>toI</span> <span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2143: </span><span class='hs-definition'>toI</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2144: </span><span class='hs-definition'>toI</span> <span class='hs-conid'>PV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2145: </span><span class='hs-definition'>toI</span> <span class='hs-conid'>H</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2146: </span><span class='hs-definition'>toI</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2147: </span><span class='hs-definition'>toI</span> <span class='hs-conid'>BPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2148: </span><span class='hs-definition'>toI</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2149: </span><span class='hs-definition'>toI</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2150: </span><span class='hs-definition'>toI</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2151: </span>
<span class=hs-linenum>2152: </span><span class='hs-comment'>-- | 'toPV' takes any Cliffor and returns the PV poriton</span>
<span class=hs-linenum>2153: </span><span class='hs-definition'>toPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2154: </span><span class='hs-definition'>toPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2155: </span><span class='hs-definition'>toPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-num'>0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2156: </span><span class='hs-definition'>toPV</span> <span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2157: </span><span class='hs-definition'>toPV</span> <span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2158: </span><span class='hs-definition'>toPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2159: </span><span class='hs-definition'>toPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2160: </span><span class='hs-definition'>toPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2161: </span><span class='hs-definition'>toPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-num'>0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2162: </span><span class='hs-definition'>toPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2163: </span><span class='hs-definition'>toPV</span> <span class='hs-conid'>TPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2164: </span><span class='hs-definition'>toPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2165: </span>
<span class=hs-linenum>2166: </span><span class='hs-comment'>-- | 'toH' takes any Cliffor and returns the H portion</span>
<span class=hs-linenum>2167: </span><span class='hs-definition'>toH</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2168: </span><span class='hs-definition'>toH</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2169: </span><span class='hs-definition'>toH</span> <span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2170: </span><span class='hs-definition'>toH</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2171: </span><span class='hs-definition'>toH</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2172: </span><span class='hs-definition'>toH</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2173: </span><span class='hs-definition'>toH</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2174: </span><span class='hs-definition'>toH</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2175: </span><span class='hs-definition'>toH</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2176: </span><span class='hs-definition'>toH</span> <span class='hs-conid'>ODD</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2177: </span><span class='hs-definition'>toH</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2178: </span><span class='hs-definition'>toH</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2179: </span>
<span class=hs-linenum>2180: </span><span class='hs-comment'>-- | 'toC' takes any Cliffor and returns the C portion</span>
<span class=hs-linenum>2181: </span><span class='hs-definition'>toC</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2182: </span><span class='hs-definition'>toC</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2183: </span><span class='hs-definition'>toC</span> <span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2184: </span><span class='hs-definition'>toC</span> <span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2185: </span><span class='hs-definition'>toC</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2186: </span><span class='hs-definition'>toC</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2187: </span><span class='hs-definition'>toC</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2188: </span><span class='hs-definition'>toC</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2189: </span><span class='hs-definition'>toC</span> <span class='hs-conid'>BPV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2190: </span><span class='hs-definition'>toC</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2191: </span><span class='hs-definition'>toC</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2192: </span><span class='hs-definition'>toC</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2193: </span>
<span class=hs-linenum>2194: </span><span class='hs-comment'>-- | 'toBPV' takes any Cliffor and returns the BPV portion</span>
<span class=hs-linenum>2195: </span><span class='hs-definition'>toBPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2196: </span><span class='hs-definition'>toBPV</span> <span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2197: </span><span class='hs-definition'>toBPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2198: </span><span class='hs-definition'>toBPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2199: </span><span class='hs-definition'>toBPV</span> <span class='hs-conid'>I</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2200: </span><span class='hs-definition'>toBPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2201: </span><span class='hs-definition'>toBPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2202: </span><span class='hs-definition'>toBPV</span> <span class='hs-conid'>C</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2203: </span><span class='hs-definition'>toBPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2204: </span><span class='hs-definition'>toBPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2205: </span><span class='hs-definition'>toBPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2206: </span><span class='hs-definition'>toBPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2207: </span>
<span class=hs-linenum>2208: </span><span class='hs-comment'>-- | 'toODD' takes any Cliffor and returns the ODD portion</span>
<span class=hs-linenum>2209: </span><span class='hs-definition'>toODD</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2210: </span><span class='hs-definition'>toODD</span> <span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2211: </span><span class='hs-definition'>toODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2212: </span><span class='hs-definition'>toODD</span> <span class='hs-conid'>BV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2213: </span><span class='hs-definition'>toODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2214: </span><span class='hs-definition'>toODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2215: </span><span class='hs-definition'>toODD</span> <span class='hs-conid'>H</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2216: </span><span class='hs-definition'>toODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2217: </span><span class='hs-definition'>toODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2218: </span><span class='hs-definition'>toODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2219: </span><span class='hs-definition'>toODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2220: </span><span class='hs-definition'>toODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2221: </span>
<span class=hs-linenum>2222: </span><span class='hs-comment'>-- | 'toTPV' takes any Cliffor and returns the TPV portion</span>
<span class=hs-linenum>2223: </span><span class='hs-definition'>toTPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2224: </span><span class='hs-definition'>toTPV</span> <span class='hs-conid'>R</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2225: </span><span class='hs-definition'>toTPV</span> <span class='hs-conid'>V3</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2226: </span><span class='hs-definition'>toTPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2227: </span><span class='hs-definition'>toTPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2228: </span><span class='hs-definition'>toTPV</span> <span class='hs-conid'>PV</span><span class='hs-layout'>{</span><span class='hs-layout'>}</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2229: </span><span class='hs-definition'>toTPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2230: </span><span class='hs-definition'>toTPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2231: </span><span class='hs-definition'>toTPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-num'>0</span>
<span class=hs-linenum>2232: </span><span class='hs-definition'>toTPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-num'>0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2233: </span><span class='hs-definition'>toTPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2234: </span><span class='hs-definition'>toTPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2235: </span>
<span class=hs-linenum>2236: </span><span class='hs-comment'>-- | 'toAPS' takes any Cliffor and returns the APS portion</span>
<span class=hs-linenum>2237: </span><span class='hs-definition'>toAPS</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2238: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>toAPS</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>2239: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>2240: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>2241: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>2242: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>2243: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>2244: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>2245: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>2246: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>2247: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == 0.0}</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>2248: </span><span class='hs-definition'>toAPS</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; GHC.Types.Double -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-conid'>APS</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a0}</span><span class='hs-varid'>a0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a1}</span><span class='hs-varid'>a1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a2}</span><span class='hs-varid'>a2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a3}</span><span class='hs-varid'>a3</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a23}</span><span class='hs-varid'>a23</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a31}</span><span class='hs-varid'>a31</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a12}</span><span class='hs-varid'>a12</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Double | v == a123}</span><span class='hs-varid'>a123</span></a>
<span class=hs-linenum>2249: </span>
<span class=hs-linenum>2250: </span><span class='hs-comment'>-- derivatives of the functions in the Fractional Class for use in Jordan NF functon implemetnation</span>
<span class=hs-linenum>2251: </span><span class='hs-definition'>recip'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2252: </span><span class='hs-definition'>recip'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>negate</span><span class='hs-varop'>.</span><span class='hs-varid'>recip</span><span class='hs-varop'>.</span><span class='hs-layout'>(</span><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span>   <span class='hs-comment'>-- pole at 0</span>
<span class=hs-linenum>2253: </span>
<span class=hs-linenum>2254: </span><span class='hs-definition'>exp'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2255: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>exp'</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>exp</span>
<span class=hs-linenum>2256: </span>
<span class=hs-linenum>2257: </span><span class='hs-definition'>log'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2258: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>log'</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span>  <span class='hs-comment'>-- pole at 0</span>
<span class=hs-linenum>2259: </span>
<span class=hs-linenum>2260: </span><span class='hs-definition'>sqrt'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2261: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>sqrt'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-layout'>(</span></a><span class='hs-varop'>/</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0} -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span>   <span class='hs-comment'>-- pole at 0</span>
<span class=hs-linenum>2262: </span>
<span class=hs-linenum>2263: </span><span class='hs-definition'>sin'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2264: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>sin'</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cos</span>
<span class=hs-linenum>2265: </span>
<span class=hs-linenum>2266: </span><span class='hs-definition'>cos'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2267: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>cos'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v == (-x1)}</span><span class='hs-varid'>negate</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>sin</span></a>
<span class=hs-linenum>2268: </span>
<span class=hs-linenum>2269: </span><span class='hs-definition'>tan'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2270: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>tan'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v == 0 &lt;=&gt; x1 == 0}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cos</span></a>  <span class='hs-comment'>-- pole at pi/2*n for all integers</span>
<span class=hs-linenum>2271: </span>
<span class=hs-linenum>2272: </span><span class='hs-definition'>asin'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2273: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>asin'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0} -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 1}</span><span class='hs-num'>1</span></a><span class='hs-comment'>-</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v == 0 &lt;=&gt; x1 == 0}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- pole at +/-1</span>
<span class=hs-linenum>2274: </span>
<span class=hs-linenum>2275: </span><span class='hs-definition'>acos'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2276: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>acos'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v == (-x1)}</span><span class='hs-varid'>negate</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0} -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 1}</span><span class='hs-num'>1</span></a><span class='hs-comment'>-</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v == 0 &lt;=&gt; x1 == 0}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- pole at +/-1</span>
<span class=hs-linenum>2277: </span>
<span class=hs-linenum>2278: </span><span class='hs-definition'>atan'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2279: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>atan'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 1}</span><span class='hs-num'>1</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v == 0 &lt;=&gt; x1 == 0}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- pole at +/-i</span>
<span class=hs-linenum>2280: </span>
<span class=hs-linenum>2281: </span><span class='hs-definition'>sinh'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2282: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>sinh'</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cosh</span>
<span class=hs-linenum>2283: </span>
<span class=hs-linenum>2284: </span><span class='hs-definition'>cosh'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2285: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>cosh'</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sinh</span>
<span class=hs-linenum>2286: </span>
<span class=hs-linenum>2287: </span><span class='hs-definition'>tanh'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2288: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>tanh'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v == 0 &lt;=&gt; x1 == 0}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>cosh</span></a>
<span class=hs-linenum>2289: </span>
<span class=hs-linenum>2290: </span><span class='hs-definition'>asinh'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2291: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>asinh'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0} -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a></span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 1}</span><span class='hs-num'>1</span></a><span class='hs-varop'>+</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v == 0 &lt;=&gt; x1 == 0}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- pole at +/-i</span>
<span class=hs-linenum>2292: </span>
<span class=hs-linenum>2293: </span><span class='hs-definition'>acosh'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2294: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>acosh'</span></a> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>recip</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == x}</span><span class='hs-varid'>x</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-comment'>-</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v &gt;= 0.0}</span><span class='hs-varid'>sqrt</span></a> <span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-layout'>(</span></a></span><span class=hs-error><a class=annot href="#"><span class=annottext>{v : Algebra.Geometric.Cl3.Cl3 | v == x}</span><span class='hs-varid'>x</span></a></span><span class=hs-error> </span><span class=hs-error><span class='hs-varop'>+</span></span><span class=hs-error> </span><span class=hs-error><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3</span><span class='hs-num'>1</span></a></span><span class=hs-error><span class='hs-layout'>)</span></span>  <span class='hs-comment'>-- pole at +/-1</span>
<span class=hs-linenum>2295: </span>
<span class=hs-linenum>2296: </span><span class='hs-definition'>atanh'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2297: </span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-definition'>atanh'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-varid'>recip</span></a><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>Algebra.Geometric.Cl3.Cl3 -&gt; Algebra.Geometric.Cl3.Cl3</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 1}</span><span class='hs-num'>1</span></a><span class='hs-comment'>-</span><span class='hs-layout'>)</span><span class='hs-varop'>.</span><a class=annot href="#"><span class=annottext>x1:Algebra.Geometric.Cl3.Cl3 -&gt; {v : Algebra.Geometric.Cl3.Cl3 | v == 0 &lt;=&gt; x1 == 0}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- pole at +/-1</span>
<span class=hs-linenum>2298: </span>
<span class=hs-linenum>2299: </span>
<span class=hs-linenum>2300: </span><span class='hs-cpp'>#ifndef O_NO_STORABLE</span>
<span class=hs-linenum>2301: </span><span class='hs-comment'>-------------------------------------------------------------------</span>
<span class=hs-linenum>2302: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum>2303: </span><span class='hs-comment'>-- Instance of Cl3 types with the "Foreign.Storable" library.</span>
<span class=hs-linenum>2304: </span><span class='hs-comment'>--  </span>
<span class=hs-linenum>2305: </span><span class='hs-comment'>-- For use with high performance data structures like Data.Vector.Storable</span>
<span class=hs-linenum>2306: </span><span class='hs-comment'>-- or Data.Array.Storable</span>
<span class=hs-linenum>2307: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum>2308: </span><span class='hs-comment'>-------------------------------------------------------------------</span>
<span class=hs-linenum>2309: </span>
<span class=hs-linenum>2310: </span><span class='hs-comment'>-- | Cl3 instance of Storable uses the APS constructor as its standard interface.</span>
<span class=hs-linenum>2311: </span><span class='hs-comment'>-- "peek" returns a cliffor constructed with APS. "poke" converts a cliffor to APS.</span>
<span class=hs-linenum>2312: </span><span class='hs-comment'>-- For a more compact storing of constructors other than APS use the storable</span>
<span class=hs-linenum>2313: </span><span class='hs-comment'>-- subtypes Cl3_R, Cl3_V3, Cl3_BV, Cl3_I, Cl3_PV, Cl3_H, Cl3_C, Cl3_BPV,</span>
<span class=hs-linenum>2314: </span><span class='hs-comment'>-- Cl3_ODD, Cl3_TPV.</span>
<span class=hs-linenum>2315: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2316: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>8</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2317: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2318: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2319: </span>    <span class='hs-varid'>a0</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2320: </span>    <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2321: </span>    <span class='hs-varid'>a2</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2322: </span>    <span class='hs-varid'>a3</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2323: </span>    <span class='hs-varid'>a23</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>4</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2324: </span>    <span class='hs-varid'>a31</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2325: </span>    <span class='hs-varid'>a12</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>6</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2326: </span>    <span class='hs-varid'>a123</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>7</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2327: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2328: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2329: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2330: </span>  
<span class=hs-linenum>2331: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-varid'>toAPS</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2332: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2333: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span>
<span class=hs-linenum>2334: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum>2335: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2336: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>4</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span>
<span class=hs-linenum>2337: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span> <span class='hs-varid'>a31</span>
<span class=hs-linenum>2338: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>6</span><span class='hs-layout'>)</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2339: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>7</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2340: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2341: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2342: </span>  <span class='hs-varid'>poke</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-str'>"Serious Issues with poke in Cl3.Storable"</span>
<span class=hs-linenum>2343: </span>
<span class=hs-linenum>2344: </span>
<span class=hs-linenum>2345: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_R</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2346: </span>  <span class='hs-conid'>Cl3_R</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_R</span>
<span class=hs-linenum>2347: </span>
<span class=hs-linenum>2348: </span><span class='hs-definition'>toCl3_R</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_R</span>
<span class=hs-linenum>2349: </span><span class='hs-definition'>toCl3_R</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_R</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2350: </span><span class='hs-definition'>toCl3_R</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not R to Cl3_R, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2351: </span>
<span class=hs-linenum>2352: </span><span class='hs-definition'>fromCl3_R</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_R</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2353: </span><span class='hs-definition'>fromCl3_R</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2354: </span>
<span class=hs-linenum>2355: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_R</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2356: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2357: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2358: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2359: </span>    <span class='hs-varid'>a0</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-varid'>offset</span>
<span class=hs-linenum>2360: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_R</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2361: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2362: </span>        <span class='hs-varid'>offset</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2363: </span>
<span class=hs-linenum>2364: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2365: </span>    <span class='hs-varid'>poke</span> <span class='hs-varid'>offset</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2366: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2367: </span>        <span class='hs-varid'>offset</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2368: </span>
<span class=hs-linenum>2369: </span>
<span class=hs-linenum>2370: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_V3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2371: </span>  <span class='hs-conid'>Cl3_V3</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_V3</span>
<span class=hs-linenum>2372: </span>
<span class=hs-linenum>2373: </span><span class='hs-definition'>toCl3_V3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_V3</span>
<span class=hs-linenum>2374: </span><span class='hs-definition'>toCl3_V3</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2375: </span><span class='hs-definition'>toCl3_V3</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not V3 to Cl3_V3, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2376: </span>
<span class=hs-linenum>2377: </span><span class='hs-definition'>fromCl3_V3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_V3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2378: </span><span class='hs-definition'>fromCl3_V3</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2379: </span>
<span class=hs-linenum>2380: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_V3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2381: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>3</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2382: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2383: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2384: </span>    <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2385: </span>    <span class='hs-varid'>a2</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2386: </span>    <span class='hs-varid'>a3</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2387: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2388: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2389: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2390: </span>
<span class=hs-linenum>2391: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2392: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span>
<span class=hs-linenum>2393: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum>2394: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2395: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2396: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2397: </span>
<span class=hs-linenum>2398: </span>
<span class=hs-linenum>2399: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_BV</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2400: </span>  <span class='hs-conid'>Cl3_BV</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_BV</span>
<span class=hs-linenum>2401: </span>
<span class=hs-linenum>2402: </span><span class='hs-definition'>toCl3_BV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_BV</span>
<span class=hs-linenum>2403: </span><span class='hs-definition'>toCl3_BV</span> <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2404: </span><span class='hs-definition'>toCl3_BV</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not BV to Cl3_BV, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2405: </span>
<span class=hs-linenum>2406: </span><span class='hs-definition'>fromCl3_BV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_BV</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2407: </span><span class='hs-definition'>fromCl3_BV</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2408: </span>
<span class=hs-linenum>2409: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_BV</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2410: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>3</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2411: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2412: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2413: </span>    <span class='hs-varid'>a23</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2414: </span>    <span class='hs-varid'>a31</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2415: </span>    <span class='hs-varid'>a12</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2416: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2417: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2418: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2419: </span>
<span class=hs-linenum>2420: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2421: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span>
<span class=hs-linenum>2422: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a31</span>
<span class=hs-linenum>2423: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2424: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2425: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2426: </span>
<span class=hs-linenum>2427: </span>
<span class=hs-linenum>2428: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_I</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2429: </span>  <span class='hs-conid'>Cl3_I</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_I</span>
<span class=hs-linenum>2430: </span>
<span class=hs-linenum>2431: </span><span class='hs-definition'>toCl3_I</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_I</span>
<span class=hs-linenum>2432: </span><span class='hs-definition'>toCl3_I</span> <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_I</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2433: </span><span class='hs-definition'>toCl3_I</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not R to Cl3_R, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2434: </span>
<span class=hs-linenum>2435: </span><span class='hs-definition'>fromCl3_I</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_I</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2436: </span><span class='hs-definition'>fromCl3_I</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>I</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2437: </span>
<span class=hs-linenum>2438: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_I</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2439: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2440: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2441: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2442: </span>    <span class='hs-varid'>a123</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-varid'>offset</span>
<span class=hs-linenum>2443: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_I</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2444: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2445: </span>        <span class='hs-varid'>offset</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2446: </span>
<span class=hs-linenum>2447: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2448: </span>    <span class='hs-varid'>poke</span> <span class='hs-varid'>offset</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2449: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2450: </span>        <span class='hs-varid'>offset</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2451: </span>
<span class=hs-linenum>2452: </span>
<span class=hs-linenum>2453: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_PV</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2454: </span>  <span class='hs-conid'>Cl3_PV</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_PV</span>
<span class=hs-linenum>2455: </span>
<span class=hs-linenum>2456: </span><span class='hs-definition'>toCl3_PV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_PV</span>
<span class=hs-linenum>2457: </span><span class='hs-definition'>toCl3_PV</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2458: </span><span class='hs-definition'>toCl3_PV</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not PV to Cl3_PV, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2459: </span>
<span class=hs-linenum>2460: </span><span class='hs-definition'>fromCl3_PV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_PV</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2461: </span><span class='hs-definition'>fromCl3_PV</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2462: </span>
<span class=hs-linenum>2463: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_PV</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2464: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>4</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2465: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2466: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2467: </span>    <span class='hs-varid'>a0</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2468: </span>    <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2469: </span>    <span class='hs-varid'>a2</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2470: </span>    <span class='hs-varid'>a3</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>4</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2471: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2472: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2473: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2474: </span>
<span class=hs-linenum>2475: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2476: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2477: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span>
<span class=hs-linenum>2478: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum>2479: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2480: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2481: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2482: </span>
<span class=hs-linenum>2483: </span>
<span class=hs-linenum>2484: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_H</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2485: </span>  <span class='hs-conid'>Cl3_H</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_H</span>
<span class=hs-linenum>2486: </span>
<span class=hs-linenum>2487: </span><span class='hs-definition'>toCl3_H</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_H</span>
<span class=hs-linenum>2488: </span><span class='hs-definition'>toCl3_H</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2489: </span><span class='hs-definition'>toCl3_H</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not H to Cl3_H, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2490: </span>
<span class=hs-linenum>2491: </span><span class='hs-definition'>fromCl3_H</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_H</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2492: </span><span class='hs-definition'>fromCl3_H</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2493: </span>
<span class=hs-linenum>2494: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_H</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2495: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>4</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2496: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2497: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2498: </span>    <span class='hs-varid'>a0</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2499: </span>    <span class='hs-varid'>a23</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2500: </span>    <span class='hs-varid'>a31</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2501: </span>    <span class='hs-varid'>a12</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2502: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2503: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2504: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2505: </span>
<span class=hs-linenum>2506: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_H</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2507: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2508: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span>
<span class=hs-linenum>2509: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>a31</span>
<span class=hs-linenum>2510: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2511: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2512: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2513: </span>
<span class=hs-linenum>2514: </span>
<span class=hs-linenum>2515: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_C</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2516: </span>  <span class='hs-conid'>Cl3_C</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_C</span>
<span class=hs-linenum>2517: </span>
<span class=hs-linenum>2518: </span><span class='hs-definition'>toCl3_C</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_C</span>
<span class=hs-linenum>2519: </span><span class='hs-definition'>toCl3_C</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2520: </span><span class='hs-definition'>toCl3_C</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not C to Cl3_C, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2521: </span>
<span class=hs-linenum>2522: </span><span class='hs-definition'>fromCl3_C</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_C</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2523: </span><span class='hs-definition'>fromCl3_C</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2524: </span>
<span class=hs-linenum>2525: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_C</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2526: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>2</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2527: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2528: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2529: </span>    <span class='hs-varid'>a0</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2530: </span>    <span class='hs-varid'>a123</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2531: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2532: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2533: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2534: </span>
<span class=hs-linenum>2535: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2536: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2537: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2538: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2539: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2540: </span>
<span class=hs-linenum>2541: </span>
<span class=hs-linenum>2542: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_BPV</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2543: </span>  <span class='hs-conid'>Cl3_BPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_BPV</span>
<span class=hs-linenum>2544: </span>
<span class=hs-linenum>2545: </span><span class='hs-definition'>toCl3_BPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_BPV</span>
<span class=hs-linenum>2546: </span><span class='hs-definition'>toCl3_BPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2547: </span><span class='hs-definition'>toCl3_BPV</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not BPV to Cl3_BPV, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2548: </span>
<span class=hs-linenum>2549: </span><span class='hs-definition'>fromCl3_BPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_BPV</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2550: </span><span class='hs-definition'>fromCl3_BPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2551: </span>
<span class=hs-linenum>2552: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_BPV</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2553: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>6</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2554: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2555: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2556: </span>    <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2557: </span>    <span class='hs-varid'>a2</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2558: </span>    <span class='hs-varid'>a3</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2559: </span>    <span class='hs-varid'>a23</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2560: </span>    <span class='hs-varid'>a31</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>4</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2561: </span>    <span class='hs-varid'>a12</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2562: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2563: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2564: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2565: </span>
<span class=hs-linenum>2566: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2567: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span>
<span class=hs-linenum>2568: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum>2569: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2570: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span>
<span class=hs-linenum>2571: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>4</span><span class='hs-layout'>)</span> <span class='hs-varid'>a31</span>
<span class=hs-linenum>2572: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2573: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2574: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2575: </span>
<span class=hs-linenum>2576: </span>
<span class=hs-linenum>2577: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_ODD</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2578: </span>  <span class='hs-conid'>Cl3_ODD</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_ODD</span>
<span class=hs-linenum>2579: </span>
<span class=hs-linenum>2580: </span><span class='hs-definition'>toCl3_ODD</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_ODD</span>
<span class=hs-linenum>2581: </span><span class='hs-definition'>toCl3_ODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2582: </span><span class='hs-definition'>toCl3_ODD</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not ODD to Cl3_ODD, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2583: </span>
<span class=hs-linenum>2584: </span><span class='hs-definition'>fromCl3_ODD</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_ODD</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2585: </span><span class='hs-definition'>fromCl3_ODD</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2586: </span>
<span class=hs-linenum>2587: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_ODD</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2588: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>4</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2589: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2590: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2591: </span>    <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2592: </span>    <span class='hs-varid'>a2</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2593: </span>    <span class='hs-varid'>a3</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2594: </span>    <span class='hs-varid'>a123</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2595: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2596: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2597: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2598: </span>
<span class=hs-linenum>2599: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_ODD</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2600: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span>
<span class=hs-linenum>2601: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum>2602: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2603: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2604: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2605: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2606: </span>
<span class=hs-linenum>2607: </span>
<span class=hs-linenum>2608: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_TPV</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2609: </span>  <span class='hs-conid'>Cl3_TPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_TPV</span>
<span class=hs-linenum>2610: </span>
<span class=hs-linenum>2611: </span><span class='hs-definition'>toCl3_TPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_TPV</span>
<span class=hs-linenum>2612: </span><span class='hs-definition'>toCl3_TPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2613: </span><span class='hs-definition'>toCl3_TPV</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not TPV to Cl3_TPV, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2614: </span>
<span class=hs-linenum>2615: </span><span class='hs-definition'>fromCl3_TPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_TPV</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2616: </span><span class='hs-definition'>fromCl3_TPV</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2617: </span>
<span class=hs-linenum>2618: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_TPV</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2619: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>4</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2620: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2621: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2622: </span>    <span class='hs-varid'>a23</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2623: </span>    <span class='hs-varid'>a31</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2624: </span>    <span class='hs-varid'>a12</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2625: </span>    <span class='hs-varid'>a123</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2626: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2627: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2628: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2629: </span>
<span class=hs-linenum>2630: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_TPV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2631: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span>
<span class=hs-linenum>2632: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a31</span>
<span class=hs-linenum>2633: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2634: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2635: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2636: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2637: </span>
<span class=hs-linenum>2638: </span>
<span class=hs-linenum>2639: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Cl3_APS</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2640: </span>  <span class='hs-conid'>Cl3_APS</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varop'>!</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_APS</span>
<span class=hs-linenum>2641: </span>
<span class=hs-linenum>2642: </span><span class='hs-definition'>toCl3_APS</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3_APS</span>
<span class=hs-linenum>2643: </span><span class='hs-definition'>toCl3_APS</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Cl3_APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2644: </span><span class='hs-definition'>toCl3_APS</span> <span class='hs-varid'>err</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <span class='hs-varop'>$</span> <span class='hs-str'>"Please don't try and cast something that's not APS to Cl3_APS, Got: "</span> <span class='hs-varop'>++</span> <span class='hs-varid'>show</span> <span class='hs-varid'>err</span>
<span class=hs-linenum>2645: </span>
<span class=hs-linenum>2646: </span><span class='hs-definition'>fromCl3_APS</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Cl3_APS</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span>
<span class=hs-linenum>2647: </span><span class='hs-definition'>fromCl3_APS</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2648: </span>
<span class=hs-linenum>2649: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Storable</span> <span class='hs-conid'>Cl3_APS</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2650: </span>  <span class='hs-varid'>sizeOf</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>8</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2651: </span>  <span class='hs-varid'>alignment</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sizeOf</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2652: </span>  <span class='hs-varid'>peek</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2653: </span>    <span class='hs-varid'>a0</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2654: </span>    <span class='hs-varid'>a1</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2655: </span>    <span class='hs-varid'>a2</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2656: </span>    <span class='hs-varid'>a3</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2657: </span>    <span class='hs-varid'>a23</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>4</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2658: </span>    <span class='hs-varid'>a31</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2659: </span>    <span class='hs-varid'>a12</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>6</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2660: </span>    <span class='hs-varid'>a123</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>peek</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>7</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2661: </span>    <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Cl3_APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2662: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2663: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2664: </span>
<span class=hs-linenum>2665: </span>  <span class='hs-varid'>poke</span> <span class='hs-varid'>ptr</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3_APS</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>2666: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varid'>a0</span>
<span class=hs-linenum>2667: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>a1</span>
<span class=hs-linenum>2668: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <span class='hs-varid'>a2</span>
<span class=hs-linenum>2669: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span> <span class='hs-varid'>a3</span>
<span class=hs-linenum>2670: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>4</span><span class='hs-layout'>)</span> <span class='hs-varid'>a23</span>
<span class=hs-linenum>2671: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>5</span><span class='hs-layout'>)</span> <span class='hs-varid'>a31</span>
<span class=hs-linenum>2672: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>6</span><span class='hs-layout'>)</span> <span class='hs-varid'>a12</span>
<span class=hs-linenum>2673: </span>    <span class='hs-varid'>poke</span> <span class='hs-layout'>(</span><span class='hs-varid'>offset</span> <span class='hs-num'>7</span><span class='hs-layout'>)</span> <span class='hs-varid'>a123</span>
<span class=hs-linenum>2674: </span>      <span class='hs-keyword'>where</span>
<span class=hs-linenum>2675: </span>        <span class='hs-varid'>offset</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>castPtr</span> <span class='hs-varid'>ptr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Double</span><span class='hs-layout'>)</span> <span class='hs-varop'>`plusPtr`</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>*</span><span class='hs-num'>8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2676: </span>
<span class=hs-linenum>2677: </span>
<span class=hs-linenum>2678: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>2679: </span>
<span class=hs-linenum>2680: </span>
<span class=hs-linenum>2681: </span>
<span class=hs-linenum>2682: </span><span class='hs-cpp'>#ifndef O_NO_RANDOM</span>
<span class=hs-linenum>2683: </span><span class='hs-comment'>-------------------------------------------------------------------</span>
<span class=hs-linenum>2684: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum>2685: </span><span class='hs-comment'>-- Random Instance of Cl3 types with the "System.Random" library.</span>
<span class=hs-linenum>2686: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum>2687: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>2688: </span><span class='hs-comment'>-- Random helper functions will be based on the "abs x * signum x" decomposition</span>
<span class=hs-linenum>2689: </span><span class='hs-comment'>-- for the single grade elements. The "abs x" will be the random magnitude that</span>
<span class=hs-linenum>2690: </span><span class='hs-comment'>-- is by the default [0,1), and the "signum x" part will be a random direction</span>
<span class=hs-linenum>2691: </span><span class='hs-comment'>-- of a vector or the sign of a scalar. The multi-grade elements will be constructed from</span>
<span class=hs-linenum>2692: </span><span class='hs-comment'>-- a combination of the single grade generators.  Each grade will be evenly</span>
<span class=hs-linenum>2693: </span><span class='hs-comment'>-- distributed across the range.</span>
<span class=hs-linenum>2694: </span><span class='hs-comment'>-- </span>
<span class=hs-linenum>2695: </span><span class='hs-comment'>-------------------------------------------------------------------</span>
<span class=hs-linenum>2696: </span>
<span class=hs-linenum>2697: </span><span class='hs-comment'>-- | 'Random' instance for the 'System.Random' library</span>
<span class=hs-linenum>2698: </span><span class='hs-keyword'>instance</span> <span class='hs-conid'>Random</span> <span class='hs-conid'>Cl3</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>2699: </span>  <span class='hs-varid'>randomR</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2700: </span>    <span class='hs-keyword'>case</span> <span class='hs-varid'>randomR</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>minBound</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ConCl3</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>fromEnum</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxBound</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ConCl3</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>2701: </span>      <span class='hs-layout'>(</span><span class='hs-varid'>r</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>toEnum</span> <span class='hs-varid'>r</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>2702: </span>        <span class='hs-conid'>ConR</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2703: </span>        <span class='hs-conid'>ConV3</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeV3</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2704: </span>        <span class='hs-conid'>ConBV</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeBV</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2705: </span>        <span class='hs-conid'>ConI</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeI</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2706: </span>        <span class='hs-conid'>ConPV</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangePV</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2707: </span>        <span class='hs-conid'>ConH</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeH</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2708: </span>        <span class='hs-conid'>ConC</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeC</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2709: </span>        <span class='hs-conid'>ConBPV</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeBPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2710: </span>        <span class='hs-conid'>ConODD</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2711: </span>        <span class='hs-conid'>ConTPV</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeTPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2712: </span>        <span class='hs-conid'>ConAPS</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeAPS</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2713: </span>        <span class='hs-conid'>ConProj</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeProjector</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2714: </span>        <span class='hs-conid'>ConNilpotent</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeNilpotent</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2715: </span>        <span class='hs-conid'>ConUnitary</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>rangeUnitary</span> <span class='hs-layout'>(</span><span class='hs-varid'>minAbs</span><span class='hs-layout'>,</span><span class='hs-varid'>maxAbs</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2716: </span>
<span class=hs-linenum>2717: </span>  <span class='hs-varid'>random</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randomR</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2718: </span>
<span class=hs-linenum>2719: </span>
<span class=hs-linenum>2720: </span>
<span class=hs-linenum>2721: </span><span class='hs-comment'>-- | 'ConCl3' Bounded Enum Algebraic Data Type of constructors of Cl3</span>
<span class=hs-linenum>2722: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ConCl3</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ConR</span>
<span class=hs-linenum>2723: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConV3</span>
<span class=hs-linenum>2724: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConBV</span>
<span class=hs-linenum>2725: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConI</span>
<span class=hs-linenum>2726: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConPV</span>
<span class=hs-linenum>2727: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConH</span>
<span class=hs-linenum>2728: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConC</span>
<span class=hs-linenum>2729: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConBPV</span>
<span class=hs-linenum>2730: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConODD</span>
<span class=hs-linenum>2731: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConTPV</span>
<span class=hs-linenum>2732: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConAPS</span>
<span class=hs-linenum>2733: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConProj</span>
<span class=hs-linenum>2734: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConNilpotent</span>
<span class=hs-linenum>2735: </span>            <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConUnitary</span>
<span class=hs-linenum>2736: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Bounded</span><span class='hs-layout'>,</span> <span class='hs-conid'>Enum</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2737: </span>
<span class=hs-linenum>2738: </span>
<span class=hs-linenum>2739: </span>
<span class=hs-linenum>2740: </span>
<span class=hs-linenum>2741: </span><span class='hs-comment'>-- | 'randR' random Real Scalar (Grade 0) with random magnitude and random sign</span>
<span class=hs-linenum>2742: </span><span class='hs-definition'>randR</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2743: </span><span class='hs-definition'>randR</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2744: </span>
<span class=hs-linenum>2745: </span>
<span class=hs-linenum>2746: </span><span class='hs-comment'>-- | 'rangeR' random Real Scalar (Grade 0) with random magnitude within a range and a random sign</span>
<span class=hs-linenum>2747: </span><span class='hs-definition'>rangeR</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2748: </span><span class='hs-definition'>rangeR</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scalarHelper</span> <span class='hs-conid'>R</span>
<span class=hs-linenum>2749: </span>
<span class=hs-linenum>2750: </span>
<span class=hs-linenum>2751: </span><span class='hs-comment'>-- | 'randV3' random Vector (Grade 1) with random magnitude and random direction</span>
<span class=hs-linenum>2752: </span><span class='hs-comment'>-- the direction is using spherical coordinates</span>
<span class=hs-linenum>2753: </span><span class='hs-definition'>randV3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2754: </span><span class='hs-definition'>randV3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeV3</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2755: </span>
<span class=hs-linenum>2756: </span>
<span class=hs-linenum>2757: </span><span class='hs-comment'>-- | 'rangeV3' random Vector (Grade 1) with random magnitude within a range and a random direction</span>
<span class=hs-linenum>2758: </span><span class='hs-definition'>rangeV3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2759: </span><span class='hs-definition'>rangeV3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vectorHelper</span> <span class='hs-conid'>V3</span>
<span class=hs-linenum>2760: </span>
<span class=hs-linenum>2761: </span>
<span class=hs-linenum>2762: </span><span class='hs-comment'>-- | 'randBV' random Bivector (Grade 2) with random magnitude and random direction</span>
<span class=hs-linenum>2763: </span><span class='hs-comment'>-- the direction is using spherical coordinates</span>
<span class=hs-linenum>2764: </span><span class='hs-definition'>randBV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2765: </span><span class='hs-definition'>randBV</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeBV</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2766: </span>
<span class=hs-linenum>2767: </span>
<span class=hs-linenum>2768: </span><span class='hs-comment'>-- | 'rangeBV' random Bivector (Grade 2) with random magnitude in a range and a random direction</span>
<span class=hs-linenum>2769: </span><span class='hs-definition'>rangeBV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2770: </span><span class='hs-definition'>rangeBV</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>vectorHelper</span> <span class='hs-conid'>BV</span>
<span class=hs-linenum>2771: </span>
<span class=hs-linenum>2772: </span>
<span class=hs-linenum>2773: </span><span class='hs-comment'>-- | 'randI' random Imaginary Scalar (Grade 3) with random magnitude and random sign</span>
<span class=hs-linenum>2774: </span><span class='hs-definition'>randI</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2775: </span><span class='hs-definition'>randI</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeI</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2776: </span>
<span class=hs-linenum>2777: </span>
<span class=hs-linenum>2778: </span><span class='hs-comment'>-- | 'rangeI' random Imaginary Scalar (Grade 3) with random magnitude within a range and random sign</span>
<span class=hs-linenum>2779: </span><span class='hs-definition'>rangeI</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2780: </span><span class='hs-definition'>rangeI</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scalarHelper</span> <span class='hs-conid'>I</span>
<span class=hs-linenum>2781: </span>
<span class=hs-linenum>2782: </span>
<span class=hs-linenum>2783: </span><span class='hs-comment'>-- | 'randPV' random Paravector made from random Grade 0 and Grade 1 elements</span>
<span class=hs-linenum>2784: </span><span class='hs-definition'>randPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2785: </span><span class='hs-definition'>randPV</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangePV</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2786: </span>
<span class=hs-linenum>2787: </span>
<span class=hs-linenum>2788: </span><span class='hs-comment'>-- | 'rangePV' random Paravector made from random Grade 0 and Grade 1 elements within a range</span>
<span class=hs-linenum>2789: </span><span class='hs-definition'>rangePV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2790: </span><span class='hs-definition'>rangePV</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2791: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>scale</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2792: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randR</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2793: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randV3</span> <span class='hs-varid'>g''</span>
<span class=hs-linenum>2794: </span>      <span class='hs-varid'>sumsqs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>2795: </span>      <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>abs</span> <span class='hs-varid'>a0</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sqrt</span> <span class='hs-varid'>sumsqs</span>
<span class=hs-linenum>2796: </span>      <span class='hs-varid'>invMag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a0</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>sumsqs</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>2797: </span>      <span class='hs-varid'>mag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-varid'>invMag</span>
<span class=hs-linenum>2798: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2799: </span>
<span class=hs-linenum>2800: </span>
<span class=hs-linenum>2801: </span><span class='hs-comment'>-- | 'randH' random Quaternion made from random Grade 0 and Grade 2 elements</span>
<span class=hs-linenum>2802: </span><span class='hs-definition'>randH</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2803: </span><span class='hs-definition'>randH</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeH</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2804: </span>
<span class=hs-linenum>2805: </span>
<span class=hs-linenum>2806: </span><span class='hs-comment'>-- | 'rangeH' random Quaternion made from random Grade 0 and Grade 2 elements within a range</span>
<span class=hs-linenum>2807: </span><span class='hs-definition'>rangeH</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2808: </span><span class='hs-definition'>rangeH</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2809: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>scale</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2810: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>a0</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randR</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2811: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randBV</span> <span class='hs-varid'>g''</span>
<span class=hs-linenum>2812: </span>      <span class='hs-varid'>invMag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a0</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>2813: </span>      <span class='hs-varid'>mag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-varid'>invMag</span>
<span class=hs-linenum>2814: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>H</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2815: </span>
<span class=hs-linenum>2816: </span>
<span class=hs-linenum>2817: </span><span class='hs-comment'>-- | 'randC' random combination of Grade 0 and Grade 3</span>
<span class=hs-linenum>2818: </span><span class='hs-definition'>randC</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2819: </span><span class='hs-definition'>randC</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeC</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2820: </span>
<span class=hs-linenum>2821: </span>
<span class=hs-linenum>2822: </span><span class='hs-comment'>-- | 'rangeC' random combination of Grade 0 and Grade 3 within a range</span>
<span class=hs-linenum>2823: </span><span class='hs-definition'>rangeC</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2824: </span><span class='hs-definition'>rangeC</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2825: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>scale</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2826: </span>      <span class='hs-layout'>(</span><span class='hs-varid'>phi</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randomR</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span> <span class='hs-num'>2</span><span class='hs-varop'>*</span><span class='hs-varid'>pi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2827: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-layout'>(</span><span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-varid'>cos</span> <span class='hs-varid'>phi</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sin</span> <span class='hs-varid'>phi</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2828: </span>
<span class=hs-linenum>2829: </span>
<span class=hs-linenum>2830: </span><span class='hs-comment'>-- | 'randBPV' random combination of Grade 1 and Grade 2</span>
<span class=hs-linenum>2831: </span><span class='hs-definition'>randBPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2832: </span><span class='hs-definition'>randBPV</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeBPV</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2833: </span>
<span class=hs-linenum>2834: </span>
<span class=hs-linenum>2835: </span><span class='hs-comment'>-- | 'rangeBPV' random combination of Grade 1 and Grade 2 within a range</span>
<span class=hs-linenum>2836: </span><span class='hs-definition'>rangeBPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2837: </span><span class='hs-definition'>rangeBPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2838: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>scale</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2839: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randV3</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2840: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randBV</span> <span class='hs-varid'>g''</span>
<span class=hs-linenum>2841: </span>      <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>2842: </span>      <span class='hs-varid'>invMag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>2843: </span>      <span class='hs-varid'>mag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-varid'>invMag</span>
<span class=hs-linenum>2844: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2845: </span>
<span class=hs-linenum>2846: </span>
<span class=hs-linenum>2847: </span><span class='hs-comment'>-- | 'randODD' random combination of Grade 1 and Grade 3</span>
<span class=hs-linenum>2848: </span><span class='hs-definition'>randODD</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2849: </span><span class='hs-definition'>randODD</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeODD</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2850: </span>
<span class=hs-linenum>2851: </span>
<span class=hs-linenum>2852: </span><span class='hs-comment'>-- | 'rangeODD' random combination of Grade 1 and Grade 3 within a range</span>
<span class=hs-linenum>2853: </span><span class='hs-definition'>rangeODD</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2854: </span><span class='hs-definition'>rangeODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2855: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>scale</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2856: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randV3</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2857: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randI</span> <span class='hs-varid'>g''</span>
<span class=hs-linenum>2858: </span>      <span class='hs-varid'>invMag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>2859: </span>      <span class='hs-varid'>mag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-varid'>invMag</span>
<span class=hs-linenum>2860: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>ODD</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2861: </span>
<span class=hs-linenum>2862: </span>
<span class=hs-linenum>2863: </span><span class='hs-comment'>-- | 'randTPV' random combination of Grade 2 and Grade 3</span>
<span class=hs-linenum>2864: </span><span class='hs-definition'>randTPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2865: </span><span class='hs-definition'>randTPV</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeTPV</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2866: </span>
<span class=hs-linenum>2867: </span>
<span class=hs-linenum>2868: </span><span class='hs-comment'>-- | 'rangeTPV' random combination of Grade 2 and Grade 3 within a range</span>
<span class=hs-linenum>2869: </span><span class='hs-definition'>rangeTPV</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2870: </span><span class='hs-definition'>rangeTPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2871: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>scale</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2872: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randBV</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2873: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>I</span> <span class='hs-varid'>a123</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randI</span> <span class='hs-varid'>g''</span>
<span class=hs-linenum>2874: </span>      <span class='hs-varid'>sumsqs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>2875: </span>      <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>abs</span> <span class='hs-varid'>a123</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sqrt</span> <span class='hs-varid'>sumsqs</span>
<span class=hs-linenum>2876: </span>      <span class='hs-varid'>invMag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>sumsqs</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>2877: </span>      <span class='hs-varid'>mag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-varid'>invMag</span>
<span class=hs-linenum>2878: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>TPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2879: </span>
<span class=hs-linenum>2880: </span>
<span class=hs-linenum>2881: </span><span class='hs-comment'>-- | 'randAPS' random combination of all 4 grades</span>
<span class=hs-linenum>2882: </span><span class='hs-definition'>randAPS</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2883: </span><span class='hs-definition'>randAPS</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeAPS</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2884: </span>
<span class=hs-linenum>2885: </span>
<span class=hs-linenum>2886: </span><span class='hs-comment'>-- | 'rangeAPS' random combination of all 4 grades within a range</span>
<span class=hs-linenum>2887: </span><span class='hs-definition'>rangeAPS</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2888: </span><span class='hs-definition'>rangeAPS</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2889: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>scale</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2890: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>C</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a123</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randC</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2891: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randV3</span> <span class='hs-varid'>g''</span>
<span class=hs-linenum>2892: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>BV</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randBV</span> <span class='hs-varid'>g'''</span>
<span class=hs-linenum>2893: </span>      <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>a1</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>a2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a0</span><span class='hs-varop'>*</span><span class='hs-varid'>a3</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a12</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-layout'>(</span><span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>a31</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>a23</span><span class='hs-layout'>)</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>2894: </span>      <span class='hs-varid'>invMag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>a0</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a23</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a31</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a12</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>a123</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span> <span class='hs-varop'>+</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>2895: </span>      <span class='hs-varid'>mag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>scale</span> <span class='hs-varop'>*</span> <span class='hs-varid'>invMag</span>
<span class=hs-linenum>2896: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>APS</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a123</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'v</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2897: </span>
<span class=hs-linenum>2898: </span>
<span class=hs-linenum>2899: </span><span class='hs-comment'>-------------------------------------------------------------------</span>
<span class=hs-linenum>2900: </span><span class='hs-comment'>-- Additional Random generators</span>
<span class=hs-linenum>2901: </span><span class='hs-comment'>-------------------------------------------------------------------</span>
<span class=hs-linenum>2902: </span><span class='hs-comment'>-- | 'randUnitV3' a unit vector with a random direction</span>
<span class=hs-linenum>2903: </span><span class='hs-definition'>randUnitV3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2904: </span><span class='hs-definition'>randUnitV3</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2905: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>theta</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randomR</span> <span class='hs-layout'>(</span><span class='hs-num'>0</span><span class='hs-layout'>,</span><span class='hs-num'>2</span><span class='hs-varop'>*</span><span class='hs-varid'>pi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2906: </span>      <span class='hs-layout'>(</span><span class='hs-varid'>u</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randomR</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>,</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2907: </span>      <span class='hs-varid'>semicircle</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sqrt</span> <span class='hs-layout'>(</span><span class='hs-num'>1</span><span class='hs-comment'>-</span><span class='hs-varid'>u</span><span class='hs-varop'>^</span><span class='hs-num'>2</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2908: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-layout'>(</span><span class='hs-varid'>semicircle</span> <span class='hs-varop'>*</span> <span class='hs-varid'>cos</span> <span class='hs-varid'>theta</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>semicircle</span> <span class='hs-varop'>*</span> <span class='hs-varid'>sin</span> <span class='hs-varid'>theta</span><span class='hs-layout'>)</span> <span class='hs-varid'>u</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2909: </span>
<span class=hs-linenum>2910: </span>
<span class=hs-linenum>2911: </span><span class='hs-comment'>-- | 'randProjector' a projector with a random direction</span>
<span class=hs-linenum>2912: </span><span class='hs-definition'>randProjector</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2913: </span><span class='hs-definition'>randProjector</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2914: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randUnitV3</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2915: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-num'>0.5</span> <span class='hs-layout'>(</span><span class='hs-num'>0.5</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-num'>0.5</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-num'>0.5</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2916: </span>
<span class=hs-linenum>2917: </span>
<span class=hs-linenum>2918: </span><span class='hs-comment'>-- | 'rangeProjector' a projector with a range of random magnitudes and directions</span>
<span class=hs-linenum>2919: </span><span class='hs-definition'>rangeProjector</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2920: </span><span class='hs-definition'>rangeProjector</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2921: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>mag</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2922: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randProjector</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2923: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2924: </span>
<span class=hs-linenum>2925: </span>
<span class=hs-linenum>2926: </span><span class='hs-comment'>-- | 'randNilpotent' a nilpotent element with a random orientation</span>
<span class=hs-linenum>2927: </span><span class='hs-definition'>randNilpotent</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2928: </span><span class='hs-definition'>randNilpotent</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2929: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>PV</span> <span class='hs-varid'>a0</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randProjector</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2930: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-varid'>b3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randUnitV3</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2931: </span>      <span class='hs-varid'>c1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span>
<span class=hs-linenum>2932: </span>      <span class='hs-varid'>c2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a3</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b3</span>
<span class=hs-linenum>2933: </span>      <span class='hs-varid'>c3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a1</span><span class='hs-varop'>*</span><span class='hs-varid'>b2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>a2</span><span class='hs-varop'>*</span><span class='hs-varid'>b1</span> <span class='hs-comment'>-- (V3 c1 c2 c3) vector normal to the projector: mIx.toBV $ toV3 p * v</span>
<span class=hs-linenum>2934: </span>      <span class='hs-varid'>invMag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>recip</span><span class='hs-varop'>.</span><span class='hs-varid'>sqrt</span> <span class='hs-varop'>$</span> <span class='hs-varid'>c1</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>c2</span><span class='hs-varop'>^</span><span class='hs-num'>2</span> <span class='hs-varop'>+</span> <span class='hs-varid'>c3</span><span class='hs-varop'>^</span><span class='hs-num'>2</span>
<span class=hs-linenum>2935: </span>      <span class='hs-varid'>d1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>invMag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>c1</span>
<span class=hs-linenum>2936: </span>      <span class='hs-varid'>d2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>invMag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>c2</span>
<span class=hs-linenum>2937: </span>      <span class='hs-varid'>d3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>invMag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>c3</span>  <span class='hs-comment'>-- (V3 d1 d2 d3) unit vector normal to the projector</span>
<span class=hs-linenum>2938: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>d1</span><span class='hs-varop'>*</span><span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>d2</span><span class='hs-varop'>*</span><span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>d3</span><span class='hs-varop'>*</span><span class='hs-varid'>a0</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>d2</span><span class='hs-varop'>*</span><span class='hs-varid'>a3</span> <span class='hs-comment'>-</span> <span class='hs-varid'>d3</span><span class='hs-varop'>*</span><span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>d3</span><span class='hs-varop'>*</span><span class='hs-varid'>a1</span> <span class='hs-comment'>-</span> <span class='hs-varid'>d1</span><span class='hs-varop'>*</span><span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>d1</span><span class='hs-varop'>*</span><span class='hs-varid'>a2</span> <span class='hs-comment'>-</span> <span class='hs-varid'>d2</span><span class='hs-varop'>*</span><span class='hs-varid'>a1</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2939: </span>
<span class=hs-linenum>2940: </span>
<span class=hs-linenum>2941: </span><span class='hs-comment'>-- | 'rangeNilpotent' a nilpotent with a range of random magnitudes and orientations</span>
<span class=hs-linenum>2942: </span><span class='hs-definition'>rangeNilpotent</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2943: </span><span class='hs-definition'>rangeNilpotent</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span>  <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2944: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-conid'>R</span> <span class='hs-varid'>mag</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2945: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-varid'>a1</span> <span class='hs-varid'>a2</span> <span class='hs-varid'>a3</span> <span class='hs-varid'>a23</span> <span class='hs-varid'>a31</span> <span class='hs-varid'>a12</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randNilpotent</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2946: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-conid'>BPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a2</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a3</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a23</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a31</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>a12</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2947: </span>
<span class=hs-linenum>2948: </span>
<span class=hs-linenum>2949: </span><span class='hs-comment'>-- | 'randUnitary' a unitary element with a random orientation</span>
<span class=hs-linenum>2950: </span><span class='hs-definition'>randUnitary</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2951: </span><span class='hs-definition'>randUnitary</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2952: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>tpv</span><span class='hs-layout'>,</span><span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randTPV</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2953: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-varid'>exp</span> <span class='hs-varid'>tpv</span><span class='hs-layout'>,</span><span class='hs-varid'>g'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2954: </span>
<span class=hs-linenum>2955: </span>
<span class=hs-linenum>2956: </span><span class='hs-comment'>-- | 'rangeUnitary' a unitary element with a range of random magnitudes and orientations, the exponential of a triparavector</span>
<span class=hs-linenum>2957: </span><span class='hs-definition'>rangeUnitary</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2958: </span><span class='hs-definition'>rangeUnitary</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2959: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>tpv</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>rangeTPV</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2960: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-varid'>exp</span> <span class='hs-varid'>tpv</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2961: </span>
<span class=hs-linenum>2962: </span>
<span class=hs-linenum>2963: </span><span class='hs-comment'>-------------------------------------------------------------------</span>
<span class=hs-linenum>2964: </span><span class='hs-comment'>-- helper functions</span>
<span class=hs-linenum>2965: </span><span class='hs-comment'>-------------------------------------------------------------------</span>
<span class=hs-linenum>2966: </span><span class='hs-definition'>magHelper</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Double</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2967: </span><span class='hs-definition'>magHelper</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2968: </span>  <span class='hs-keyword'>let</span> <span class='hs-conid'>R</span> <span class='hs-varid'>lo'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>abs</span> <span class='hs-varid'>lo</span>
<span class=hs-linenum>2969: </span>      <span class='hs-conid'>R</span> <span class='hs-varid'>hi'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>abs</span> <span class='hs-varid'>hi</span>
<span class=hs-linenum>2970: </span>  <span class='hs-keyword'>in</span> <span class='hs-varid'>randomR</span> <span class='hs-layout'>(</span><span class='hs-varid'>lo'</span><span class='hs-layout'>,</span> <span class='hs-varid'>hi'</span><span class='hs-layout'>)</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2971: </span>
<span class=hs-linenum>2972: </span>
<span class=hs-linenum>2973: </span><span class='hs-definition'>scalarHelper</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2974: </span><span class='hs-definition'>scalarHelper</span> <span class='hs-varid'>con</span> <span class='hs-varid'>rng</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2975: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>magHelper</span> <span class='hs-varid'>rng</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2976: </span>      <span class='hs-layout'>(</span><span class='hs-varid'>sign</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>random</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2977: </span>  <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>sign</span>
<span class=hs-linenum>2978: </span>     <span class='hs-keyword'>then</span> <span class='hs-layout'>(</span><span class='hs-varid'>con</span> <span class='hs-varid'>mag</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2979: </span>     <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><span class='hs-varid'>con</span> <span class='hs-layout'>(</span><span class='hs-varid'>negate</span> <span class='hs-varid'>mag</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2980: </span>
<span class=hs-linenum>2981: </span>
<span class=hs-linenum>2982: </span><span class='hs-definition'>vectorHelper</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>RandomGen</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Double</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Cl3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Cl3</span><span class='hs-layout'>,</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2983: </span><span class='hs-definition'>vectorHelper</span> <span class='hs-varid'>con</span> <span class='hs-varid'>rng</span> <span class='hs-varid'>g</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>2984: </span>  <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span><span class='hs-layout'>,</span> <span class='hs-varid'>g'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>magHelper</span> <span class='hs-varid'>rng</span> <span class='hs-varid'>g</span>
<span class=hs-linenum>2985: </span>      <span class='hs-layout'>(</span><span class='hs-conid'>V3</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>z</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>randUnitV3</span> <span class='hs-varid'>g'</span>
<span class=hs-linenum>2986: </span>  <span class='hs-keyword'>in</span> <span class='hs-layout'>(</span><span class='hs-varid'>con</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mag</span> <span class='hs-varop'>*</span> <span class='hs-varid'>z</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>g''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>2987: </span>
<span class=hs-linenum>2988: </span>
<span class=hs-linenum>2989: </span><span class='hs-cpp'>#endif</span>
<span class=hs-linenum>2990: </span>
<span class=hs-linenum>2991: </span><span class='hs-comment'>-- End of File</span>
</pre>
</body>
</html>